{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-08-20T19:34:26.121821Z", "invocation_id": "a0e35074-140c-4cfa-8615-fac64626031d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.377432Z", "completed_at": "2025-08-20T19:34:24.387584Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.407827Z", "completed_at": "2025-08-20T19:34:24.407849Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08704614639282227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__campaign_region_report", "compiled": true, "compiled_code": "", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__campaign_region_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.452705Z", "completed_at": "2025-08-20T19:34:24.458431Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.458746Z", "completed_at": "2025-08-20T19:34:24.458754Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007444620132446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__account_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.account_history`\n\n),\n\nfields as (\n\n    select\n        id as id,\n        _fivetran_synced as _fivetran_synced,\n        name as name,\n        cast(null as string) as account_status,\n        cast(null as string) as business_country_code,\n        cast(null as timestamp) as created_time,\n        cast(null as string) as currency,\n        cast(null as string) as timezone_name,\n        cast(null as float64) as timezone_offset_hours_utc,\n        cast(null as string) as business_state,\n        cast(null as int64) as min_daily_budget,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as bigint) as account_id,\n        _fivetran_synced,\n        name as account_name,\n        account_status,\n        business_country_code,\n        business_state,\n        created_time as created_at,\n        currency,\n        timezone_name,\n        timezone_offset_hours_utc,\n        min_daily_budget,\n        case \n            when id is null and _fivetran_synced is null then \n                row_number() over (partition by source_relation order by source_relation)\n            else \n                row_number() over (partition by source_relation, id order by _fivetran_synced desc) \n        end = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.460641Z", "completed_at": "2025-08-20T19:34:24.462952Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.463284Z", "completed_at": "2025-08-20T19:34:24.463291Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0042111873626708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__ad_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.ad_history`\n\n),\n\nfields as (\n\n    select\n        updated_time as updated_time, \n        id as id, \n        name as name, \n        account_id as account_id, \n        ad_set_id as ad_set_id, \n        campaign_id as campaign_id, \n        creative_id as creative_id, \n        cast(null as string) as conversion_domain,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_id,\n        name as ad_name,\n        cast(account_id as bigint) as account_id,\n        cast(ad_set_id as bigint) as ad_set_id,   \n        cast(campaign_id as bigint) as campaign_id,\n        cast(creative_id as bigint) as creative_id,\n        conversion_domain,\n        case \n            when id is null and updated_time is null then \n                row_number() over (partition by source_relation order by source_relation)\n            else \n                row_number() over (partition by source_relation, id order by updated_time desc) \n        end = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.465503Z", "completed_at": "2025-08-20T19:34:24.467589Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.467840Z", "completed_at": "2025-08-20T19:34:24.467845Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035996437072753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__ad_set_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.ad_set_history`\n\n),\n\nfields as (\n\n    select\n        updated_time as updated_time, \n        id as id, \n        name as name, \n        account_id as account_id, \n        campaign_id as campaign_id, \n        cast(null as timestamp) as start_time, \n        cast(null as timestamp) as end_time, \n        cast(null as string) as bid_strategy, \n        cast(null as int64) as daily_budget, \n        cast(null as int64) as budget_remaining, \n        cast(null as string) as status, \n        cast(null as string) as optimization_goal,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        cast(id as bigint) as ad_set_id,\n        name as ad_set_name,\n        cast(account_id as bigint) as account_id,\n        cast(campaign_id as bigint) as campaign_id,\n        start_time as start_at,\n        end_time as end_at,\n        bid_strategy,\n        daily_budget,\n        budget_remaining,\n        status,\n        optimization_goal,\n        case \n            when id is null and updated_time is null then \n                row_number() over (partition by source_relation order by source_relation)\n            else \n                row_number() over (partition by source_relation, id order by updated_time desc) \n        end = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_set_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.469608Z", "completed_at": "2025-08-20T19:34:24.471162Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.471391Z", "completed_at": "2025-08-20T19:34:24.471395Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0030558109283447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__basic_ad", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.basic_ad`\n\n),\n\nfields as (\n\n    select\n        ad_id as ad_id, \n        cast(null as string) as ad_name, \n        cast(null as string) as adset_name, \n        date as date, \n        account_id as account_id, \n        impressions as impressions, \n        inline_link_clicks as inline_link_clicks, \n        spend as spend, \n        reach as reach, \n        cast(null as FLOAT64) as frequency,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(ad_id as bigint) as ad_id,\n        ad_name,\n        adset_name as ad_set_name,\n        date as date_day,\n        cast(account_id as bigint) as account_id,\n        impressions,\n        coalesce(inline_link_clicks, 0) as clicks,\n        spend,\n        reach,\n        frequency\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.473154Z", "completed_at": "2025-08-20T19:34:24.475588Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.476123Z", "completed_at": "2025-08-20T19:34:24.476129Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004254341125488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__basic_ad_action_values", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.basic_ad_action_values`\n\n),\n\nfields as (\n\n    select\n        _fivetran_id as _fivetran_id, \n        _fivetran_synced as _fivetran_synced, \n        action_type as action_type, \n        ad_id as ad_id, \n        date as date, \n        index as index, \n        value as value,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n    \n    select \n        source_relation, \n        lower(action_type) as action_type,\n        cast(ad_id as bigint) as ad_id,\n        date as date_day,\n        cast(coalesce(value, 0) as FLOAT64) as conversions_value\n    from fields\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad_action_values`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.478568Z", "completed_at": "2025-08-20T19:34:24.482891Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.483168Z", "completed_at": "2025-08-20T19:34:24.483174Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006021261215209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__basic_ad_actions", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.basic_ad_actions`\n\n),\n\nfields as (\n\n    select\n        _fivetran_id as _fivetran_id, \n        _fivetran_synced as _fivetran_synced, \n        action_type as action_type, \n        ad_id as ad_id, \n        date as date, \n        index as index, \n        value as value,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n    \n    select \n        source_relation, \n        lower(action_type) as action_type,\n        cast(ad_id as bigint) as ad_id,\n        date as date_day,\n        cast(coalesce(value, 0) as FLOAT64) as conversions\n    from fields\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad_actions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.485496Z", "completed_at": "2025-08-20T19:34:24.487655Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.487906Z", "completed_at": "2025-08-20T19:34:24.487911Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037932395935058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__campaign_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.campaign_history`\n\n),\n\nfields as (\n\n    select\n        updated_time as updated_time, \n        cast(null as timestamp) as created_time, \n        account_id as account_id, \n        id as id, \n        name as name, \n        cast(null as timestamp) as start_time, \n        cast(null as timestamp) as stop_time, \n        cast(null as string) as status, \n        cast(null as INT64) as daily_budget, \n        cast(null as INT64) as lifetime_budget, \n        cast(null as FLOAT64) as budget_remaining,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        updated_time as updated_at,\n        created_time as created_at,\n        cast(account_id as bigint) as account_id,\n        cast(id as bigint) as campaign_id,\n        name as campaign_name,\n        start_time as start_at,\n        stop_time as end_at,\n        status,\n        daily_budget,\n        lifetime_budget,\n        budget_remaining,\n        case \n            when id is null and updated_time is null \n                then row_number() over (partition by source_relation order by source_relation)\n            else \n                row_number() over (partition by source_relation, id order by updated_time desc) \n        end = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__campaign_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.489702Z", "completed_at": "2025-08-20T19:34:24.491584Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.491825Z", "completed_at": "2025-08-20T19:34:24.491830Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003385782241821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__creative_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.creative_history`\n\n),\n\nfields as (\n\n    select\n        _fivetran_id,\n        _fivetran_synced,\n        id,\n        account_id,\n        name,\n        page_link,\n        template_page_link,\n        url_tags,\n        asset_feed_spec_link_urls,\n        object_story_link_data_child_attachments,\n        object_story_link_data_caption,\n        object_story_link_data_description,\n        object_story_link_data_link,\n        object_story_link_data_message,\n        cast(null as string) as template_app_link_spec_android,\n        template_app_link_spec_ios,\n        cast(null as string) as template_app_link_spec_ipad,\n        cast(null as string) as template_app_link_spec_iphone,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        _fivetran_id,\n        _fivetran_synced,\n        cast(id as bigint) as creative_id,\n        cast(account_id as bigint) as account_id,\n        name as creative_name,\n        page_link,\n        template_page_link,\n        url_tags,\n        asset_feed_spec_link_urls,\n        object_story_link_data_child_attachments,\n        object_story_link_data_caption, \n        object_story_link_data_description, \n        object_story_link_data_link, \n        object_story_link_data_message,\n        template_app_link_spec_ios,\n        template_app_link_spec_ipad,\n        template_app_link_spec_android,\n        template_app_link_spec_iphone,\n        case \n            when id is null and _fivetran_synced is null \n                then row_number() over (partition by source_relation order by source_relation)\n            else row_number() over (partition by source_relation, id order by _fivetran_synced desc) \n        end = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__creative_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.493616Z", "completed_at": "2025-08-20T19:34:24.495528Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.495795Z", "completed_at": "2025-08-20T19:34:24.495800Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003468036651611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__demographics_country", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.demographics_country`\n\n),\n\nfields as (\n\n    select\n        _fivetran_id as _fivetran_id,\n        _fivetran_synced as _fivetran_synced,\n        account_id as account_id,\n        country as country,\n        date as date,\n        frequency as frequency,\n        impressions as impressions,\n        inline_link_clicks as inline_link_clicks,\n        reach as reach,\n        spend as spend,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select \n        source_relation, \n        _fivetran_id as country_id,\n        country,\n        date as date_day,\n        cast(account_id as bigint) as account_id,\n        impressions,\n        coalesce(inline_link_clicks, 0) as clicks,\n        spend,\n        reach,\n        frequency\n    from fields\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_country`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.497770Z", "completed_at": "2025-08-20T19:34:24.499451Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.499684Z", "completed_at": "2025-08-20T19:34:24.499689Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0032324790954589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__demographics_country_actions", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.facebook_ads.demographics_country_actions`\n\n),\n\nfields as (\n\n    select\n        _fivetran_id,\n        _fivetran_synced,\n        account_id,\n        action_type,\n        date,\n        index,\n        value,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfinal as (\n    \n    select \n        source_relation, \n        _fivetran_id as country_id,\n        lower(action_type) as action_type,\n        cast(account_id as bigint) as account_id,\n        date as date_day,\n        cast(coalesce(value, 0) as FLOAT64) as conversions\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_country_actions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.501682Z", "completed_at": "2025-08-20T19:34:24.503005Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.503244Z", "completed_at": "2025-08-20T19:34:24.503249Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002998828887939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__demographics_region", "compiled": true, "compiled_code": "with base as (\r\n\r\n    select * \r\n    from `secure-electron-279822`.`raw_facebook_ads`.`demographics_region`\r\n\r\n),\r\n\r\nfields as (\r\n\r\n    select\r\n        _fivetran_id,\r\n        _fivetran_synced,\r\n        account_id,\r\n        date,\r\n        frequency,\r\n        impressions,\r\n        inline_link_clicks,\r\n        reach,\r\n        region,\r\n        spend,\r\n        cast('' as string) as source_relation\r\n    from base\r\n\r\n),\r\n\r\nfinal as (\r\n    \r\n    select \r\n        source_relation, \r\n        _fivetran_id as region_id,\r\n        region,\r\n        date as date_day,\r\n        cast(account_id as bigint) as account_id,\r\n        impressions,\r\n        coalesce(inline_link_clicks, 0) as clicks,\r\n        spend,\r\n        reach,\r\n        frequency\r\n    from fields\r\n)\r\n\r\nselect *\r\nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.505026Z", "completed_at": "2025-08-20T19:34:24.506034Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.506263Z", "completed_at": "2025-08-20T19:34:24.506267Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002452373504638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_facebook_ads__demographics_region_actions", "compiled": true, "compiled_code": "with base as (\r\n\r\n    select * \r\n    from `secure-electron-279822`.`raw_facebook_ads`.`demographics_region_actions`\r\n\r\n),\r\n\r\nfields as (\r\n\r\n    select\r\n        _fivetran_id,\r\n        _fivetran_synced,\r\n        account_id,\r\n        action_type,\r\n        date,\r\n        value,\r\n        cast('' as string) as source_relation\r\n    from base\r\n\r\n),\r\n\r\nfinal as (\r\n    \r\n    select \r\n        source_relation, \r\n        _fivetran_id as region_id,\r\n        lower(action_type) as action_type,\r\n        cast(account_id as bigint) as account_id,\r\n        date as date_day,\r\n        cast(coalesce(value, 0) as FLOAT64) as conversions\r\n    from fields\r\n)\r\n\r\nselect *\r\nfrom final", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_region_actions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.507983Z", "completed_at": "2025-08-20T19:34:24.510262Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.510512Z", "completed_at": "2025-08-20T19:34:24.510517Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003779888153076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_PMAX", "compiled": true, "compiled_code": "WITH all_pmax_campaign_history AS (\n    SELECT\n        campaign_id,\n        campaign_name,\n        campaign_advertising_channel_type,\n        campaign_status,\n        customer_id,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_Campaign_8196795413`\n    WHERE\n        campaign_advertising_channel_type = 'PERFORMANCE_MAX'\n    UNION ALL\n    SELECT\n        campaign_id,\n        campaign_name,\n        campaign_advertising_channel_type,\n        campaign_status,\n        customer_id,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_bluevine.ads_Campaign_2828502255`\n    WHERE\n        campaign_advertising_channel_type = 'PERFORMANCE_MAX'\n),\nranked_pmax_campaigns AS (\n    SELECT\n        campaign_id,\n        campaign_name,\n        campaign_advertising_channel_type,\n        campaign_status,\n        customer_id,\n        _DATA_DATE,\n        ROW_NUMBER() over(\n            PARTITION BY campaign_id,\n            customer_id\n            ORDER BY\n                _DATA_DATE DESC\n        ) AS rn\n    FROM\n        all_pmax_campaign_history\n)\nSELECT\n    campaign_id,\n    campaign_name,\n    campaign_advertising_channel_type,\n    campaign_status,\n    customer_id\nFROM\n    ranked_pmax_campaigns\nWHERE\n    rn = 1", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_PMAX`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.512553Z", "completed_at": "2025-08-20T19:34:24.514441Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.514709Z", "completed_at": "2025-08-20T19:34:24.514715Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0034759044647216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_account", "compiled": true, "compiled_code": "with\n    base as (\n        select\n            *\n        from\n            `secure-electron-279822.fact_lookups.google_ads_accounts`\n    )\nselect\n    account_name,\n    customer_id\nfrom\n    base", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.516482Z", "completed_at": "2025-08-20T19:34:24.520134Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.520455Z", "completed_at": "2025-08-20T19:34:24.520461Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005340099334716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_account_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_AccountBasicStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_bluevine.ads_AccountBasicStats_2828502255`\n)\nSELECT\n    customer_id,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    base\nUNION ALL\nSELECT\n    customer_id,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.522548Z", "completed_at": "2025-08-20T19:34:24.524822Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.525068Z", "completed_at": "2025-08-20T19:34:24.525073Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003814697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_ad_conversion_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_AdConversionStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_bluevine.ads_AdConversionStats_2828502255`\n)\nSELECT\n    ad_group_ad_ad_id,\n    ad_group_id,\n    campaign_id,\n    customer_id,\n    ad_group_ad_ad_group,\n    ad_group_base_ad_group,\n    campaign_base_campaign,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_value_per_conversion,\n    segments_ad_network_type,\n    segments_click_type,\n    segments_conversion_action,\n    segments_conversion_action_category,\n    segments_conversion_action_name,\n    segments_date,\n    segments_day_of_week,\n    segments_device,\n    segments_month,\n    segments_quarter,\n    segments_slot,\n    segments_week,\n    segments_year,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    base\nUNION ALL\nSELECT\n    ad_group_ad_ad_id,\n    ad_group_id,\n    campaign_id,\n    customer_id,\n    ad_group_ad_ad_group,\n    ad_group_base_ad_group,\n    campaign_base_campaign,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_value_per_conversion,\n    segments_ad_network_type,\n    segments_click_type,\n    segments_conversion_action,\n    segments_conversion_action_category,\n    segments_conversion_action_name,\n    segments_date,\n    segments_day_of_week,\n    segments_device,\n    segments_month,\n    segments_quarter,\n    segments_slot,\n    segments_week,\n    segments_year,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_conversion_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.526857Z", "completed_at": "2025-08-20T19:34:24.528709Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.528954Z", "completed_at": "2025-08-20T19:34:24.528959Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035278797149658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_ad_group", "compiled": true, "compiled_code": "WITH all_ad_group_history AS (\n    SELECT\n        ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        ad_group_type,\n        campaign_id,\n        customer_id,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_AdGroup_8196795413`\n    UNION ALL\n    SELECT\n        ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        ad_group_type,\n        campaign_id,\n        customer_id,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_bluevine.ads_AdGroup_2828502255`\n),\nranked_ad_groups AS (\n    SELECT\n        ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        ad_group_type,\n        campaign_id,\n        customer_id,\n        _DATA_DATE,\n        ROW_NUMBER() over(\n            PARTITION BY ad_group_id,\n            campaign_id,\n            customer_id\n            ORDER BY\n                _DATA_DATE DESC\n        ) AS rn\n    FROM\n        all_ad_group_history\n)\nSELECT\n    ad_group_id,\n    ad_group_name,\n    ad_group_status,\n    ad_group_type,\n    campaign_id,\n    customer_id\nFROM\n    ranked_ad_groups\nWHERE\n    rn = 1", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.530955Z", "completed_at": "2025-08-20T19:34:24.533333Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.533586Z", "completed_at": "2025-08-20T19:34:24.533591Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003906726837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_ad_group_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_AdGroupBasicStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_bluevine.ads_AdGroupBasicStats_2828502255`\n)\nSELECT\n    ad_group_id,\n    campaign_id,\n    customer_id,\n    ad_group_base_ad_group,\n    campaign_base_campaign,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    base\nUNION ALL\nSELECT\n    ad_group_id,\n    campaign_id,\n    customer_id,\n    ad_group_base_ad_group,\n    campaign_base_campaign,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.535332Z", "completed_at": "2025-08-20T19:34:24.537017Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.537248Z", "completed_at": "2025-08-20T19:34:24.537252Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0031871795654296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_ad_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_AdBasicStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_bluevine.ads_AdBasicStats_2828502255`\n)\nSELECT\n    ad_group_ad_ad_id,\n    ad_group_id,\n    customer_id,\n    ad_group_ad_ad_group,\n    ad_group_base_ad_group,\n    campaign_base_campaign,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    base\nUNION ALL\nSELECT\n    ad_group_ad_ad_id,\n    ad_group_id,\n    customer_id,\n    ad_group_ad_ad_group,\n    ad_group_base_ad_group,\n    campaign_base_campaign,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.539088Z", "completed_at": "2025-08-20T19:34:24.541215Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.541489Z", "completed_at": "2025-08-20T19:34:24.541494Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00422215461730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_age_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        ad_group_criterion_criterion_id,\n        ad_group_id,\n        campaign_id,\n        customer_id,\n        ad_group_base_ad_group,\n        campaign_base_campaign,\n        metrics_active_view_impressions,\n        metrics_active_view_measurability,\n        metrics_active_view_measurable_cost_micros,\n        metrics_active_view_measurable_impressions,\n        metrics_active_view_viewability,\n        metrics_all_conversions,\n        metrics_all_conversions_value,\n        metrics_clicks,\n        metrics_conversions,\n        metrics_conversions_value,\n        metrics_cost_micros,\n        metrics_cross_device_conversions,\n        metrics_impressions,\n        metrics_interaction_event_types,\n        metrics_interactions,\n        metrics_view_through_conversions,\n        segments_ad_network_type,\n        segments_date,\n        segments_device,\n        _LATEST_DATE,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_AgeRangeBasicStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        ad_group_criterion_criterion_id,\n        ad_group_id,\n        campaign_id,\n        customer_id,\n        ad_group_base_ad_group,\n        campaign_base_campaign,\n        metrics_active_view_impressions,\n        metrics_active_view_measurability,\n        metrics_active_view_measurable_cost_micros,\n        metrics_active_view_measurable_impressions,\n        metrics_active_view_viewability,\n        metrics_all_conversions,\n        metrics_all_conversions_value,\n        metrics_clicks,\n        metrics_conversions,\n        metrics_conversions_value,\n        metrics_cost_micros,\n        metrics_cross_device_conversions,\n        metrics_impressions,\n        metrics_interaction_event_types,\n        metrics_interactions,\n        metrics_view_through_conversions,\n        segments_ad_network_type,\n        segments_date,\n        segments_device,\n        _LATEST_DATE,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_bluevine.ads_AgeRangeBasicStats_2828502255`\n)\nSELECT\n    *\nFROM\n    base\nUNION ALL\nSELECT\n    *\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_age_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.544562Z", "completed_at": "2025-08-20T19:34:24.547378Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.547634Z", "completed_at": "2025-08-20T19:34:24.547640Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0051326751708984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_campaign", "compiled": true, "compiled_code": "WITH all_campaign_history AS (\n    SELECT\n        campaign_id,\n        campaign_name,\n        campaign_advertising_channel_type,\n        campaign_status,\n        customer_id,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_Campaign_8196795413`\n    UNION ALL\n    SELECT\n        campaign_id,\n        campaign_name,\n        campaign_advertising_channel_type,\n        campaign_status,\n        customer_id,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_bluevine.ads_Campaign_2828502255`\n),\nranked_campaigns AS (\n    SELECT\n        campaign_id,\n        campaign_name,\n        campaign_advertising_channel_type,\n        campaign_status,\n        customer_id,\n        _DATA_DATE,\n        ROW_NUMBER() over(\n            PARTITION BY campaign_id,\n            customer_id\n            ORDER BY\n                _DATA_DATE DESC\n        ) AS rn\n    FROM\n        all_campaign_history\n)\nSELECT\n    campaign_id,\n    campaign_name,\n    campaign_advertising_channel_type,\n    campaign_status,\n    customer_id\nFROM\n    ranked_campaigns\nWHERE\n    rn = 1", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.549481Z", "completed_at": "2025-08-20T19:34:24.551504Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.551758Z", "completed_at": "2025-08-20T19:34:24.551763Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035140514373779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_campaign_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_CampaignBasicStats_8196795413`\n),\nblue_vine AS(\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_bluevine.ads_CampaignBasicStats_2828502255`\n)\nSELECT\n    campaign_id,\n    customer_id,\n    campaign_base_campaign,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    base\nUNION ALL\nSELECT\n    campaign_id,\n    customer_id,\n    campaign_base_campaign,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interactions,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_device,\n    segments_slot,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.553537Z", "completed_at": "2025-08-20T19:34:24.555715Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.556201Z", "completed_at": "2025-08-20T19:34:24.556207Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004629373550415039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_gender_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        ad_group_criterion_criterion_id,\n        ad_group_id,\n        campaign_id,\n        customer_id,\n        ad_group_base_ad_group,\n        campaign_base_campaign,\n        metrics_active_view_cpm,\n        metrics_active_view_ctr,\n        metrics_active_view_impressions,\n        metrics_active_view_measurability,\n        metrics_active_view_measurable_cost_micros,\n        metrics_active_view_measurable_impressions,\n        metrics_active_view_viewability,\n        metrics_all_conversions,\n        metrics_all_conversions_from_interactions_rate,\n        metrics_all_conversions_value,\n        metrics_average_cost,\n        metrics_average_cpc,\n        metrics_average_cpm,\n        metrics_clicks,\n        metrics_conversions,\n        metrics_conversions_from_interactions_rate,\n        metrics_conversions_value,\n        metrics_cost_micros,\n        metrics_cost_per_all_conversions,\n        metrics_cost_per_conversion,\n        metrics_cross_device_conversions,\n        metrics_ctr,\n        metrics_gmail_forwards,\n        metrics_gmail_saves,\n        metrics_gmail_secondary_clicks,\n        metrics_impressions,\n        metrics_interaction_event_types,\n        metrics_interaction_rate,\n        metrics_interactions,\n        metrics_value_per_all_conversions,\n        metrics_value_per_conversion,\n        segments_ad_network_type,\n        segments_click_type,\n        segments_date,\n        segments_day_of_week,\n        segments_device,\n        segments_month,\n        segments_quarter,\n        segments_week,\n        segments_year,\n        _LATEST_DATE,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_GenderStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        ad_group_criterion_criterion_id,\n        ad_group_id,\n        campaign_id,\n        customer_id,\n        ad_group_base_ad_group,\n        campaign_base_campaign,\n        metrics_active_view_cpm,\n        metrics_active_view_ctr,\n        metrics_active_view_impressions,\n        metrics_active_view_measurability,\n        metrics_active_view_measurable_cost_micros,\n        metrics_active_view_measurable_impressions,\n        metrics_active_view_viewability,\n        metrics_all_conversions,\n        metrics_all_conversions_from_interactions_rate,\n        metrics_all_conversions_value,\n        metrics_average_cost,\n        metrics_average_cpc,\n        metrics_average_cpm,\n        metrics_clicks,\n        metrics_conversions,\n        metrics_conversions_from_interactions_rate,\n        metrics_conversions_value,\n        metrics_cost_micros,\n        metrics_cost_per_all_conversions,\n        metrics_cost_per_conversion,\n        metrics_cross_device_conversions,\n        metrics_ctr,\n        metrics_gmail_forwards,\n        metrics_gmail_saves,\n        metrics_gmail_secondary_clicks,\n        metrics_impressions,\n        metrics_interaction_event_types,\n        metrics_interaction_rate,\n        metrics_interactions,\n        metrics_value_per_all_conversions,\n        metrics_value_per_conversion,\n        segments_ad_network_type,\n        segments_click_type,\n        segments_date,\n        segments_day_of_week,\n        segments_device,\n        segments_month,\n        segments_quarter,\n        segments_week,\n        segments_year,\n        _LATEST_DATE,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_bluevine.ads_GenderStats_2828502255`\n)\nSELECT\n    *\nFROM\n    base\nUNION ALL\nSELECT\n    *\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_gender_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.558741Z", "completed_at": "2025-08-20T19:34:24.561628Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.561931Z", "completed_at": "2025-08-20T19:34:24.561937Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004518985748291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_geo_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_GeoStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_bluevine.ads_GeoStats_2828502255`\n)\nSELECT\n    campaign_id,\n    customer_id,\n    geographic_view_country_criterion_id,\n    campaign_status,\n    geographic_view_location_type,\n    metrics_all_conversions,\n    metrics_all_conversions_from_interactions_rate,\n    metrics_all_conversions_value,\n    metrics_average_cost,\n    metrics_average_cpc,\n    metrics_average_cpm,\n    metrics_average_cpv,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_from_interactions_rate,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_cost_per_all_conversions,\n    metrics_cost_per_conversion,\n    metrics_cross_device_conversions,\n    metrics_ctr,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interaction_rate,\n    metrics_interactions,\n    metrics_value_per_all_conversions,\n    metrics_value_per_conversion,\n    metrics_video_view_rate,\n    metrics_video_views,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_day_of_week,\n    segments_device,\n    segments_geo_target_most_specific_location,\n    segments_month,\n    segments_quarter,\n    segments_week,\n    segments_year,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    base\nUNION ALL\nSELECT\n    campaign_id,\n    customer_id,\n    geographic_view_country_criterion_id,\n    campaign_status,\n    geographic_view_location_type,\n    metrics_all_conversions,\n    metrics_all_conversions_from_interactions_rate,\n    metrics_all_conversions_value,\n    metrics_average_cost,\n    metrics_average_cpc,\n    metrics_average_cpm,\n    metrics_average_cpv,\n    metrics_clicks,\n    metrics_conversions,\n    metrics_conversions_from_interactions_rate,\n    metrics_conversions_value,\n    metrics_cost_micros,\n    metrics_cost_per_all_conversions,\n    metrics_cost_per_conversion,\n    metrics_cross_device_conversions,\n    metrics_ctr,\n    metrics_impressions,\n    metrics_interaction_event_types,\n    metrics_interaction_rate,\n    metrics_interactions,\n    metrics_value_per_all_conversions,\n    metrics_value_per_conversion,\n    metrics_video_view_rate,\n    metrics_video_views,\n    metrics_view_through_conversions,\n    segments_ad_network_type,\n    segments_date,\n    segments_day_of_week,\n    segments_device,\n    segments_geo_target_most_specific_location,\n    segments_month,\n    segments_quarter,\n    segments_week,\n    segments_year,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_geo_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.563793Z", "completed_at": "2025-08-20T19:34:24.565517Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.565745Z", "completed_at": "2025-08-20T19:34:24.565750Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0031747817993164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_keyword", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        DISTINCT ad_group_criterion_criterion_id,\n        ad_group_criterion_keyword_match_type,\n        ad_group_criterion_keyword_text\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_Keyword_8196795413`\n),\nblue_vine AS (\n    SELECT\n        DISTINCT ad_group_criterion_criterion_id,\n        ad_group_criterion_keyword_match_type,\n        ad_group_criterion_keyword_text\n    FROM\n        `secure-electron-279822.google_bluevine.ads_Keyword_2828502255`\n)\nSELECT\n    *\nFROM\n    base\nUNION ALL\nSELECT\n    *\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_keyword`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.567529Z", "completed_at": "2025-08-20T19:34:24.569442Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.569673Z", "completed_at": "2025-08-20T19:34:24.569677Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003412961959838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_keyword_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        ad_group_criterion_criterion_id,\n        ad_group_id,\n        metrics_cost_micros,\n        metrics_clicks,\n        metrics_impressions,\n        metrics_conversions,\n        metrics_conversions_value,\n        segments_date\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_KeywordBasicStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        ad_group_criterion_criterion_id,\n        ad_group_id,\n        metrics_cost_micros,\n        metrics_clicks,\n        metrics_impressions,\n        metrics_conversions,\n        metrics_conversions_value,\n        segments_date\n    FROM\n        `secure-electron-279822.google_bluevine.ads_KeywordBasicStats_2828502255`\n)\nSELECT\n    *\nFROM\n    base\nUNION ALL\nSELECT\n    *\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_keyword_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.571691Z", "completed_at": "2025-08-20T19:34:24.573436Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.573698Z", "completed_at": "2025-08-20T19:34:24.573704Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035402774810791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_search_term", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        DISTINCT ad_group_ad_ad_id,\n        search_term_view_search_term,\n        segments_search_term_match_type\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_SearchQueryConversionStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        DISTINCT ad_group_ad_ad_id,\n        search_term_view_search_term,\n        segments_search_term_match_type\n    FROM\n        `secure-electron-279822.google_bluevine.ads_SearchQueryConversionStats_2828502255`\n)\nSELECT\n    *\nFROM\n    base\nUNION ALL\nSELECT\n    *\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_search_term`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.575665Z", "completed_at": "2025-08-20T19:34:24.578065Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.578336Z", "completed_at": "2025-08-20T19:34:24.578342Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004204273223876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_search_term_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        ad_group_ad_ad_id,\n        ad_group_id,\n        campaign_id,\n        customer_id,\n        metrics_absolute_top_impression_percentage,\n        metrics_all_conversions,\n        metrics_all_conversions_from_interactions_rate,\n        metrics_all_conversions_value,\n        metrics_average_cost,\n        metrics_average_cpc,\n        metrics_average_cpe,\n        metrics_average_cpm,\n        metrics_average_cpv,\n        metrics_clicks,\n        metrics_conversions,\n        metrics_conversions_from_interactions_rate,\n        metrics_conversions_value,\n        metrics_cost_micros,\n        metrics_cost_per_all_conversions,\n        metrics_cost_per_conversion,\n        metrics_cross_device_conversions,\n        metrics_ctr,\n        metrics_engagement_rate,\n        metrics_engagements,\n        metrics_impressions,\n        metrics_interaction_event_types,\n        metrics_interaction_rate,\n        metrics_interactions,\n        metrics_top_impression_percentage,\n        metrics_value_per_all_conversions,\n        metrics_value_per_conversion,\n        metrics_video_quartile_p100_rate,\n        metrics_video_quartile_p25_rate,\n        metrics_video_quartile_p50_rate,\n        metrics_video_quartile_p75_rate,\n        metrics_video_view_rate,\n        metrics_video_views,\n        metrics_view_through_conversions,\n        search_term_view_search_term,\n        search_term_view_status,\n        segments_ad_network_type,\n        segments_date,\n        segments_day_of_week,\n        segments_device,\n        segments_keyword_ad_group_criterion,\n        segments_month,\n        segments_quarter,\n        segments_search_term_match_type,\n        segments_week,\n        segments_year,\n        _LATEST_DATE,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_SearchQueryStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        ad_group_ad_ad_id,\n        ad_group_id,\n        campaign_id,\n        customer_id,\n        metrics_absolute_top_impression_percentage,\n        metrics_all_conversions,\n        metrics_all_conversions_from_interactions_rate,\n        metrics_all_conversions_value,\n        metrics_average_cost,\n        metrics_average_cpc,\n        metrics_average_cpe,\n        metrics_average_cpm,\n        metrics_average_cpv,\n        metrics_clicks,\n        metrics_conversions,\n        metrics_conversions_from_interactions_rate,\n        metrics_conversions_value,\n        metrics_cost_micros,\n        metrics_cost_per_all_conversions,\n        metrics_cost_per_conversion,\n        metrics_cross_device_conversions,\n        metrics_ctr,\n        metrics_engagement_rate,\n        metrics_engagements,\n        metrics_impressions,\n        metrics_interaction_event_types,\n        metrics_interaction_rate,\n        metrics_interactions,\n        metrics_top_impression_percentage,\n        metrics_value_per_all_conversions,\n        metrics_value_per_conversion,\n        metrics_video_quartile_p100_rate,\n        metrics_video_quartile_p25_rate,\n        metrics_video_quartile_p50_rate,\n        metrics_video_quartile_p75_rate,\n        metrics_video_view_rate,\n        metrics_video_views,\n        metrics_view_through_conversions,\n        search_term_view_search_term,\n        search_term_view_status,\n        segments_ad_network_type,\n        segments_date,\n        segments_day_of_week,\n        segments_device,\n        segments_keyword_ad_group_criterion,\n        segments_month,\n        segments_quarter,\n        segments_search_term_match_type,\n        segments_week,\n        segments_year,\n        _LATEST_DATE,\n        _DATA_DATE\n    FROM\n        `secure-electron-279822.google_bluevine.ads_SearchQueryStats_2828502255`\n)\nSELECT\n    *\nFROM\n    base\nUNION ALL\nSELECT\n    *\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_search_term_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.580394Z", "completed_at": "2025-08-20T19:34:24.582607Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.582858Z", "completed_at": "2025-08-20T19:34:24.582863Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037240982055664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_google_ads_video_stats", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_VideoNonClickStats_8196795413`\n),\nblue_vine AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.google_bluevine.ads_VideoNonClickStats_2828502255`\n)\nSELECT\n    ad_group_ad_ad_id,\n    ad_group_id,\n    campaign_id,\n    customer_id,\n    video_channel_id,\n    video_id,\n    ad_group_ad_status,\n    metrics_all_conversions,\n    metrics_all_conversions_from_interactions_rate,\n    metrics_all_conversions_value,\n    metrics_average_cpv,\n    metrics_cost_per_all_conversions,\n    metrics_cross_device_conversions,\n    metrics_engagement_rate,\n    metrics_engagements,\n    metrics_value_per_all_conversions,\n    metrics_video_quartile_p100_rate,\n    metrics_video_quartile_p25_rate,\n    metrics_video_quartile_p50_rate,\n    metrics_video_quartile_p75_rate,\n    metrics_video_view_rate,\n    metrics_video_views,\n    segments_ad_network_type,\n    segments_date,\n    segments_day_of_week,\n    segments_device,\n    segments_month,\n    segments_quarter,\n    segments_week,\n    segments_year,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    base\nUNION ALL\nSELECT\n    ad_group_ad_ad_id,\n    ad_group_id,\n    campaign_id,\n    customer_id,\n    video_channel_id,\n    video_id,\n    ad_group_ad_status,\n    metrics_all_conversions,\n    metrics_all_conversions_from_interactions_rate,\n    metrics_all_conversions_value,\n    metrics_average_cpv,\n    metrics_cost_per_all_conversions,\n    metrics_cross_device_conversions,\n    metrics_engagement_rate,\n    metrics_engagements,\n    metrics_value_per_all_conversions,\n    metrics_video_quartile_p100_rate,\n    metrics_video_quartile_p25_rate,\n    metrics_video_quartile_p50_rate,\n    metrics_video_quartile_p75_rate,\n    metrics_video_view_rate,\n    metrics_video_views,\n    segments_ad_network_type,\n    segments_date,\n    segments_day_of_week,\n    segments_device,\n    segments_month,\n    segments_quarter,\n    segments_week,\n    segments_year,\n    _LATEST_DATE,\n    _DATA_DATE\nFROM\n    blue_vine", "relation_name": "`ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_video_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.584620Z", "completed_at": "2025-08-20T19:34:24.586542Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.586798Z", "completed_at": "2025-08-20T19:34:24.586803Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0034215450286865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__account_history", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT *\n    FROM `secure-electron-279822.linkedin_ads.account_history`\n),\n\nmacro AS (\n    SELECT\n        created_time AS created_time,\n        currency AS currency,\n        id AS id,\n        last_modified_time AS last_modified_time,\n        name AS name,\n        CAST(NULL AS STRING) AS status,\n        CAST(NULL AS STRING) AS type,\n        version_tag AS version_tag,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n),\n\nfields AS (\n    SELECT \n        source_relation,\n        id AS account_id,\n        name AS account_name,\n        currency,\n        CAST(version_tag AS NUMERIC) AS version_tag,\n        status,\n        type,\n        CAST(last_modified_time AS TIMESTAMP) AS last_modified_at,\n        CAST(created_time AS TIMESTAMP) AS created_at,\n        ROW_NUMBER() OVER (PARTITION BY id ORDER BY last_modified_time DESC) = 1 AS is_latest_version\n    FROM macro\n)\n\nSELECT *\nFROM fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.588552Z", "completed_at": "2025-08-20T19:34:24.590538Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.590771Z", "completed_at": "2025-08-20T19:34:24.590776Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0036323070526123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__ad_analytics_by_campaign", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT * \n    FROM `secure-electron-279822.linkedin_ads.ad_analytics_by_campaign`\n),\n\nmacro AS (\n    SELECT\n        campaign_id AS campaign_id,\n        clicks AS clicks,\n        cost_in_local_currency AS cost_in_local_currency,\n        cost_in_usd AS cost_in_usd,\n        day AS day,\n        impressions AS impressions,\n        conversion_value_in_local_currency AS conversion_value_in_local_currency,\n        external_website_conversions AS external_website_conversions,\n        one_click_leads AS one_click_leads,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n),\n\nfields AS (\n    SELECT \n        source_relation,\n        DATE(day) AS date_day,\n        campaign_id,\n        clicks,\n        impressions,\n        cost_in_usd AS cost,\n        COALESCE(CAST(conversion_value_in_local_currency AS FLOAT64), 0) AS conversion_value_in_local_currency,\n        COALESCE(CAST(external_website_conversions AS INT64), 0) AS external_website_conversions,\n        COALESCE(CAST(one_click_leads AS INT64), 0) AS one_click_leads\n    FROM macro\n)\n\nSELECT *\nFROM fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__ad_analytics_by_campaign`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.593036Z", "completed_at": "2025-08-20T19:34:24.594861Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.595146Z", "completed_at": "2025-08-20T19:34:24.595152Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0036003589630126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__ad_analytics_by_creative", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT *\n    FROM `secure-electron-279822.linkedin_ads.ad_analytics_by_creative`\n),\n\nmacro AS (\n    SELECT\n        clicks AS clicks,\n        cost_in_local_currency AS cost_in_local_currency,\n        cost_in_usd AS cost_in_usd,\n        creative_id AS creative_id,\n        day AS day,\n        impressions AS impressions,\n        conversion_value_in_local_currency AS conversion_value_in_local_currency,\n        external_website_conversions AS external_website_conversions,\n        one_click_leads AS one_click_leads,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n),\n\nfields AS (\n    SELECT\n        source_relation,\n        DATE(day) AS date_day,\n        creative_id,\n        clicks,\n        impressions,\n        cost_in_usd AS cost,\n        COALESCE(CAST(conversion_value_in_local_currency AS FLOAT64), 0) AS conversion_value_in_local_currency,\n        COALESCE(CAST(external_website_conversions AS INT64), 0) AS external_website_conversions,\n        COALESCE(CAST(one_click_leads AS INT64), 0) AS one_click_leads\n    FROM macro\n)\n\nSELECT *\nFROM fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__ad_analytics_by_creative`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.597051Z", "completed_at": "2025-08-20T19:34:24.599320Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.599642Z", "completed_at": "2025-08-20T19:34:24.599647Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003920555114746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__campaign_group_history", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT *\n    FROM `secure-electron-279822.linkedin_ads.campaign_group_history`\n),\n\nmacro AS (\n    SELECT\n        account_id AS account_id,\n        CAST(NULL AS BOOL) AS backfilled,\n        created_time AS created_time,\n        id AS id,\n        last_modified_time AS last_modified_time,\n        name AS name,\n        CAST(NULL AS TIMESTAMP) AS run_schedule_end,\n        CAST(NULL AS TIMESTAMP) AS run_schedule_start,\n        CAST(NULL AS STRING) AS status,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n),\n\nfields AS (\n    SELECT \n        source_relation,\n        id AS campaign_group_id,\n        name AS campaign_group_name,\n        account_id,\n        status,\n        backfilled AS is_backfilled,\n        CAST(run_schedule_start AS TIMESTAMP) AS run_schedule_start_at,\n        CAST(run_schedule_end AS TIMESTAMP) AS run_schedule_end_at,\n        CAST(last_modified_time AS TIMESTAMP) AS last_modified_at,\n        CAST(created_time AS TIMESTAMP) AS created_at,\n        ROW_NUMBER() OVER (PARTITION BY id ORDER BY last_modified_time DESC) = 1 AS is_latest_version\n    FROM macro\n)\n\nSELECT *\nFROM fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_group_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.601480Z", "completed_at": "2025-08-20T19:34:24.603165Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.603428Z", "completed_at": "2025-08-20T19:34:24.603434Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003239870071411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__campaign_history", "compiled": true, "compiled_code": "WITH base AS (\n\n    SELECT *\n    FROM `secure-electron-279822.linkedin_ads.campaign_history`\n\n), macro AS (\n\n    SELECT \n        account_id AS account_id,\n        CAST(NULL AS BOOL) AS audience_expansion_enabled,\n        campaign_group_id AS campaign_group_id,\n        CAST(NULL AS STRING) AS cost_type,\n        created_time AS created_time,\n        CAST(NULL AS STRING) AS creative_selection,\n        CAST(NULL AS FLOAT64) AS daily_budget_amount,\n        CAST(NULL AS STRING) AS daily_budget_currency_code,\n        CAST(NULL AS STRING) AS format,\n        id AS id,\n        last_modified_time AS last_modified_time,\n        CAST(NULL AS STRING) AS locale_country,\n        CAST(NULL AS STRING) AS locale_language,\n        name AS name,\n        CAST(NULL AS STRING) AS objective_type,\n        CAST(NULL AS BOOL) AS offsite_delivery_enabled,\n        CAST(NULL AS STRING) AS optimization_target_type,\n        CAST(NULL AS TIMESTAMP) AS run_schedule_end,\n        CAST(NULL AS TIMESTAMP) AS run_schedule_start,\n        CAST(NULL AS STRING) AS status,\n        CAST(NULL AS STRING) AS type,\n        CAST(NULL AS FLOAT64) AS unit_cost_amount,\n        CAST(NULL AS STRING) AS unit_cost_currency_code,\n        version_tag AS version_tag,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n\n), fields AS (\n\n    SELECT \n        source_relation,\n        id AS campaign_id,\n        name AS campaign_name,\n        CAST(version_tag AS NUMERIC) AS version_tag,\n        campaign_group_id,\n        account_id,\n        status,\n        type,\n        cost_type,\n        creative_selection,\n        daily_budget_amount,\n        daily_budget_currency_code,\n        unit_cost_amount,\n        unit_cost_currency_code,\n        format,\n        locale_country,\n        locale_language,\n        objective_type,\n        optimization_target_type,\n        audience_expansion_enabled AS is_audience_expansion_enabled,\n        offsite_delivery_enabled AS is_offsite_delivery_enabled,\n        CAST(run_schedule_start AS TIMESTAMP) AS run_schedule_start_at,\n        CAST(run_schedule_end AS TIMESTAMP) AS run_schedule_end_at,\n        CAST(last_modified_time AS TIMESTAMP) AS last_modified_at,\n        CAST(created_time AS TIMESTAMP) AS created_at,\n        ROW_NUMBER() OVER (PARTITION BY id ORDER BY last_modified_time DESC) = 1 AS is_latest_version\n    FROM macro\n\n)\n\nSELECT *\nFROM fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.605228Z", "completed_at": "2025-08-20T19:34:24.606992Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.607233Z", "completed_at": "2025-08-20T19:34:24.607238Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0033032894134521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__creative_history", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `secure-electron-279822.linkedin_ads.creative_history`\n\n), macro as (\n\n    select \n        campaign_id,\n        created_at as created_time,\n        timestamp(null) as created_at,\n        id,\n        timestamp(null) as last_modified_time,\n        last_modified_at,\n        intended_status,\n        cast(null as string) as status,\n        text_ad_landing_page,\n        spotlight_landing_page,\n        cast('' as string) as source_relation\n    from base\n\n), fields as (\n\n    select\n        source_relation,\n        id as creative_id,\n        campaign_id,\n        coalesce(status, intended_status) as status,\n        coalesce(text_ad_landing_page, spotlight_landing_page) as click_uri,\n        cast(coalesce(last_modified_time, last_modified_at) as timestamp) as last_modified_at,\n        cast(coalesce(created_time, created_at) as timestamp) as created_at,\n        case \n            when text_ad_landing_page is not null then 'text_ad'\n            when spotlight_landing_page is not null then 'spotlight'\n            else null\n        end as click_uri_type\n    from macro\n\n), url_fields as (\n\n    select \n        *,\n        row_number() over (partition by creative_id order by last_modified_at desc) = 1 as is_latest_version,\n\n        split(click_uri, '?')[safe_offset(0)] as base_url,\n\n        cast(\n            split(\n                split(\n                    replace(replace(replace(click_uri, 'android-app://', ''), 'http://', ''), 'https://', ''), \n                    '/'\n                )[safe_offset(0)], \n                '?'\n            )[safe_offset(0)] as string\n        ) as url_host,\n\n        '/' || cast(\n            split(\n                right(\n                    replace(replace(click_uri, 'http://', ''), 'https://', ''),\n                    length(\n                        replace(replace(click_uri, 'http://', ''), 'https://', '')\n                    )\n                    - coalesce(\n                        nullif(\n                            strpos(replace(replace(click_uri, 'http://', ''), 'https://', ''), '/'),\n                            0\n                        ),\n                        strpos(replace(replace(click_uri, 'http://', ''), 'https://', ''), '?') - 1\n                    )\n                ),\n                '?'\n            )[safe_offset(0)] as string\n        ) as url_path,\n\n        nullif(split(split(click_uri, 'utm_source=')[safe_offset(1)], '&')[safe_offset(0)], '') as utm_source,\n        nullif(split(split(click_uri, 'utm_medium=')[safe_offset(1)], '&')[safe_offset(0)], '') as utm_medium,\n        nullif(split(split(click_uri, 'utm_campaign=')[safe_offset(1)], '&')[safe_offset(0)], '') as utm_campaign,\n        nullif(split(split(click_uri, 'utm_content=')[safe_offset(1)], '&')[safe_offset(0)], '') as utm_content,\n        nullif(split(split(click_uri, 'utm_term=')[safe_offset(1)], '&')[safe_offset(0)], '') as utm_term\n\n    from fields\n)\n\nselect *\nfrom url_fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__creative_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.609020Z", "completed_at": "2025-08-20T19:34:24.612177Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.612441Z", "completed_at": "2025-08-20T19:34:24.612446Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004849433898925781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__geo", "compiled": true, "compiled_code": "WITH base AS (\n\n    SELECT * \n    FROM secure-electron-279822.linkedin_ads.geo\n\n),\n\nmacro AS (\n\n    SELECT\n        id AS id,\n        value AS value,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n\n),\n\nfields AS (\n    \n    SELECT \n        source_relation,\n        id AS geo_id,\n        value\n    FROM macro\n\n)\n\nSELECT *\nFROM fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__geo`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.614408Z", "completed_at": "2025-08-20T19:34:24.616334Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.616609Z", "completed_at": "2025-08-20T19:34:24.616615Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003512859344482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__monthly_ad_analytics_by_country", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from secure-electron-279822.linkedin_ads.monthly_ad_analytics_by_member_country\n\n),\n\nmacro as (\n\n    select\n        campaign_id,\n        month as date_month,\n        clicks,\n        member_country,\n        impressions,\n        conversion_value_in_local_currency,\n        cost_in_local_currency,\n        cost_in_usd,\n        cast(null as string) as external_website_conversions,\n        one_click_leads,\n        cast('' as string) as source_relation\n    from base\n\n),\n\nfields as (\n    \n    select \n        source_relation,\n\n        -- Convert 'YYYY-MM' \u2192 first day of month\n        parse_date('%Y-%m-%d', concat(split(date_month, '-')[offset(0)], '-', lpad(split(date_month, '-')[offset(1)], 2, '0'), '-01')) as date_month,\n\n        campaign_id,\n        member_country as member_country_geo_id,\n        clicks,\n        impressions,\n        cost_in_usd as cost,\n        coalesce(cast(conversion_value_in_local_currency as float64), 0) as conversion_value_in_local_currency,\n        coalesce(cast(external_website_conversions as int64), 0) as external_website_conversions,\n        coalesce(cast(one_click_leads as int64), 0) as one_click_leads\n\n    from macro\n)\n\nselect *\nfrom fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__monthly_ad_analytics_by_country`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.618471Z", "completed_at": "2025-08-20T19:34:24.620315Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.620591Z", "completed_at": "2025-08-20T19:34:24.620597Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003584146499633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_linkedin_ads__monthly_ad_analytics_by_region", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT * \n    FROM `secure-electron-279822.linkedin_ads.monthly_ad_analytics_by_member_region`\n),\n\nmacro AS (\n    SELECT\n        campaign_id AS campaign_id,\n        month AS date_month, \n        clicks AS clicks,\n        member_region AS member_region,\n        impressions AS impressions,\n        conversion_value_in_local_currency AS conversion_value_in_local_currency,\n        cost_in_local_currency AS cost_in_local_currency,\n        cost_in_usd AS cost_in_usd,\n        CAST(NULL AS STRING) AS external_website_conversions,\n        one_click_leads AS one_click_leads,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n),\n\nfields AS (\n    SELECT \n        source_relation,\n        PARSE_DATE('%Y-%m-%d', CONCAT(SPLIT(date_month, '-')[OFFSET(0)], '-', LPAD(SPLIT(date_month, '-')[OFFSET(1)], 2, '0'), '-01')) AS date_month,\n        campaign_id,\n        member_region AS member_region_geo_id,\n        impressions,\n        clicks,\n        cost_in_usd AS cost,\n        COALESCE(CAST(conversion_value_in_local_currency AS FLOAT64), 0) AS conversion_value_in_local_currency,\n        COALESCE(CAST(external_website_conversions AS INT64), 0) AS external_website_conversions,\n        COALESCE(CAST(one_click_leads AS INT64), 0) AS one_click_leads\n    FROM macro\n)\n\nSELECT * FROM fields", "relation_name": "`ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__monthly_ad_analytics_by_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.622569Z", "completed_at": "2025-08-20T19:34:24.624533Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.624864Z", "completed_at": "2025-08-20T19:34:24.624869Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035867691040039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__account_daily_report", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822`.`bing_ads`.`account_performance_daily_report`\n\n),\n\nfields as (\n\n    select\n        account_id as account_id, \n        ad_distribution as ad_distribution, \n        bid_match_type as bid_match_type, \n        clicks as clicks, \n        currency_code as currency_code, \n        date as date, \n        delivered_match_type as delivered_match_type, \n        device_os as device_os, \n        device_type as device_type, \n        impressions as impressions, \n        network as network, \n        spend as spend, \n        top_vs_other as top_vs_other, \n        conversions_qualified as conversions_qualified, \n        conversions as conversions, \n        revenue as revenue, \n        all_conversions_qualified as all_conversions_qualified,\n        cast('' as STRING) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        device_os,\n        device_type,\n        network,\n        currency_code, \n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(cast(conversions_qualified as integer), cast(conversions as integer)), 0) as conversions,\n        coalesce(cast(revenue as float64), 0) as conversions_value,\n        coalesce(cast(all_conversions_qualified as integer), 0) as all_conversions\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_daily_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.626687Z", "completed_at": "2025-08-20T19:34:24.628282Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.628520Z", "completed_at": "2025-08-20T19:34:24.628525Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003093242645263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__account_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.account_history`\n\n),\n\nfields as (\n\n    select\n        id as id, \n        name as name, \n        last_modified_time as last_modified_time, \n        time_zone as time_zone, \n        currency_code as currency_code,\n        cast('' as STRING) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as account_id,\n        name as account_name,\n        last_modified_time as modified_at,\n        time_zone,\n        currency_code,\n        row_number() over (\n            partition by source_relation, id \n            order by last_modified_time desc\n        ) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.630284Z", "completed_at": "2025-08-20T19:34:24.632389Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.632674Z", "completed_at": "2025-08-20T19:34:24.632679Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0036771297454833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__ad_daily_report", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.ad_performance_daily_report`\n\n),\n\nfields as (\n\n    select\n        account_id as account_id, \n        ad_distribution as ad_distribution, \n        ad_group_id as ad_group_id, \n        ad_id as ad_id, \n        bid_match_type as bid_match_type, \n        campaign_id as campaign_id, \n        clicks as clicks, \n        currency_code as currency_code, \n        date as date, \n        delivered_match_type as delivered_match_type, \n        device_os as device_os, \n        device_type as device_type, \n        impressions as impressions, \n        language as language, \n        network as network, \n        spend as spend, \n        top_vs_other as top_vs_other, \n        conversions_qualified as conversions_qualified, \n        conversions as conversions, \n        revenue as revenue, \n        all_conversions as all_conversions, \n        all_conversions_qualified as all_conversions_qualified, \n        all_revenue as all_revenue,\n        cast('' as STRING) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(cast(conversions_qualified as INT64), cast(conversions as INT64)), 0) as conversions,\n        coalesce(cast(revenue as FLOAT64), 0) as conversions_value,\n        coalesce(coalesce(cast(all_conversions_qualified as INT64), cast(all_conversions as INT64)), 0) as all_conversions,\n        -- sometimes this field comes in as a string\n        coalesce(cast(replace(cast(all_revenue as STRING), ',', '') as FLOAT64), 0) as all_conversions_value\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_daily_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.634474Z", "completed_at": "2025-08-20T19:34:24.636157Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.636410Z", "completed_at": "2025-08-20T19:34:24.636415Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0032041072845458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__ad_group_daily_report", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.ad_group_performance_daily_report`\n\n),\n\nfields as (\n\n    select\n        account_id as account_id, \n        ad_distribution as ad_distribution, \n        ad_group_id as ad_group_id, \n        bid_match_type as bid_match_type, \n        campaign_id as campaign_id, \n        clicks as clicks, \n        currency_code as currency_code, \n        date as date, \n        delivered_match_type as delivered_match_type, \n        device_os as device_os, \n        device_type as device_type, \n        impressions as impressions, \n        language as language, \n        network as network, \n        spend as spend, \n        top_vs_other as top_vs_other, \n        conversions_qualified as conversions_qualified, \n        conversions as conversions, \n        revenue as revenue, \n        all_conversions as all_conversions, \n        all_conversions_qualified as all_conversions_qualified, \n        all_revenue as all_revenue,\n        cast('' as STRING) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(cast(conversions_qualified as INT64), cast(conversions as INT64)), 0) as conversions,\n        coalesce(cast(revenue as FLOAT64), 0) as conversions_value,\n        coalesce(coalesce(cast(all_conversions_qualified as INT64), cast(all_conversions as INT64)), 0) as all_conversions,\n        -- sometimes this field comes in as a string\n        coalesce(cast(replace(cast(all_revenue as STRING), ',', '') as FLOAT64), 0) as all_conversions_value\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_daily_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.638195Z", "completed_at": "2025-08-20T19:34:24.640248Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.640513Z", "completed_at": "2025-08-20T19:34:24.640518Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00386810302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__ad_group_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.ad_group_history`\n\n),\n\nfields as (\n\n    select\n        id as id, \n        name as name, \n        campaign_id as campaign_id, \n        modified_time as modified_time, \n        start_date as start_date, \n        end_date as end_date, \n        status as status,\n        cast('' as STRING) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_group_id,\n        name as ad_group_name,\n        campaign_id,\n        modified_time as modified_at,\n        start_date,\n        end_date,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.642581Z", "completed_at": "2025-08-20T19:34:24.644102Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.644335Z", "completed_at": "2025-08-20T19:34:24.644340Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0029952526092529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__ad_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.ad_history`\n\n),\n\nfields as (\n\n    select\n        id as id,\n        title as title,\n        title_part_1 as title_part_1,\n        title_part_2 as title_part_2,\n        title_part_3 as title_part_3,\n        final_url as final_url,\n        ad_group_id as ad_group_id,\n        modified_time as modified_time,\n        status as status,\n        type as type,\n        domain as domain,\n        cast('' as STRING) as source_relation\n    from base\n\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_id,\n        title_part_1 as ad_name,\n        title,\n        title_part_1,\n        title_part_2,\n        title_part_3,\n        final_url,\n        domain,\n        ad_group_id,\n        modified_time as modified_at,\n        status,\n        type,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.646136Z", "completed_at": "2025-08-20T19:34:24.647680Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.647975Z", "completed_at": "2025-08-20T19:34:24.647980Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0032606124877929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__campaign_daily_report", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.campaign_performance_daily_report`\n\n),\n\nfields as (\n\n    select\n        account_id as account_id,\n        ad_distribution as ad_distribution,\n        bid_match_type as bid_match_type,\n        campaign_id as campaign_id,\n        clicks as clicks,\n        currency_code as currency_code,\n        date as date,\n        delivered_match_type as delivered_match_type,\n        device_os as device_os,\n        device_type as device_type,\n        impressions as impressions,\n        network as network,\n        spend as spend,\n        top_vs_other as top_vs_other,\n        budget_association_status as budget_association_status,\n        budget_name as budget_name,\n        cast(null as STRING) as budget_status,\n        conversions_qualified as conversions_qualified,\n        conversions as conversions,\n        revenue as revenue,\n        all_conversions as all_conversions,\n        all_conversions_qualified as all_conversions_qualified,\n        all_revenue as all_revenue,\n        cast('' as STRING) as source_relation\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        budget_association_status,\n        budget_name,\n        budget_status,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(cast(conversions_qualified as int64), cast(conversions as int64)), 0) as conversions,\n        coalesce(cast(revenue as float64), 0) as conversions_value,\n        coalesce(coalesce(cast(all_conversions_qualified as int64), cast(all_conversions as int64)), 0) as all_conversions,\n        -- sometimes this field comes in as a string\n        coalesce(cast(replace(cast(all_revenue as STRING), ',', '') as float64), 0) as all_conversions_value\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_daily_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.649896Z", "completed_at": "2025-08-20T19:34:24.651751Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.652036Z", "completed_at": "2025-08-20T19:34:24.652042Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0034685134887695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__campaign_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.campaign_history`\n\n),\n\nfields as (\n\n    select\n        id as id, \n        name as name, \n        account_id as account_id, \n        modified_time as modified_time, \n        type as type, \n        time_zone as time_zone, \n        status as status, \n        budget as budget, \n        budget_id as budget_id, \n        budget_type as budget_type, \n        language as language,\n        cast('' as STRING) as source_relation\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id,\n        name as campaign_name,\n        account_id,\n        modified_time as modified_at,\n        type,\n        time_zone,\n        status,\n        budget,\n        budget_id,\n        budget_type,\n        language,\n        row_number() over (\n            partition by source_relation, id \n            order by modified_time desc\n        ) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.653859Z", "completed_at": "2025-08-20T19:34:24.655857Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.656163Z", "completed_at": "2025-08-20T19:34:24.656168Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035762786865234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__geographic_daily_report", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.geographic_performance_daily_report`\n\n),\n\nfields as (\n\n    select\n        account_id,\n        ad_distribution,\n        ad_group_id,\n        all_conversions,\n        all_conversions_qualified,\n        all_revenue,\n        bid_match_type,\n        campaign_id,\n        city,\n        clicks,\n        conversions,\n        conversions_qualified,\n        country,\n        county,\n        currency_code,\n        date,\n        delivered_match_type,\n        device_os,\n        device_type,\n        goal,\n        impressions,\n        language,\n        location_id,\n        location_type,\n        metro_area,\n        cast(null as STRING) as most_specific_location,\n        network,\n        postal_code,\n        spend,\n        state,\n        top_vs_other,\n        revenue,\n        cast('' as STRING) as source_relation\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        country,\n        state as region,\n        county,\n        postal_code,\n        city,\n        metro_area,\n        location_id,\n        location_type,\n        most_specific_location,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        goal,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(cast(conversions_qualified as int64), cast(conversions as int64)), 0) as conversions,\n        coalesce(cast(revenue as float64), 0) as conversions_value,\n        coalesce(coalesce(cast(all_conversions_qualified as int64), cast(all_conversions as int64)), 0) as all_conversions,\n        coalesce(cast(replace(cast(all_revenue as string), ',', '') as float64), 0) as all_conversions_value\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__geographic_daily_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.658145Z", "completed_at": "2025-08-20T19:34:24.659746Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.660039Z", "completed_at": "2025-08-20T19:34:24.660047Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0036249160766601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__keyword_daily_report", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.keyword_performance_daily_report`\n\n),\n\nfields as (\n\n    select\n        account_id,\n        ad_distribution,\n        ad_group_id,\n        ad_id,\n        bid_match_type,\n        campaign_id,\n        clicks,\n        currency_code,\n        date,\n        delivered_match_type,\n        device_os,\n        device_type,\n        impressions,\n        keyword_id,\n        language,\n        network,\n        spend,\n        top_vs_other,\n        conversions_qualified,\n        conversions,\n        revenue,\n        all_conversions,\n        all_conversions_qualified,\n        all_revenue,\n        cast('' as STRING) as source_relation\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(cast(conversions_qualified as int64), cast(conversions as int64)), 0) as conversions,\n        coalesce(cast(revenue as float64), 0) as conversions_value,\n        coalesce(coalesce(cast(all_conversions_qualified as int64), cast(all_conversions as int64)), 0) as all_conversions,\n        coalesce(cast(replace(cast(all_revenue as STRING), ',', '') as float64), 0) as all_conversions_value\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__keyword_daily_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.662435Z", "completed_at": "2025-08-20T19:34:24.664032Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.664276Z", "completed_at": "2025-08-20T19:34:24.664281Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003187417984008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__keyword_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from `secure-electron-279822.bing_ads.keyword_history`\n\n),\n\nfields as (\n\n    select\n        id,\n        name,\n        modified_time,\n        ad_group_id,\n        match_type,\n        status,\n        cast('' as STRING) as source_relation\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as keyword_id,\n        name as keyword_name,\n        modified_time as modified_at,\n        ad_group_id,\n        match_type,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__keyword_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.666263Z", "completed_at": "2025-08-20T19:34:24.667844Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.668100Z", "completed_at": "2025-08-20T19:34:24.668105Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003177642822265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_microsoft_ads__search_daily_report", "compiled": true, "compiled_code": "with base as (\n    select * \n    from `secure-electron-279822.bing_ads.search_query_performance_daily_report`\n),\n\nfields as (\n    select\n        account_id,\n        ad_group_id,\n        ad_id,\n        bid_match_type,\n        campaign_id,\n        clicks,\n        date,\n        delivered_match_type,\n        device_os,\n        device_type,\n        impressions,\n        keyword_id,\n        language,\n        network,\n        search_query,\n        spend,\n        top_vs_other,\n        conversions_qualified,\n        conversions,\n        revenue,\n        all_conversions,\n        all_conversions_qualified,\n        all_revenue,\n        cast('' as STRING) as source_relation\n    from base\n),\n\nfinal as (\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        search_query,\n        device_os,\n        device_type,\n        network,\n        language,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(cast(conversions_qualified as INT64), cast(conversions as INT64)), 0) as conversions,\n        coalesce(cast(revenue as FLOAT64), 0) as conversions_value,\n        coalesce(coalesce(cast(all_conversions_qualified as INT64), cast(all_conversions as INT64)), 0) as all_conversions,\n        coalesce(cast(replace(cast(all_revenue as STRING), ',', '') as FLOAT64), 0) as all_conversions_value\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__search_daily_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.669874Z", "completed_at": "2025-08-20T19:34:24.672068Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.672333Z", "completed_at": "2025-08-20T19:34:24.672338Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037157535552978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__ad_group_history", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `secure-electron-279822.pinterest_ads.ad_group_history`\n),\n\nfinal as (\n    select\n        cast('' as string) as source_relation,\n        cast(id as string) as ad_group_id,\n        name as ad_group_name,\n        status as ad_group_status,\n        ad_account_id as advertiser_id,\n        _fivetran_synced,\n        cast(campaign_id as string) as campaign_id,\n        created_time as created_at,\n        end_time,\n        pacing_delivery_type,\n        placement_group,\n        start_time,\n        summary_status,\n        row_number() over (partition by '', id order by _fivetran_synced desc) as rn\n    from base\n)\n\nselect *\nfrom final\nwhere rn = 1", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.674278Z", "completed_at": "2025-08-20T19:34:24.675774Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.676007Z", "completed_at": "2025-08-20T19:34:24.676012Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0030291080474853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__ad_group_report", "compiled": true, "compiled_code": "with base as (\n    select * \n    from `secure-electron-279822.pinterest_ads.ad_group_report`\n),\n\nfinal as (\n    select\n        cast('' as string) as source_relation,\n        date_trunc(date, day) as date_day,\n        cast(ad_group_id as string) as ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        cast(campaign_id as string) as campaign_id,\n        cast(advertiser_id as string) as advertiser_id,  -- <== MISSING COMMA FIXED HERE\n        coalesce(impression_1, 0) + coalesce(impression_2, 0) as impressions,\n        coalesce(clickthrough_1, 0) + coalesce(clickthrough_2, 0) as clicks,\n        coalesce(spend_in_micro_dollar, 0) / 1000000.0 as spend,\n        coalesce(total_conversions, 0) as total_conversions,\n        coalesce(total_conversions_quantity, 0) as total_conversions_quantity,\n        coalesce(total_conversions_value_in_micro_dollar, 0) / 1000000.0 as total_conversions_value\n    from base\n)\n\nselect * from final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.677761Z", "completed_at": "2025-08-20T19:34:24.679421Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.679710Z", "completed_at": "2025-08-20T19:34:24.679716Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037124156951904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__advertiser_history", "compiled": true, "compiled_code": "with base as (\n    select * \n    from `secure-electron-279822.pinterest_ads.advertiser_history`\n),\n\nfinal as (\n    select\n        cast('' as STRING) as source_relation,\n        cast(id as STRING) as advertiser_id,\n        name as advertiser_name,\n        country,\n        created_time as created_at,\n        currency as currency_code,\n        owner_user_id,\n        owner_username,\n        account_permissions as advertiser_permissions,\n        updated_time as updated_at,\n        row_number() over (partition by cast('' as STRING), id order by updated_time desc) = 1 as is_most_recent_record\n    from base\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.682212Z", "completed_at": "2025-08-20T19:34:24.683837Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.684095Z", "completed_at": "2025-08-20T19:34:24.684100Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0032684803009033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__advertiser_report", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT * \n    FROM secure-electron-279822.pinterest_ads.advertiser_report\n),\n\nfinal AS (\n    SELECT\n        CAST('' AS STRING) AS source_relation, \n        DATE_TRUNC(date, DAY) AS date_day,\n        CAST(advertiser_id AS STRING) AS advertiser_id,\n        COALESCE(impression_1, 0) + COALESCE(impression_2, 0) AS impressions,\n        COALESCE(clickthrough_1, 0) + COALESCE(clickthrough_2, 0) AS clicks,\n        COALESCE(spend_in_micro_dollar, 0) / 1000000.0 AS spend,\n        COALESCE(total_conversions, 0) AS total_conversions,\n        COALESCE(total_conversions_quantity, 0) AS total_conversions_quantity,\n        COALESCE(total_conversions_value_in_micro_dollar, 0) / 1000000.0 AS total_conversions_value\n    FROM base\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.686112Z", "completed_at": "2025-08-20T19:34:24.687790Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.688069Z", "completed_at": "2025-08-20T19:34:24.688074Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0032973289489746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__campaign_history", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT *\n    FROM `secure-electron-279822.pinterest_ads.campaign_history`\n), \n\nfields AS (\n    SELECT\n        _fivetran_synced,\n        created_time,\n        default_ad_group_budget_in_micro_currency,\n        is_automated_campaign,\n        is_campaign_budget_optimization,\n        is_flexible_daily_budgets,\n        id,\n        advertiser_id,\n        name,\n        status,\n        start_time,\n        end_time,\n        daily_spend_cap,\n        lifetime_spend_cap,\n        objective_type,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n), \n\nfinal AS (\n    SELECT\n        source_relation, \n        CAST(id AS STRING) AS campaign_id,\n        name AS campaign_name,\n        CAST(advertiser_id AS STRING) AS advertiser_id,\n        default_ad_group_budget_in_micro_currency,\n        is_automated_campaign,\n        is_campaign_budget_optimization,\n        is_flexible_daily_budgets,\n        status AS campaign_status,\n        _fivetran_synced,\n        created_time AS created_at,\n        start_time,\n        end_time,\n        daily_spend_cap,\n        lifetime_spend_cap,\n        objective_type,\n        ROW_NUMBER() OVER (PARTITION BY source_relation, id ORDER BY _fivetran_synced DESC) = 1 AS is_most_recent_record\n    FROM fields\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.689846Z", "completed_at": "2025-08-20T19:34:24.691724Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.692003Z", "completed_at": "2025-08-20T19:34:24.692008Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0034389495849609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__campaign_report", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT * \n    FROM `secure-electron-279822.pinterest_ads.campaign_report`\n),\n\nfields AS (\n    SELECT\n        _fivetran_synced,\n        advertiser_id,\n        campaign_id,\n        campaign_name,\n        campaign_status,\n        clickthrough_1,\n        clickthrough_2,\n        date,\n        impression_1,\n        impression_2,\n        spend_in_micro_dollar,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n),\n\nfinal AS (\n    SELECT\n        source_relation, \n        DATE_TRUNC(date, DAY) AS date_day,\n        CAST(campaign_id AS STRING) AS campaign_id,\n        campaign_name,\n        campaign_status,\n        CAST(advertiser_id AS STRING) AS advertiser_id,\n        COALESCE(impression_1,0) + COALESCE(impression_2,0) AS impressions,\n        COALESCE(clickthrough_1,0) + COALESCE(clickthrough_2,0) AS clicks,\n        COALESCE(spend_in_micro_dollar, 0) / 1000000.0 AS spend,\n        COALESCE(total_conversions, 0) AS total_conversions,\n        COALESCE(total_conversions_quantity, 0) AS total_conversions_quantity,\n        COALESCE(total_conversions_value_in_micro_dollar, 0) / 1000000.0 AS total_conversions_value\n    FROM fields\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.694090Z", "completed_at": "2025-08-20T19:34:24.695860Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.696305Z", "completed_at": "2025-08-20T19:34:24.696310Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035889148712158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__keyword_history", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT * \n    FROM `secure-electron-279822.pinterest_ads.keyword_history`\n),\n\nfields AS (\n    SELECT\n        _fivetran_id,\n        _fivetran_synced,\n        ad_group_id,\n        advertiser_id,\n        archived,\n        bid,\n        campaign_id,\n        id,\n        match_type,\n        parent_type,\n        value,\n        CAST('' AS STRING) AS source_relation\n    FROM base\n),\n\nfinal AS (\n    SELECT\n        source_relation,\n        CAST(id AS STRING) AS keyword_id,\n        value AS keyword_value,\n        _fivetran_id,\n        _fivetran_synced,\n        CAST(ad_group_id AS STRING) AS ad_group_id,\n        CAST(advertiser_id AS STRING) AS advertiser_id,\n        archived,\n        bid,\n        CAST(campaign_id AS STRING) AS campaign_id,\n        match_type,\n        parent_type,\n        ROW_NUMBER() OVER (PARTITION BY source_relation, id ORDER BY _fivetran_synced DESC) = 1 AS is_most_recent_record\n    FROM fields\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__keyword_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.698063Z", "completed_at": "2025-08-20T19:34:24.699650Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.699915Z", "completed_at": "2025-08-20T19:34:24.699920Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0034074783325195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__keyword_report", "compiled": true, "compiled_code": "with base as (\n    select * \n    from secure-electron-279822.pinterest_ads.keyword_report\n),\n\nfields as (\n    select\n        _fivetran_synced as _fivetran_synced,\n        ad_group_id as ad_group_id,\n        ad_group_name as ad_group_name,\n        ad_group_status as ad_group_status,\n        advertiser_id as advertiser_id,\n        campaign_id as campaign_id,\n        clickthrough_2 as clickthrough_2,\n        date as date,\n        impression_2 as impression_2,\n        keyword_id as keyword_id,\n        pin_promotion_id as pin_promotion_id,\n        total_conversions as total_conversions,\n        total_conversions_quantity as total_conversions_quantity,\n        total_conversions_value_in_micro_dollar as total_conversions_value_in_micro_dollar,\n        cast('' as STRING) as source_relation\n    from base\n),\n\nfinal as (\n    select\n        source_relation,\n        date_trunc(date, DAY) as date_day,\n        cast(keyword_id as STRING) as keyword_id,\n        cast(pin_promotion_id as STRING) as pin_promotion_id,\n        cast(ad_group_id as STRING) as ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        cast(campaign_id as STRING) as campaign_id,\n        cast(advertiser_id as STRING) as advertiser_id,\n        coalesce(impression_2, 0) as impressions,\n        coalesce(clickthrough_2, 0) as clicks,\n        coalesce(total_conversions, 0) as total_conversions,\n        coalesce(total_conversions_quantity, 0) as total_conversions_quantity,\n        coalesce(total_conversions_value_in_micro_dollar, 0) / 1000000.0 as total_conversions_value\n    from fields\n)\n\nselect * from final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.702000Z", "completed_at": "2025-08-20T19:34:24.703682Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.703936Z", "completed_at": "2025-08-20T19:34:24.703942Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0031936168670654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__pin_promotion_history", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `secure-electron-279822.pinterest_ads.pin_promotion_history`\n), \n\nfields as (\n    select\n        _fivetran_synced as _fivetran_synced,\n        ad_group_id as ad_group_id,\n        ad_account_id as ad_account_id,\n        cast(null as STRING) as android_deep_link,\n        cast(null as STRING) as click_tracking_url,\n        created_time as created_time,\n        creative_type as creative_type,\n        destination_url as destination_url,\n        id as id,\n        cast(null as STRING) as ios_deep_link,\n        cast(null as BOOLEAN) as is_pin_deleted,\n        cast(null as BOOLEAN) as is_removable,\n        name as name,\n        pin_id as pin_id,\n        cast(null as STRING) as review_status,\n        status as status,\n        cast(null as TIMESTAMP) as updated_time,\n        cast(null as STRING) as view_tracking_url,\n        cast('' as STRING) as source_relation\n    from base\n), \n\nfinal as (\n    select\n        source_relation,\n        cast(id as STRING) as pin_promotion_id,\n        cast(ad_account_id as STRING) as advertiser_id,\n        cast(ad_group_id as STRING) as ad_group_id,\n        created_time as created_at,\n        destination_url,\n\n        -- base_url = part before '?'\n        SPLIT(destination_url, '?')[SAFE_OFFSET(0)] as base_url,\n\n        -- Cleaned url host:\n        -- remove android-app://, http://, https:// first\n        -- then get the part before first '/' or entire string if no '/'\n        (\n            select\n                case \n                    when strpos(clean_url, '/') > 0 \n                    then substr(clean_url, 0, strpos(clean_url, '/') - 1)\n                    else clean_url\n                end\n            from (\n                select\n                    replace(\n                        replace(\n                            replace(destination_url, 'android-app://', ''), \n                        'http://', ''), \n                    'https://', '') as clean_url\n            )\n        ) as url_host,\n\n        -- url_path: everything after the host part until '?' or end of string\n        (\n            select\n                '/' || \n                case \n                    when strpos(path_and_params, '?') > 0\n                    then substr(path_and_params, 0, strpos(path_and_params, '?') - 1)\n                    else path_and_params\n                end\n            from (\n                select\n                    substr(\n                        replace(\n                            replace(destination_url, 'http://', ''),\n                        'https://', ''),\n                        ifnull(nullif(strpos(replace(replace(destination_url, 'http://', ''), 'https://', ''), '/'), 0), length(replace(replace(destination_url, 'http://', ''), 'https://', ''))) + 1\n                    ) as path_and_params\n            )\n        ) as url_path,\n\n        -- UTM parameters extraction\n        nullif(\n            SPLIT(SPLIT(destination_url, 'utm_source=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)], ''\n        ) as utm_source,\n\n        nullif(\n            SPLIT(SPLIT(destination_url, 'utm_medium=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)], ''\n        ) as utm_medium,\n\n        nullif(\n            SPLIT(SPLIT(destination_url, 'utm_campaign=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)], ''\n        ) as utm_campaign,\n\n        nullif(\n            SPLIT(SPLIT(destination_url, 'utm_content=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)], ''\n        ) as utm_content,\n\n        nullif(\n            SPLIT(SPLIT(destination_url, 'utm_term=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)], ''\n        ) as utm_term,\n\n        name as pin_name,\n        cast(pin_id as STRING) as pin_id,\n        status as pin_status,\n        creative_type,\n        _fivetran_synced,\n\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.705689Z", "completed_at": "2025-08-20T19:34:24.707178Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.707412Z", "completed_at": "2025-08-20T19:34:24.707416Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0029349327087402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__pin_promotion_report", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `secure-electron-279822.pinterest_ads.pin_promotion_targeting_report`\n),\n\nfields as (\n    select\n        _fivetran_synced,\n        date,\n        targeting_type,\n        targeting_value,\n        ad_group_id,\n        advertiser_id,\n        campaign_id,\n        pin_promotion_id,\n        clickthrough_2,\n        impression_2,\n        total_checkout_value_in_micro_dollar,  -- as an example of spend proxy\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar,\n        cast('' as string) as source_relation\n    from base\n),\n\nfinal as (\n    select\n        source_relation,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(date as timestamp) as date_day,\n        targeting_type,\n        targeting_value,\n        cast(ad_group_id as string) as ad_group_id,\n        cast(advertiser_id as string) as advertiser_id,\n        cast(campaign_id as string) as campaign_id,\n        cast(pin_promotion_id as string) as pin_promotion_id,\n        coalesce(impression_2, 0) as impressions,\n        coalesce(clickthrough_2, 0) as clicks,\n        coalesce(total_checkout_value_in_micro_dollar, 0) / 1000000.0 as spend,  -- Using checkout value as spend proxy\n        coalesce(total_conversions, 0) as total_conversions,\n        coalesce(total_conversions_quantity, 0) as total_conversions_quantity,\n        coalesce(total_conversions_value_in_micro_dollar, 0) / 1000000.0 as total_conversions_value\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.709145Z", "completed_at": "2025-08-20T19:34:24.711257Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.711563Z", "completed_at": "2025-08-20T19:34:24.711569Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003773212432861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__targeting_geo", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `secure-electron-279822.pinterest_ads.targeting_geo`\n\n), fields as (\n\n    select\n        country_id,\n        country_name,\n        _fivetran_synced,\n        cast('' as string) as source_relation\n    from base\n\n), final as (\n    select\n        source_relation,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(country_id as string) as country_id,\n        country_name\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__targeting_geo`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.713419Z", "completed_at": "2025-08-20T19:34:24.715157Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.715493Z", "completed_at": "2025-08-20T19:34:24.715498Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0033583641052246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_pinterest_ads__targeting_geo_region", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `secure-electron-279822.pinterest_ads.targeting_geo_region`\n\n), fields as (\n\n    select\n        _fivetran_synced,\n        country_id,\n        region_id,\n        region_name,\n        cast('' as string) as source_relation\n    from base\n\n), final as (\n    select\n        source_relation,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(country_id as string) as country_id,\n        cast(region_id as string) as region_id,\n        region_name\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__targeting_geo_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.717268Z", "completed_at": "2025-08-20T19:34:24.719352Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.719621Z", "completed_at": "2025-08-20T19:34:24.719626Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0039157867431640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_tiktok_ads__ad_group_history", "compiled": true, "compiled_code": "-- stg_tiktok_ads__ad_group_history\n\nWITH base AS (\n  SELECT *\n  FROM `secure-electron-279822.tiktok_ads.adgroup_history`\n), \n\nfinal AS (\n  SELECT\n    -- Identifiers\n    adgroup_id                           AS ad_group_id,\n    CAST(updated_at AS TIMESTAMP)       AS updated_at,\n    advertiser_id,\n    campaign_id,\n\n    -- Targeting & Audience\n    age_groups,\n    gender,\n    languages,\n    audience_type,\n    action_days,\n    action_categories,\n    interest_category_v_2               AS interest_category,\n\n    -- Ad Group Info\n    adgroup_name                         AS ad_group_name,\n    display_name,\n    category,\n    landing_page_url,\n\n    -- Budget & Frequency\n    budget,\n    frequency,\n    frequency_schedule,\n\n    -- Latest Record Flag\n    ROW_NUMBER() OVER (\n      PARTITION BY adgroup_id\n      ORDER BY updated_at DESC\n    ) = 1                               AS is_most_recent_record\n\n  FROM base\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_group_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.721708Z", "completed_at": "2025-08-20T19:34:24.723294Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.723552Z", "completed_at": "2025-08-20T19:34:24.723557Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0030739307403564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_tiktok_ads__ad_group_report_hourly", "compiled": true, "compiled_code": "-- stg_tiktok_ads__ad_group_report_hourly\n\nWITH base AS (\n  SELECT *\n  FROM `secure-electron-279822.tiktok_ads.adgroup_report_hourly`\n), \n\nfinal AS (\n  SELECT  \n    -- Identifiers & Timestamps\n    adgroup_id                             AS ad_group_id,\n    CAST(stat_time_hour AS TIMESTAMP)     AS stat_time_hour,\n\n    -- Performance Metrics\n    impressions,\n    clicks,\n    ctr,\n    cpc,\n    cpm,\n    spend,\n    reach,\n\n    -- Conversion Metrics\n    conversion,\n    cost_per_conversion,\n    conversion_rate,\n\n    -- Engagement Metrics\n    likes,\n    comments,\n    shares,\n    profile_visits,\n    follows,\n\n    -- Video Metrics\n    video_play_actions,\n    video_watched_2_s,\n    video_watched_6_s,\n    video_views_p_25,\n    video_views_p_50,\n    video_views_p_75,\n    average_video_play,\n    average_video_play_per_user\n  FROM base\n) \n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_group_report_hourly`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.725299Z", "completed_at": "2025-08-20T19:34:24.726836Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.727095Z", "completed_at": "2025-08-20T19:34:24.727100Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003090381622314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_tiktok_ads__ad_history", "compiled": true, "compiled_code": "WITH base AS (\n  SELECT *\n  FROM `secure-electron-279822.tiktok_ads.ad_history`\n),\n\nfields AS (\n  SELECT\n    ad_id,\n    ad_name,\n    adgroup_id,\n    advertiser_id,\n    call_to_action,\n    campaign_id,\n    click_tracking_url,\n    impression_tracking_url,\n    landing_page_url,\n    updated_at\n  FROM base\n),\n\nfinal AS (\n  SELECT\n    ad_id,\n    CAST(updated_at AS TIMESTAMP)              AS updated_at,\n    adgroup_id                                 AS ad_group_id,\n    advertiser_id,\n    campaign_id,\n    ad_name,\n    call_to_action,\n    click_tracking_url,\n    impression_tracking_url,\n\n    -- strip off everything from '?' onward\n    SPLIT(landing_page_url, '?')[OFFSET(0)]    AS base_url,\n\n    -- host = the part after protocol up to first slash\n    REGEXP_EXTRACT(\n      landing_page_url,\n      r'^(?:https?://|android-app://)?([^/]+)'\n    )                                           AS url_host,\n\n    -- path = slash + everything after host, up to '?'\n    COALESCE(\n      REGEXP_EXTRACT(\n        landing_page_url,\n        r'^(?:https?://|android-app://)?[^/]+(/[^?]*)'\n      ),\n      '/'  -- if there was no slash/path, return just '/'\n    )                                           AS url_path,\n\n    -- UTM parameters via regex\n    NULLIF(REGEXP_EXTRACT(landing_page_url, r'[?&]utm_source=([^&]+)'), '')   AS utm_source,\n    NULLIF(REGEXP_EXTRACT(landing_page_url, r'[?&]utm_medium=([^&]+)'), '')   AS utm_medium,\n    NULLIF(REGEXP_EXTRACT(landing_page_url, r'[?&]utm_campaign=([^&]+)'), '') AS utm_campaign,\n    NULLIF(REGEXP_EXTRACT(landing_page_url, r'[?&]utm_content=([^&]+)'), '')  AS utm_content,\n    NULLIF(REGEXP_EXTRACT(landing_page_url, r'[?&]utm_term=([^&]+)'), '')     AS utm_term,\n\n    landing_page_url,\n\n    -- flag the most recent per ad_id\n    ROW_NUMBER() OVER (\n      PARTITION BY ad_id\n      ORDER BY CAST(updated_at AS TIMESTAMP) DESC\n    ) = 1                                       AS is_most_recent_record\n\n  FROM fields\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.728891Z", "completed_at": "2025-08-20T19:34:24.731443Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.731686Z", "completed_at": "2025-08-20T19:34:24.731691Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004084348678588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_tiktok_ads__ad_report_hourly", "compiled": true, "compiled_code": "-- stg_tiktok_ads__ad_report_hourly\n\nWITH base AS (\n  SELECT *\n  FROM `secure-electron-279822.tiktok_ads.ad_report_hourly`\n), \n\nfinal AS (\n  SELECT  \n    -- Identifiers & Timestamp\n    ad_id,\n    CAST(stat_time_hour AS TIMESTAMP) AS stat_time_hour,\n\n    -- Performance Metrics\n    impressions,\n    clicks,\n    ctr,\n    cpc,\n    cpm,\n    spend,\n    reach,\n\n    -- Conversion Metrics\n    conversion,\n    cost_per_conversion,\n    conversion_rate,\n\n    -- Engagement Metrics\n    likes,\n    comments,\n    shares,\n    profile_visits,\n    follows,\n\n    -- Video Metrics\n    video_play_actions,\n    video_watched_2_s,\n    video_watched_6_s,\n    video_views_p_25,\n    video_views_p_50,\n    video_views_p_75,\n    average_video_play,\n    average_video_play_per_user\n  FROM base\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_report_hourly`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.733528Z", "completed_at": "2025-08-20T19:34:24.735445Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.735707Z", "completed_at": "2025-08-20T19:34:24.735712Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0034418106079101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_tiktok_ads__advertiser", "compiled": true, "compiled_code": "-- stg_tiktok_ads__advertiser\n\nWITH base AS (\n  SELECT *\n  FROM `secure-electron-279822.tiktok_ads.advertiser`\n), \n\nfinal AS (\n  SELECT   \n    -- Identifiers\n    id                        AS advertiser_id,\n    name                      AS advertiser_name,\n\n    -- Contact Info\n    contacter,\n    email,\n    cellphone_number,\n    telephone_number,\n    address,\n\n    -- Company Info\n    company,\n    description,\n    industry,\n    country,\n    currency,\n    language,\n    timezone,\n    balance\n  FROM base\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__advertiser`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.737461Z", "completed_at": "2025-08-20T19:34:24.738941Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.739192Z", "completed_at": "2025-08-20T19:34:24.739197Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0032625198364257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_tiktok_ads__campaign_history", "compiled": true, "compiled_code": "-- stg_tiktok_ads__campaign_history\n\nWITH base AS (\n  SELECT *\n  FROM `secure-electron-279822.tiktok_ads.campaign_history`\n),\n\nfinal AS (\n  SELECT\n    campaign_id,\n    CAST(updated_at AS TIMESTAMP) AS updated_at,\n    advertiser_id,\n    campaign_name,\n    campaign_type,\n    split_test_variable,\n    ROW_NUMBER() OVER (PARTITION BY campaign_id ORDER BY updated_at DESC) = 1 AS is_most_recent_record\n  FROM base\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.741268Z", "completed_at": "2025-08-20T19:34:24.742797Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.743287Z", "completed_at": "2025-08-20T19:34:24.743292Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0032958984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.stg_tiktok_ads__campaign_report_hourly", "compiled": true, "compiled_code": "-- stg_tiktok_ads__campaign_report_hourly\n\nWITH base AS (\n  SELECT *\n  FROM `secure-electron-279822.tiktok_ads.campaign_report_hourly`\n),\n\nfinal AS (\n  SELECT  \n    campaign_id,\n    CAST(stat_time_hour AS TIMESTAMP) AS stat_time_hour,\n\n    -- Performance Metrics\n    cpc,\n    cpm,\n    ctr,\n    impressions,\n    clicks,\n    spend,\n    reach,\n    conversion,\n    cost_per_conversion,\n    conversion_rate,\n\n    -- Engagement Metrics\n    likes,\n    comments,\n    shares,\n    profile_visits,\n    follows,\n    video_play_actions,\n    video_watched_2_s,\n    video_watched_6_s,\n    video_views_p_25,\n    video_views_p_50,\n    video_views_p_75,\n    average_video_play,\n    average_video_play_per_user\n  FROM base\n)\n\nSELECT *\nFROM final", "relation_name": "`ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_report_hourly`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.745474Z", "completed_at": "2025-08-20T19:34:24.753971Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.754271Z", "completed_at": "2025-08-20T19:34:24.754278Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010389089584350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.unified_data", "compiled": true, "compiled_code": "\n\n\n\n\n\nWITH base AS (\n  \n    SELECT\n      \n  \n  \n\n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  `t`.`Video Completes` AS video_completes,\n  `t`.`Engagements` AS engagements,\n  `t`.`Video Start` AS video_start,\n  `t`.`Age` AS age,\n  `t`.`Gender` AS gender,\n  `t`.`DMA Name` AS dma_name,\n  `t`.`Audience Name` AS audience_name,\n  `t`.`Audience` AS audience,\n  `t`.`Creative URL` AS creative_url,\n  `t`.`Date` AS date,\n  `t`.`Advertiser ID` AS advertiser_id,\n  `t`.`Campaign Group ID` AS campaign_group_id,\n  `t`.`Conversions` AS conversions,\n  `t`.`Impressions` AS impressions,\n  `t`.`Device` AS device,\n  `t`.`congressional_district` AS congressional_district,\n  `t`.`s_conv_from` AS s_conv_from,\n  `t`.`Video Completion Rate` AS video_completion_rate,\n  `t`.`location_id` AS location_id,\n  `t`.`Spend` AS spend,\n  `t`.`Domain` AS domain,\n  `t`.`Engagement Rate` AS engagement_rate,\n  `t`.`NativeAd ID` AS nativead_id,\n  `t`.`Supply Source` AS supply_source,\n  `t`.`conv_from` AS conv_from,\n  `t`.`network_id` AS network_id,\n  `t`.`Clicks` AS clicks,\n  `t`.`Channels` AS channels,\n  `t`.`Audio Completion Rate` AS audio_completion_rate,\n  `t`.`City` AS city,\n  `t`.`Secondary Conversions` AS secondary_conversions,\n  `t`.`Campaign Name` AS campaign_name,\n  `t`.`Creative ID` AS creative_id,\n  `t`.`Region` AS region,\n  `t`.`Campaign Group Name` AS campaign_group_name,\n  `t`.`DMA` AS dma,\n  `t`.`Country` AS country,\n  `t`.`Audio Completes` AS audio_completes,\n  `t`.`Audience Type` AS audience_type,\n  `t`.`Advertiser Name` AS advertiser_name,\n  `t`.`Creative Name` AS creative_name,\n  `t`.`Audio Start` AS audio_start,\n  `t`.`Campaign ID` AS campaign_id\n,\n      'BlueVine' AS source_table\n    FROM secure-electron-279822.PS_Ads_Data.StackAdapt_BlueVine_table_bigquery AS t\n    \n      UNION ALL\n    \n  \n    SELECT\n      \n  \n  \n\n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  `t`.`Video Completes` AS video_completes,\n  `t`.`Engagements` AS engagements,\n  `t`.`Video Start` AS video_start,\n  `t`.`Age` AS age,\n  `t`.`Gender` AS gender,\n  `t`.`DMA Name` AS dma_name,\n  `t`.`Audience Name` AS audience_name,\n  `t`.`Audience` AS audience,\n  `t`.`Creative URL` AS creative_url,\n  `t`.`Date` AS date,\n  `t`.`Advertiser ID` AS advertiser_id,\n  `t`.`Campaign Group ID` AS campaign_group_id,\n  `t`.`Conversions` AS conversions,\n  `t`.`Impressions` AS impressions,\n  `t`.`Device` AS device,\n  `t`.`congressional_district` AS congressional_district,\n  `t`.`s_conv_from` AS s_conv_from,\n  `t`.`Video Completion Rate` AS video_completion_rate,\n  `t`.`location_id` AS location_id,\n  `t`.`Spend` AS spend,\n  `t`.`Domain` AS domain,\n  `t`.`Engagement Rate` AS engagement_rate,\n  `t`.`NativeAd ID` AS nativead_id,\n  `t`.`Supply Source` AS supply_source,\n  `t`.`conv_from` AS conv_from,\n  `t`.`network_id` AS network_id,\n  `t`.`Clicks` AS clicks,\n  `t`.`Channels` AS channels,\n  `t`.`Audio Completion Rate` AS audio_completion_rate,\n  `t`.`City` AS city,\n  `t`.`Secondary Conversions` AS secondary_conversions,\n  `t`.`Campaign Name` AS campaign_name,\n  `t`.`Creative ID` AS creative_id,\n  `t`.`Region` AS region,\n  `t`.`Campaign Group Name` AS campaign_group_name,\n  `t`.`DMA` AS dma,\n  `t`.`Country` AS country,\n  `t`.`Audio Completes` AS audio_completes,\n  `t`.`Audience Type` AS audience_type,\n  `t`.`Advertiser Name` AS advertiser_name,\n  `t`.`Creative Name` AS creative_name,\n  `t`.`Audio Start` AS audio_start,\n  `t`.`Campaign ID` AS campaign_id\n,\n      'Cengage' AS source_table\n    FROM secure-electron-279822.PS_Ads_Data.StackAdapt_Cengage_table_bigquery AS t\n    \n      UNION ALL\n    \n  \n    SELECT\n      \n  \n  \n\n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  `t`.`Video Completes` AS video_completes,\n  `t`.`Engagements` AS engagements,\n  `t`.`Video Start` AS video_start,\n  `t`.`Age` AS age,\n  `t`.`Gender` AS gender,\n  `t`.`DMA Name` AS dma_name,\n  `t`.`Audience Name` AS audience_name,\n  `t`.`Audience` AS audience,\n  `t`.`Creative URL` AS creative_url,\n  `t`.`Date` AS date,\n  `t`.`Advertiser ID` AS advertiser_id,\n  `t`.`Campaign Group ID` AS campaign_group_id,\n  `t`.`Conversions` AS conversions,\n  `t`.`Impressions` AS impressions,\n  `t`.`Device` AS device,\n  `t`.`congressional_district` AS congressional_district,\n  `t`.`s_conv_from` AS s_conv_from,\n  `t`.`Video Completion Rate` AS video_completion_rate,\n  `t`.`location_id` AS location_id,\n  `t`.`Spend` AS spend,\n  `t`.`Domain` AS domain,\n  `t`.`Engagement Rate` AS engagement_rate,\n  `t`.`NativeAd ID` AS nativead_id,\n  `t`.`Supply Source` AS supply_source,\n  `t`.`conv_from` AS conv_from,\n  `t`.`network_id` AS network_id,\n  `t`.`Clicks` AS clicks,\n  `t`.`Channels` AS channels,\n  `t`.`Audio Completion Rate` AS audio_completion_rate,\n  `t`.`City` AS city,\n  `t`.`Secondary Conversions` AS secondary_conversions,\n  `t`.`Campaign Name` AS campaign_name,\n  `t`.`Creative ID` AS creative_id,\n  `t`.`Region` AS region,\n  `t`.`Campaign Group Name` AS campaign_group_name,\n  `t`.`DMA` AS dma,\n  `t`.`Country` AS country,\n  `t`.`Audio Completes` AS audio_completes,\n  `t`.`Audience Type` AS audience_type,\n  `t`.`Advertiser Name` AS advertiser_name,\n  `t`.`Creative Name` AS creative_name,\n  `t`.`Audio Start` AS audio_start,\n  `t`.`Campaign ID` AS campaign_id\n,\n      'HoneyBook' AS source_table\n    FROM secure-electron-279822.PS_Ads_Data.StackAdapt_HoneyBook_table_bigquery AS t\n    \n      UNION ALL\n    \n  \n    SELECT\n      \n  \n  \n\n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  `t`.`Video Completes` AS video_completes,\n  `t`.`Engagements` AS engagements,\n  `t`.`Video Start` AS video_start,\n  `t`.`Age` AS age,\n  `t`.`Gender` AS gender,\n  `t`.`DMA Name` AS dma_name,\n  `t`.`Audience Name` AS audience_name,\n  `t`.`Audience` AS audience,\n  `t`.`Creative URL` AS creative_url,\n  `t`.`Date` AS date,\n  `t`.`Advertiser ID` AS advertiser_id,\n  `t`.`Campaign Group ID` AS campaign_group_id,\n  `t`.`Conversions` AS conversions,\n  `t`.`Impressions` AS impressions,\n  `t`.`Device` AS device,\n  `t`.`congressional_district` AS congressional_district,\n  `t`.`s_conv_from` AS s_conv_from,\n  `t`.`Video Completion Rate` AS video_completion_rate,\n  `t`.`location_id` AS location_id,\n  `t`.`Spend` AS spend,\n  `t`.`Domain` AS domain,\n  `t`.`Engagement Rate` AS engagement_rate,\n  `t`.`NativeAd ID` AS nativead_id,\n  `t`.`Supply Source` AS supply_source,\n  `t`.`conv_from` AS conv_from,\n  `t`.`network_id` AS network_id,\n  `t`.`Clicks` AS clicks,\n  `t`.`Channels` AS channels,\n  `t`.`Audio Completion Rate` AS audio_completion_rate,\n  `t`.`City` AS city,\n  `t`.`Secondary Conversions` AS secondary_conversions,\n  `t`.`Campaign Name` AS campaign_name,\n  `t`.`Creative ID` AS creative_id,\n  `t`.`Region` AS region,\n  `t`.`Campaign Group Name` AS campaign_group_name,\n  `t`.`DMA` AS dma,\n  `t`.`Country` AS country,\n  `t`.`Audio Completes` AS audio_completes,\n  `t`.`Audience Type` AS audience_type,\n  `t`.`Advertiser Name` AS advertiser_name,\n  `t`.`Creative Name` AS creative_name,\n  `t`.`Audio Start` AS audio_start,\n  `t`.`Campaign ID` AS campaign_id\n,\n      'ObamaFoundation' AS source_table\n    FROM secure-electron-279822.PS_Ads_Data.StackAdapt_ObamaFoundation_table_bigquery AS t\n    \n      UNION ALL\n    \n  \n    SELECT\n      \n  \n  \n\n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  `t`.`Video Completes` AS video_completes,\n  `t`.`Engagements` AS engagements,\n  `t`.`Video Start` AS video_start,\n  `t`.`Age` AS age,\n  `t`.`Gender` AS gender,\n  `t`.`DMA Name` AS dma_name,\n  `t`.`Audience Name` AS audience_name,\n  `t`.`Audience` AS audience,\n  `t`.`Creative URL` AS creative_url,\n  `t`.`Date` AS date,\n  `t`.`Advertiser ID` AS advertiser_id,\n  `t`.`Campaign Group ID` AS campaign_group_id,\n  `t`.`Conversions` AS conversions,\n  `t`.`Impressions` AS impressions,\n  `t`.`Device` AS device,\n  `t`.`congressional_district` AS congressional_district,\n  `t`.`s_conv_from` AS s_conv_from,\n  `t`.`Video Completion Rate` AS video_completion_rate,\n  `t`.`location_id` AS location_id,\n  `t`.`Spend` AS spend,\n  `t`.`Domain` AS domain,\n  `t`.`Engagement Rate` AS engagement_rate,\n  `t`.`NativeAd ID` AS nativead_id,\n  `t`.`Supply Source` AS supply_source,\n  `t`.`conv_from` AS conv_from,\n  `t`.`network_id` AS network_id,\n  `t`.`Clicks` AS clicks,\n  `t`.`Channels` AS channels,\n  `t`.`Audio Completion Rate` AS audio_completion_rate,\n  `t`.`City` AS city,\n  `t`.`Secondary Conversions` AS secondary_conversions,\n  `t`.`Campaign Name` AS campaign_name,\n  `t`.`Creative ID` AS creative_id,\n  `t`.`Region` AS region,\n  `t`.`Campaign Group Name` AS campaign_group_name,\n  `t`.`DMA` AS dma,\n  `t`.`Country` AS country,\n  `t`.`Audio Completes` AS audio_completes,\n  `t`.`Audience Type` AS audience_type,\n  `t`.`Advertiser Name` AS advertiser_name,\n  `t`.`Creative Name` AS creative_name,\n  `t`.`Audio Start` AS audio_start,\n  `t`.`Campaign ID` AS campaign_id\n,\n      'OmniaJamesWhitneyCo' AS source_table\n    FROM secure-electron-279822.PS_Ads_Data.StackAdapt_OmniaJamesWhitneyCo_table_bigquery AS t\n    \n      UNION ALL\n    \n  \n    SELECT\n      \n  \n  \n\n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n    \n  \n\n  `t`.`Video Completes` AS video_completes,\n  `t`.`Engagements` AS engagements,\n  `t`.`Video Start` AS video_start,\n  `t`.`Age` AS age,\n  `t`.`Gender` AS gender,\n  `t`.`DMA Name` AS dma_name,\n  `t`.`Audience Name` AS audience_name,\n  `t`.`Audience` AS audience,\n  `t`.`Creative URL` AS creative_url,\n  `t`.`Date` AS date,\n  `t`.`Advertiser ID` AS advertiser_id,\n  `t`.`Campaign Group ID` AS campaign_group_id,\n  `t`.`Conversions` AS conversions,\n  `t`.`Impressions` AS impressions,\n  `t`.`Device` AS device,\n  `t`.`congressional_district` AS congressional_district,\n  `t`.`s_conv_from` AS s_conv_from,\n  `t`.`Video Completion Rate` AS video_completion_rate,\n  `t`.`location_id` AS location_id,\n  `t`.`Spend` AS spend,\n  `t`.`Domain` AS domain,\n  `t`.`Engagement Rate` AS engagement_rate,\n  `t`.`NativeAd ID` AS nativead_id,\n  `t`.`Supply Source` AS supply_source,\n  `t`.`conv_from` AS conv_from,\n  `t`.`network_id` AS network_id,\n  `t`.`Clicks` AS clicks,\n  `t`.`Channels` AS channels,\n  `t`.`Audio Completion Rate` AS audio_completion_rate,\n  `t`.`City` AS city,\n  `t`.`Secondary Conversions` AS secondary_conversions,\n  `t`.`Campaign Name` AS campaign_name,\n  `t`.`Creative ID` AS creative_id,\n  `t`.`Region` AS region,\n  `t`.`Campaign Group Name` AS campaign_group_name,\n  `t`.`DMA` AS dma,\n  `t`.`Country` AS country,\n  `t`.`Audio Completes` AS audio_completes,\n  `t`.`Audience Type` AS audience_type,\n  `t`.`Advertiser Name` AS advertiser_name,\n  `t`.`Creative Name` AS creative_name,\n  `t`.`Audio Start` AS audio_start,\n  `t`.`Campaign ID` AS campaign_id\n,\n      'TheNatureConservancy' AS source_table\n    FROM secure-electron-279822.PS_Ads_Data.StackAdapt_TheNatureConservancy_table_bigquery AS t\n    \n  \n),\n\nmapping AS (\n  SELECT *\n  FROM `ps-silver-gold.mapping.mapping`\n  WHERE ad_platform = 'stackadapt'\n)\n\nSELECT \n  base.*,\n  mapping.client_name,\n  mapping.client_id,\n  mapping.ad_platform,\n  mapping.sub_client_name\nFROM base\nLEFT JOIN mapping\n  ON CAST(base.advertiser_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n", "relation_name": "`ps-silver-gold`.`silver_stackadapt_ads_dev`.`unified_data`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.756278Z", "completed_at": "2025-08-20T19:34:24.758834Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.759099Z", "completed_at": "2025-08-20T19:34:24.759104Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004182100296020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.int_facebook_ads__conversions", "compiled": true, "compiled_code": "with actions_report as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad_actions`\n),\n\naction_values_report as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad_action_values`\n),\naction_metrics as (\n    select\n        source_relation,\n        ad_id,\n        date_day,\n        sum(conversions) as conversions\n    from actions_report\n    where action_type in (\n        'onsite_conversion.purchase',\n        'onsite_conversion.lead_grouped',\n        'offsite_conversion.fb_pixel_purchase',\n        'offsite_conversion.fb_pixel_lead',\n        'offsite_conversion.fb_pixel_custom'\n    )\n    group by all\n),\n\naction_value_metrics as (\n    select\n        source_relation,\n        ad_id,\n        date_day,\n        sum(conversions_value) as conversions_value\n    from action_values_report\n    where action_type in (\n        'onsite_conversion.purchase',\n        'onsite_conversion.lead_grouped',\n        'offsite_conversion.fb_pixel_purchase',\n        'offsite_conversion.fb_pixel_lead',\n        'offsite_conversion.fb_pixel_custom'\n    )\n    group by all\n),\n\nmetrics_join as (\n    select\n        am.source_relation,\n        am.ad_id,\n        am.date_day,\n        am.conversions,\n        avm.conversions_value\n    from action_metrics am\n    left join action_value_metrics avm\n      on am.source_relation = avm.source_relation\n      and am.ad_id = avm.ad_id\n      and am.date_day = avm.date_day\n)\n\nselect * from metrics_join", "relation_name": "`ps-silver-gold`.`staging_facebook_ads_dev`.`int_facebook_ads__conversions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.760933Z", "completed_at": "2025-08-20T19:34:24.762719Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.762996Z", "completed_at": "2025-08-20T19:34:24.763001Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0033309459686279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__url_tags", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__creative_history`\n    where is_most_recent_record = true\n), \n\nrequired_fields as (\n\n    select\n        source_relation,\n        _fivetran_id,\n        creative_id,\n        url_tags\n    from base\n    where url_tags is not null\n), \n\ncleaned_json as (\n\n    select\n        source_relation,\n        _fivetran_id,\n        creative_id,\n        json_extract_array(replace(trim(url_tags, '\"'),'\\\\','')) as cleaned_url_tags\n    from required_fields\n), \n\nunnested as (\n\n    select \n        source_relation,\n        _fivetran_id, \n        creative_id, \n        url_tag_element\n    from cleaned_json,\n    unnest(cleaned_url_tags) as url_tag_element\n    where cleaned_url_tags is not null\n), \n\nfields as (\n\n    select\n        source_relation,\n        _fivetran_id,\n        creative_id,\n        json_extract_scalar(url_tag_element, '$.key') as key,\n        json_extract_scalar(url_tag_element, '$.value') as value,\n        json_extract_scalar(url_tag_element, '$.type') as type\n    from unnested\n)\n\nselect *\nfrom fields", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__url_tags`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.764750Z", "completed_at": "2025-08-20T19:34:24.768639Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.768927Z", "completed_at": "2025-08-20T19:34:24.768934Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0055887699127197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__country_report", "compiled": true, "compiled_code": "WITH accounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`\n    WHERE\n        is_most_recent_record = TRUE\n),\ndemographics_country AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_country`\n),\ndemographics_country_actions AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_country_actions`\n),\ncountry_conversions AS (\n    SELECT\n        source_relation,\n        account_id,\n        country_id,\n        date_day,\n        SUM(conversions) AS conversions\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_country_actions`\n    WHERE\n        action_type IN (\n            'onsite_conversion.purchase',\n            'onsite_conversion.lead_grouped',\n            'offsite_conversion.fb_pixel_purchase',\n            'offsite_conversion.fb_pixel_lead',\n            'offsite_conversion.fb_pixel_custom'\n        )\n    GROUP BY\n        ALL\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n    WHERE\n        ad_platform = 'meta'\n),\njoined AS (\n    SELECT\n        dc.source_relation,\n        dc.date_day,\n        dc.country_id,\n        dc.country,\n        dc.account_id,\n        mapping.account_name,\n        /* A.account_name, A.business_country_code AS account_business_country_code, A.timezone_name AS account_timezone, A.timezone_offset_hours_utc AS account_timezone_offset_hours_utc, A.currency AS account_currency, A.min_daily_budget AS account_min_daily_budget, */\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        SUM(\n            dc.impressions\n        ) AS impressions,\n        SUM(\n            dc.clicks\n        ) AS clicks,\n        SUM(\n            dc.spend\n        ) AS spend,\n        SUM(\n            dc.reach\n        ) AS reach,\n        SUM(\n            dc.frequency\n        ) AS frequency,\n        SUM(COALESCE(cc.conversions, 0)) AS conversions\n    FROM\n        demographics_country dc\n        LEFT JOIN country_conversions cc\n        ON dc.country_id = cc.country_id\n        AND dc.account_id = cc.account_id\n        AND dc.date_day = cc.date_day\n        AND dc.source_relation = cc.source_relation\n        /* left join accounts a on dc.account_id = a.account_id and dc.source_relation = a.source_relation */\n        LEFT JOIN mapping\n        ON CAST(\n            dc.account_id AS STRING\n        ) = CAST(\n            mapping.account_id AS STRING\n        )\n    GROUP BY\n        ALL\n)\nSELECT\n    *\nFROM\n    joined", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__country_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.770874Z", "completed_at": "2025-08-20T19:34:24.773101Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.773361Z", "completed_at": "2025-08-20T19:34:24.773367Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003759145736694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__region_report", "compiled": true, "compiled_code": "WITH accounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`\n    WHERE\n        is_most_recent_record = TRUE\n),\ndemographics_region AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_region`\n),\ndemographics_region_actions AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__demographics_region_actions`\n),\nregion_conversions AS (\n    SELECT\n        source_relation,\n        account_id,\n        region_id,\n        date_day,\n        SUM(conversions) AS conversions\n    FROM\n        demographics_region_actions\n    WHERE\n        action_type IN (\n            'onsite_conversion.purchase',\n            'onsite_conversion.lead_grouped',\n            'offsite_conversion.fb_pixel_purchase',\n            'offsite_conversion.fb_pixel_lead',\n            'offsite_conversion.fb_pixel_custom'\n        )\n    GROUP BY\n        ALL\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n    WHERE\n        ad_platform = 'meta'\n),\njoined AS (\n    SELECT\n        dr.date_day,\n        dr.region_id,\n        dr.region,\n        dr.account_id,\n        m.account_name,\n        /*\n                a.business_state as account_business_state,\n                a.business_country_code as account_business_country_code,\n                a.timezone_name as account_timezone,\n                a.timezone_offset_hours_utc as account_timezone_offset_hours_utc,\n                a.currency as account_currency,\n                a.min_daily_budget as account_min_daily_budget,\n        */\n        m.client_name,\n        m.client_id,\n        m.ad_platform,\n        m.sub_client_name,\n        SUM(\n            dr.impressions\n        ) AS impressions,\n        SUM(\n            dr.clicks\n        ) AS clicks,\n        SUM(\n            dr.spend\n        ) AS spend,\n        SUM(\n            dr.reach\n        ) AS reach,\n        SUM(\n            dr.frequency\n        ) AS frequency,\n        SUM(COALESCE(rc.conversions, 0)) AS conversions\n    FROM\n        demographics_region dr\n        LEFT JOIN region_conversions rc\n        ON dr.region_id = rc.region_id\n        AND dr.account_id = rc.account_id\n        AND dr.date_day = rc.date_day\n        AND dr.source_relation = rc.source_relation\n        /*left join accounts a\n                on dr.account_id = a.account_id\n                and dr.source_relation = a.source_relation*/\n        LEFT JOIN mapping m\n        ON CAST(\n            dr.account_id AS STRING\n        ) = CAST(\n            m.account_id AS STRING\n        )\n    GROUP BY\n        ALL\n)\nSELECT\n    *\nFROM\n    joined", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__region_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.775130Z", "completed_at": "2025-08-20T19:34:24.777221Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.777471Z", "completed_at": "2025-08-20T19:34:24.777476Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0038843154907226562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__ad_conversions_report", "compiled": true, "compiled_code": "WITH stats AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_conversion_stats`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nads AS (\n    SELECT\n        DISTINCT ad_group_ad_ad_id,\n        ad_group_ad_ad_type,\n        ad_group_ad_ad_final_urls,\n        ad_group_ad_ad_name,\n        ad_group_ad_ad_expanded_text_ad_description,\n        ad_group_ad_status\n    FROM\n        (\n            SELECT\n                *\n            FROM\n                `secure-electron-279822.google_ads_2025.ads_Ad_8196795413`\n            UNION ALL\n            SELECT\n                *\n            FROM\n                `secure-electron-279822.google_bluevine.ads_Ad_2828502255`\n        )\n    WHERE\n        AND _LATEST_DATE = _DATA_DATE\n    GROUP BY\n        ad_group_ad_ad_id,\n        ad_group_ad_ad_type,\n        ad_group_ad_ad_final_urls,\n        ad_group_ad_ad_name,\n        ad_group_ad_ad_expanded_text_ad_description,\n        ad_group_ad_status\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        ads.ad_group_ad_ad_id AS ad_id,\n        ads.ad_group_ad_ad_name AS ad_name,\n        ads.ad_group_ad_ad_expanded_text_ad_description AS ad_description,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ads.ad_group_ad_ad_type AS ad_type,\n        ads.ad_group_ad_status AS ad_status,\n        stats.segments_conversion_action_category AS action_category,\n        stats.segments_conversion_action_name AS action_name,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN ads\n        ON stats.ad_group_ad_ad_id = ads.ad_group_ad_ad_id\n        LEFT JOIN ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n        LEFT JOIN campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS STRING\n        ) = CAST(\n            campaigns.customer_id AS STRING\n        )\n    GROUP BY\n        stats.segments_date,\n        ads.ad_group_ad_ad_id,\n        ads.ad_group_ad_ad_expanded_text_ad_description,\n        campaigns.customer_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ads.ad_group_ad_ad_type,\n        ads.ad_group_ad_ad_name,\n        stats.segments_conversion_action_category,\n        stats.segments_conversion_action_name,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        ads.ad_group_ad_status,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__ad_conversions_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.779571Z", "completed_at": "2025-08-20T19:34:24.781756Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.781991Z", "completed_at": "2025-08-20T19:34:24.781996Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0038025379180908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__age_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_age_stats`\n),\nage AS (\n    SELECT\n        DISTINCT ad_group_criterion_criterion_id,\n        ad_group_criterion_age_range_type\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_AgeRange_8196795413`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        age.ad_group_criterion_criterion_id,\n        age.ad_group_criterion_age_range_type,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN age\n        ON age.ad_group_criterion_criterion_id = stats.ad_group_criterion_criterion_id\n        LEFT JOIN ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n        LEFT JOIN campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(campaigns.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        accounts.account_name,\n        campaigns.customer_id,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        age.ad_group_criterion_criterion_id,\n        age.ad_group_criterion_age_range_type,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__age_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.783934Z", "completed_at": "2025-08-20T19:34:24.786759Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.787091Z", "completed_at": "2025-08-20T19:34:24.787099Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004755735397338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__PMAX_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign_stats`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_PMAX`\n    WHERE\n        campaign_advertising_channel_type = 'PERFORMANCE_MAX'\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        campaigns.campaign_advertising_channel_type,\n        campaigns.campaign_status,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        JOIN campaigns\n        ON stats.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(campaigns.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        accounts.account_name,\n        campaigns.customer_id,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        campaigns.campaign_advertising_channel_type,\n        campaigns.campaign_status,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__PMAX_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.789204Z", "completed_at": "2025-08-20T19:34:24.792107Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.792380Z", "completed_at": "2025-08-20T19:34:24.792385Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004452705383300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__gender_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_gender_stats`\n),\ngender AS (\n    SELECT\n        DISTINCT ad_group_criterion_criterion_id,\n        ad_group_criterion_gender_type\n    FROM\n        `secure-electron-279822.google_ads_2025.ads_Gender_8196795413`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        gender.ad_group_criterion_criterion_id,\n        gender.ad_group_criterion_gender_type,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN gender\n        ON gender.ad_group_criterion_criterion_id = stats.ad_group_criterion_criterion_id\n        LEFT JOIN ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n        LEFT JOIN campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(campaigns.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        accounts.account_name,\n        campaigns.customer_id,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        gender.ad_group_criterion_criterion_id,\n        gender.ad_group_criterion_gender_type,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__gender_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.794128Z", "completed_at": "2025-08-20T19:34:24.797462Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.797710Z", "completed_at": "2025-08-20T19:34:24.797714Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004909992218017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__keyword_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_keyword_stats`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nkeywords AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_keyword`\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        keywords.ad_group_criterion_criterion_id AS keyword_id,\n        keywords.ad_group_criterion_keyword_text AS keyword_text,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        keywords.ad_group_criterion_keyword_match_type AS keyword_type,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN keywords\n        ON stats.ad_group_criterion_criterion_id = keywords.ad_group_criterion_criterion_id\n        LEFT JOIN ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n        LEFT JOIN campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN mapping\n        ON cast(mapping.account_id as string) = CAST(campaigns.customer_id AS STRING)\n    GROUP BY\n        stats.segments_date,\n        keywords.ad_group_criterion_criterion_id,\n        keywords.ad_group_criterion_keyword_text,\n        campaigns.customer_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        keywords.ad_group_criterion_keyword_match_type,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__keyword_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.799668Z", "completed_at": "2025-08-20T19:34:24.803273Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.803533Z", "completed_at": "2025-08-20T19:34:24.803540Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005288600921630859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__search_term_report", "compiled": true, "compiled_code": "WITH stats AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_search_term_stats`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nsearch AS ( -- This CTE (search) doesn't seem to be used. Can remove if not needed.\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_search_term`\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        stats.ad_group_ad_ad_id AS ad_id,\n        stats.search_term_view_search_term AS search_term,\n        stats.segments_search_term_match_type AS segments_search_term_match_type,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(stats.metrics_clicks) AS clicks,\n        SUM(stats.metrics_impressions) AS impressions,\n        SUM(stats.metrics_conversions) AS conversions,\n        SUM(stats.metrics_conversions_value) AS conversions_value,\n        ROUND(safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100, 2) AS daily_CVR_percent,\n        ROUND(safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100, 2) AS daily_CTR_percent,\n        ROUND(safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)), 2) AS daily_CPC_usd,\n        ROUND(safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000, 2) AS daily_CPM_usd,\n        ROUND(safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)), 2) AS daily_CPA_usd,\n        ROUND(safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100, 2) AS daily_ROAS_usd,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n    LEFT JOIN\n        ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n    LEFT JOIN\n        campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n    LEFT JOIN\n        accounts\n        ON campaigns.customer_id = accounts.customer_id\n    LEFT JOIN\n        mapping\n        ON CAST(mapping.account_id AS STRING) = CAST(campaigns.customer_id AS STRING)\n    GROUP BY\n        stats.segments_date,\n        stats.ad_group_ad_ad_id,\n        stats.search_term_view_search_term,\n        stats.segments_search_term_match_type,\n        campaigns.customer_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__search_term_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.805457Z", "completed_at": "2025-08-20T19:34:24.807976Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.808202Z", "completed_at": "2025-08-20T19:34:24.808207Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004000425338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__DMA_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_geo_stats`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ngeo AS (\n    SELECT\n        *\n    FROM\n        `secure-electron-279822.fact_lookups.google_geotarget`\n),\nvideo AS (\n    SELECT\n        campaign_id,\n        segments_date,\n        SUM(metrics_video_views) AS video_views,\n        SUM(metrics_engagements) AS engagements,\n        SUM(\n            metrics_video_views * metrics_video_quartile_p100_rate\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_video_stats`\n    GROUP BY\n        campaign_id,\n        segments_date\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        stats.campaign_id,\n        campaigns.campaign_name,\n        stats.segments_geo_target_most_specific_location AS criteria_id,\n        geo.name AS geo_name,\n        geo.canonical_name AS geo_target,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN geo\n        ON CAST(\n            regexp_extract(\n                stats.segments_geo_target_most_specific_location,\n                'geoTargetConstants\\\\/(\\\\d+)'\n            ) AS int64\n        ) = geo.criteria_id\n        LEFT JOIN campaigns\n        ON stats.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON stats.customer_id = accounts.customer_id\n        LEFT JOIN video\n        ON stats.campaign_id = video.campaign_id\n        AND stats.segments_date = video.segments_date\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(stats.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        accounts.account_name,\n        campaigns.customer_id,\n        campaigns.campaign_name,\n        stats.campaign_id,\n        stats.segments_geo_target_most_specific_location,\n        geo.name,\n        geo.canonical_name,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__DMA_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.809986Z", "completed_at": "2025-08-20T19:34:24.811978Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.812221Z", "completed_at": "2025-08-20T19:34:24.812225Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035316944122314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__account_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account_stats`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\nvideo AS (\n    SELECT\n        customer_id,\n        segments_date,\n        SUM(metrics_video_views) AS video_views,\n        SUM(metrics_engagements) AS engagements,\n        SUM(\n            metrics_video_views * metrics_video_quartile_p100_rate\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_video_stats`\n    GROUP BY\n        customer_id,\n        segments_date\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        stats.customer_id AS account_id,\n        accounts.account_name,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        ROUND(\n            safe_divide(video.video_views, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS video_view_rate_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, video.video_views),\n            2\n        ) AS daily_CPV_usd,\n        ROUND(\n            safe_divide(video.engagements, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CPE_usd,\n        ROUND(\n            safe_divide(\n                video.video_completion,\n                video.video_views\n            ) * 100,\n            2\n        ) AS daily_VCR_percent,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN accounts\n        ON stats.customer_id = accounts.customer_id\n        LEFT JOIN video\n        ON stats.customer_id = video.customer_id\n        AND stats.segments_date = video.segments_date\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(stats.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        stats.customer_id,\n        accounts.account_name,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__account_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.813994Z", "completed_at": "2025-08-20T19:34:24.817161Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.817404Z", "completed_at": "2025-08-20T19:34:24.817409Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004723548889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__ad_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_stats`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nads AS (\n    SELECT\n        DISTINCT ad_group_ad_ad_id,\n        ad_group_ad_ad_type,\n        ad_group_ad_ad_final_urls,\n        ad_group_ad_ad_name,\n        ad_group_ad_ad_expanded_text_ad_description,\n        ad_group_ad_status\n    FROM\n        (\n            SELECT\n                *\n            FROM\n                `secure-electron-279822.google_ads_2025.ads_Ad_8196795413`\n            UNION ALL\n            SELECT\n                *\n            FROM\n                `secure-electron-279822.google_bluevine.ads_Ad_2828502255`\n        )\n    WHERE\n        AND _LATEST_DATE = _DATA_DATE\n    GROUP BY\n        ad_group_ad_ad_id,\n        ad_group_ad_ad_type,\n        ad_group_ad_ad_final_urls,\n        ad_group_ad_ad_name,\n        ad_group_ad_ad_expanded_text_ad_description,\n        ad_group_ad_status\n),\nvideo AS (\n    SELECT\n        ad_group_ad_ad_id,\n        segments_date,\n        SUM(metrics_video_views) AS video_views,\n        SUM(metrics_engagements) AS engagements,\n        SUM(\n            metrics_video_views * metrics_video_quartile_p100_rate\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_video_stats`\n    GROUP BY\n        ad_group_ad_ad_id,\n        segments_date\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        ads.ad_group_ad_ad_id AS ad_id,\n        ads.ad_group_ad_ad_name AS ad_name,\n        ads.ad_group_ad_ad_expanded_text_ad_description AS ad_description,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ads.ad_group_ad_ad_type AS ad_type,\n        ads.ad_group_ad_ad_final_urls AS final_urls,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        ROUND(\n            safe_divide(video.video_views, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS video_view_rate_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, video.video_views),\n            2\n        ) AS daily_CPV_usd,\n        ROUND(\n            safe_divide(video.engagements, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CPE_usd,\n        ROUND(\n            safe_divide(\n                video.video_completion,\n                video.video_views\n            ) * 100,\n            2\n        ) AS daily_VCR_percent,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN ads\n        ON stats.ad_group_ad_ad_id = ads.ad_group_ad_ad_id\n        LEFT JOIN ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n        LEFT JOIN campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN video\n        ON stats.ad_group_ad_ad_id = video.ad_group_ad_ad_id\n        AND stats.segments_date = video.segments_date\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS STRING\n        ) = CAST(\n            campaigns.customer_id AS STRING\n        )\n    GROUP BY\n        stats.segments_date,\n        ads.ad_group_ad_ad_id,\n        ads.ad_group_ad_ad_expanded_text_ad_description,\n        campaigns.customer_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ads.ad_group_ad_ad_type,\n        ads.ad_group_ad_ad_final_urls,\n        ads.ad_group_ad_ad_name,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__ad_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.819242Z", "completed_at": "2025-08-20T19:34:24.821459Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.821694Z", "completed_at": "2025-08-20T19:34:24.821699Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0036902427673339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__campaign_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign_stats`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\nvideo AS (\n    SELECT\n        campaign_id,\n        segments_date,\n        SUM(metrics_video_views) AS video_views,\n        SUM(metrics_engagements) AS engagements,\n        SUM(\n            metrics_video_views * metrics_video_quartile_p100_rate\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_video_stats`\n    GROUP BY\n        campaign_id,\n        segments_date\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        stats.campaign_id,\n        campaigns.campaign_name,\n        campaigns.campaign_advertising_channel_type,\n        campaigns.campaign_status,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        ROUND(\n            safe_divide(video.video_views, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS video_view_rate_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, video.video_views),\n            2\n        ) AS daily_CPV_usd,\n        ROUND(\n            safe_divide(video.engagements, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CPE_usd,\n        ROUND(\n            safe_divide(\n                video.video_completion,\n                video.video_views\n            ) * 100,\n            2\n        ) AS daily_VCR_percent,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN campaigns\n        ON stats.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN video\n        ON stats.campaign_id = video.campaign_id\n        AND stats.segments_date = video.segments_date\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(campaigns.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        accounts.account_name,\n        campaigns.customer_id,\n        campaigns.campaign_name,\n        stats.campaign_id,\n        campaigns.campaign_advertising_channel_type,\n        campaigns.campaign_status,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields\nWHERE\n    campaign_status = 'ENABLED'", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__campaign_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.823440Z", "completed_at": "2025-08-20T19:34:24.826226Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.826458Z", "completed_at": "2025-08-20T19:34:24.826463Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004285097122192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__device_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group_stats`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nvideo AS (\n    SELECT\n        ad_group_id,\n        segments_date,\n        SUM(metrics_video_views) AS video_views,\n        SUM(metrics_engagements) AS engagements,\n        SUM(\n            metrics_video_views * metrics_video_quartile_p100_rate\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_video_stats`\n    GROUP BY\n        ad_group_id,\n        segments_date\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        stats.segments_device,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        ROUND(\n            safe_divide(video.video_views, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS video_view_rate_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, video.video_views),\n            2\n        ) AS daily_CPV_usd,\n        ROUND(\n            safe_divide(video.engagements, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CPE_usd,\n        ROUND(\n            safe_divide(\n                video.video_completion,\n                video.video_views\n            ) * 100,\n            2\n        ) AS daily_VCR_percent,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n        LEFT JOIN campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN video\n        ON stats.ad_group_id = video.ad_group_id\n        AND stats.segments_date = video.segments_date\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(campaigns.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        accounts.account_name,\n        campaigns.customer_id,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        stats.segments_device,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    *\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__device_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.828255Z", "completed_at": "2025-08-20T19:34:24.831057Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.831382Z", "completed_at": "2025-08-20T19:34:24.831387Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004553556442260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.linkedin_ads__account_report", "compiled": true, "compiled_code": "with account as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`\n    where is_latest_version\n\n),\n\ncampaign as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`\n    where is_latest_version\n\n),\n\nreport as (\n\n    select *,\n        external_website_conversions + one_click_leads as total_conversions\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__ad_analytics_by_campaign`\n\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'linkedin'\n),\n\nfinal as (\n\n    select \n        report.source_relation,\n        report.date_day,\n        account.account_id,\n        account.account_name,\n        account.version_tag,\n        account.currency,\n        account.status,\n        account.type,\n        account.last_modified_at,\n        account.created_at,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,        \n        sum(report.total_conversions) as total_conversions,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost,\n        sum(coalesce(report.conversion_value_in_local_currency, 0)) as conversion_value_in_local_currency,\n        sum(coalesce(report.external_website_conversions, 0)) as external_website_conversions,\n        sum(coalesce(report.one_click_leads, 0)) as one_click_leads\n\n    from report \n    left join campaign \n        on report.campaign_id = campaign.campaign_id\n        and report.source_relation = campaign.source_relation\n    left join account \n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n    LEFT JOIN mapping\n        ON CAST(account.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n    GROUP BY ALL\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__account_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.833349Z", "completed_at": "2025-08-20T19:34:24.835524Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.835802Z", "completed_at": "2025-08-20T19:34:24.835807Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037348270416259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.linkedin_ads__campaign_group_report", "compiled": true, "compiled_code": "with campaign_group as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_group_history`\n    where is_latest_version\n\n),\n\ncampaign as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`\n    where is_latest_version\n\n),\n\naccount as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`\n    where is_latest_version\n\n),\n\nreport as (\n\n    select *,\n        external_website_conversions + one_click_leads as total_conversions\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__ad_analytics_by_campaign`\n\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'linkedin'\n),\n\nfinal as (\n\n    select \n        report.source_relation,\n        report.date_day,\n        campaign_group.campaign_group_id,\n        campaign_group.campaign_group_name,\n        account.account_id,\n        account.account_name,\n        campaign_group.status,\n        account.currency,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,   \n        campaign_group.is_backfilled,\n        campaign_group.run_schedule_start_at,\n        campaign_group.run_schedule_end_at,\n        campaign_group.last_modified_at,\n        campaign_group.created_at,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost,\n        sum(coalesce(report.conversion_value_in_local_currency, 0)) as conversion_value_in_local_currency,\n        sum(coalesce(report.external_website_conversions, 0)) as external_website_conversions,\n        sum(coalesce(report.one_click_leads, 0)) as one_click_leads\n\n    from report \n    left join campaign \n        on report.campaign_id = campaign.campaign_id\n        and report.source_relation = campaign.source_relation\n    left join campaign_group\n        on campaign.campaign_group_id = campaign_group.campaign_group_id\n        and campaign.source_relation = campaign_group.source_relation\n    left join account \n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n    LEFT JOIN mapping\n        ON CAST(account.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n    group by all\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__campaign_group_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.837604Z", "completed_at": "2025-08-20T19:34:24.839854Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.840091Z", "completed_at": "2025-08-20T19:34:24.840097Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003793001174926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.linkedin_ads__campaign_report", "compiled": true, "compiled_code": "with campaign as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`\n    where is_latest_version\n\n),\n\ncampaign_group as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_group_history`\n    where is_latest_version\n\n),\n\naccount as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`\n    where is_latest_version\n\n),\n\nreport as (\n\n    select *,\n        external_website_conversions + one_click_leads as total_conversions\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__ad_analytics_by_campaign`\n\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'linkedin'\n),\n\nfinal as (\n\n    select \n        report.source_relation,\n        report.date_day,\n        report.campaign_id,\n        campaign.campaign_name,\n        campaign.version_tag,\n        campaign_group.campaign_group_id,\n        campaign_group.campaign_group_name,\n        account.account_id,\n        account.account_name,\n        campaign.status as campaign_status,\n        campaign_group.status as campaign_group_status,\n        campaign.type as campaign_type,\n        campaign.cost_type,\n        campaign.creative_selection,\n        campaign.daily_budget_amount,\n        campaign.daily_budget_currency_code,\n        campaign.unit_cost_amount,\n        campaign.unit_cost_currency_code,\n        account.currency,\n        campaign.format,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,   \n        campaign.locale_country,\n        campaign.locale_language,\n        campaign.objective_type,\n        campaign.optimization_target_type,\n        campaign.is_audience_expansion_enabled,\n        campaign.is_offsite_delivery_enabled,\n        campaign.run_schedule_start_at,\n        campaign.run_schedule_end_at,\n        campaign.last_modified_at,\n        campaign.created_at,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost,\n        sum(coalesce(report.conversion_value_in_local_currency, 0)) as conversion_value_in_local_currency,\n        sum(coalesce(report.external_website_conversions, 0)) as external_website_conversions,\n        sum(coalesce(report.one_click_leads, 0)) as one_click_leads\n\n    from report \n    left join campaign \n        on report.campaign_id = campaign.campaign_id\n        and report.source_relation = campaign.source_relation\n    left join campaign_group\n        on campaign.campaign_group_id = campaign_group.campaign_group_id\n        and campaign.source_relation = campaign_group.source_relation\n    left join account \n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n    LEFT JOIN mapping\n        ON CAST(account.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n    group by all\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__campaign_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.841986Z", "completed_at": "2025-08-20T19:34:24.844083Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.844316Z", "completed_at": "2025-08-20T19:34:24.844321Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003572702407836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.linkedin_ads__creative_report", "compiled": true, "compiled_code": "with creative as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__creative_history`\n    where is_latest_version\n\n),\n\ncampaign as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`\n    where is_latest_version\n\n),\n\ncampaign_group as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_group_history`\n    where is_latest_version\n\n),\n\naccount as (\n\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`\n    where is_latest_version\n\n),\n\nreport as (\n\n    select *,\n        external_website_conversions + one_click_leads as total_conversions\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__ad_analytics_by_creative`\n\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'linkedin'\n),\n\nfinal as (\n\n    select \n        report.source_relation,\n        report.date_day,\n        report.creative_id,\n        campaign.campaign_id,\n        campaign.campaign_name,\n        campaign_group.campaign_group_id,\n        campaign_group.campaign_group_name,\n        account.account_id,\n        account.account_name,\n        creative.click_uri,\n        creative.click_uri_type,\n        creative.status as creative_status,\n        campaign.status as campaign_status,\n        campaign_group.status as campaign_group_status,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,   \n        account.currency,\n        creative.last_modified_at,\n        creative.created_at,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost,\n        sum(coalesce(report.conversion_value_in_local_currency, 0)) as conversion_value_in_local_currency,\n        sum(coalesce(report.external_website_conversions, 0)) as external_website_conversions,\n        sum(coalesce(report.one_click_leads, 0)) as one_click_leads\n\n    from report\n    left join creative\n        on report.creative_id = creative.creative_id\n        and report.source_relation = creative.source_relation\n    left join campaign\n        on creative.campaign_id = campaign.campaign_id\n        and creative.source_relation = campaign.source_relation\n    left join campaign_group\n        on campaign.campaign_group_id = campaign_group.campaign_group_id\n        and campaign.source_relation = campaign_group.source_relation\n    left join account\n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n    LEFT JOIN mapping\n        ON CAST(account.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n    group by all\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__creative_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.846085Z", "completed_at": "2025-08-20T19:34:24.848748Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.849032Z", "completed_at": "2025-08-20T19:34:24.849037Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004297018051147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.linkedin_ads__url_report", "compiled": true, "compiled_code": "with creative as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__creative_history`\n    where is_latest_version\n),\n\ncampaign as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`\n    where is_latest_version\n),\n\ncampaign_group as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_group_history`\n    where is_latest_version\n),\n\naccount as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`\n    where is_latest_version\n),\n\nreport as (\n    select *,\n        external_website_conversions + one_click_leads as total_conversions\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__ad_analytics_by_creative`\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'linkedin'\n),\n\nfinal as (\n    select \n        report.source_relation,\n        report.date_day,\n        creative.click_uri,\n        creative.click_uri_type,\n        creative.base_url,\n        creative.url_host,\n        creative.url_path,\n        creative.utm_source,\n        creative.utm_medium,\n        creative.utm_campaign,\n        creative.utm_content,\n        creative.utm_term,\n        report.creative_id,\n        campaign.campaign_id,\n        campaign.campaign_name,\n        campaign_group.campaign_group_id,\n        campaign_group.campaign_group_name,\n        account.account_id,\n        account.account_name,\n        account.currency,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,   \n        sum(report.total_conversions) as total_conversions,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost,\n        sum(coalesce(report.conversion_value_in_local_currency, 0)) as conversion_value_in_local_currency,\n        sum(coalesce(external_website_conversions, 0)) as external_website_conversions,\n        sum(coalesce(one_click_leads, 0)) as one_click_leads\n    from report\n    left join creative \n        on report.creative_id = creative.creative_id\n        and report.source_relation = creative.source_relation\n    left join campaign \n        on creative.campaign_id = campaign.campaign_id\n        and creative.source_relation = campaign.source_relation\n    left join campaign_group\n        on campaign.campaign_group_id = campaign_group.campaign_group_id\n        and campaign.source_relation = campaign_group.source_relation\n    left join account \n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n    LEFT JOIN mapping\n        ON CAST(account.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n    where creative.click_uri is not null\n    group by all\n\n)\n\nselect * from final", "relation_name": "`ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__url_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.850950Z", "completed_at": "2025-08-20T19:34:24.853254Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.853513Z", "completed_at": "2025-08-20T19:34:24.853519Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00389862060546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.linkedin_ads__monthly_campaign_country_report", "compiled": true, "compiled_code": "with campaign as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`\n    where is_latest_version\n),\n\ncampaign_group as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_group_history`\n    where is_latest_version\n),\n\naccount as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`\n    where is_latest_version\n),\n\ngeo as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__geo`\n),\n\nreport as (\n    select *,\n        external_website_conversions + one_click_leads as total_conversions\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__monthly_ad_analytics_by_country`\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'linkedin'\n),\n\nfinal as (\n\n    select \n        report.source_relation,\n        report.date_month,\n        geo.value as country_name,\n        report.campaign_id,\n        campaign.campaign_name,\n        campaign.version_tag,\n        campaign_group.campaign_group_id,\n        campaign_group.campaign_group_name,\n        account.account_id,\n        account.account_name,\n        campaign.status as campaign_status,\n        campaign_group.status as campaign_group_status,\n        campaign.type as campaign_type,\n        campaign.cost_type,\n        campaign.creative_selection,\n        campaign.daily_budget_amount,\n        campaign.daily_budget_currency_code,\n        campaign.unit_cost_amount,\n        campaign.unit_cost_currency_code,\n        account.currency as account_currency,\n        campaign.format,\n        campaign.locale_country as campaign_locale_country,\n        campaign.locale_language as campaign_locale_language,\n        campaign.objective_type,\n        campaign.optimization_target_type,\n        campaign.is_audience_expansion_enabled,\n        campaign.is_offsite_delivery_enabled,\n        campaign.run_schedule_start_at,\n        campaign.run_schedule_end_at,\n        campaign.last_modified_at,\n        campaign.created_at,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,   \n        sum(report.total_conversions) as total_conversions,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost,\n        sum(coalesce(report.conversion_value_in_local_currency, 0)) as conversion_value_in_local_currency,\n        sum(coalesce(external_website_conversions, 0)) as external_website_conversions,\n        sum(coalesce(one_click_leads, 0)) as one_click_leads\n\n    from report \n    left join geo\n        on geo.geo_id = report.member_country_geo_id\n        and report.source_relation = geo.source_relation\n    left join campaign \n        on report.campaign_id = campaign.campaign_id\n        and report.source_relation = campaign.source_relation\n    left join campaign_group\n        on campaign.campaign_group_id = campaign_group.campaign_group_id\n        and campaign.source_relation = campaign_group.source_relation\n    left join account \n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n    LEFT JOIN mapping\n        ON CAST(account.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n    group by all\n\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__monthly_campaign_country_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.855637Z", "completed_at": "2025-08-20T19:34:24.858132Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.858482Z", "completed_at": "2025-08-20T19:34:24.858488Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004400014877319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.linkedin_ads__monthly_campaign_region_report", "compiled": true, "compiled_code": "with campaign as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_history`\n    where is_latest_version\n),\n\ncampaign_group as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__campaign_group_history`\n    where is_latest_version\n),\n\naccount as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__account_history`\n    where is_latest_version\n),\n\ngeo as (\n    select *\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__geo`\n),\n\nreport as (\n    select *,\n        external_website_conversions + one_click_leads as total_conversions\n    from `ps-silver-gold`.`staging_linkedin_ads_dev`.`stg_linkedin_ads__monthly_ad_analytics_by_region`\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'linkedin'\n),\n\nfinal as (\n    select \n        report.source_relation,\n        report.date_month,\n        geo.value as region_name,\n        report.campaign_id,\n        campaign.campaign_name,\n        campaign.version_tag,\n        campaign_group.campaign_group_id,\n        campaign_group.campaign_group_name,\n        account.account_id,\n        account.account_name,\n        campaign.status as campaign_status,\n        campaign_group.status as campaign_group_status,\n        campaign.type as campaign_type,\n        campaign.cost_type,\n        campaign.creative_selection,\n        campaign.daily_budget_amount,\n        campaign.daily_budget_currency_code,\n        campaign.unit_cost_amount,\n        campaign.unit_cost_currency_code,\n        account.currency as account_currency,\n        campaign.format,\n        campaign.locale_country as campaign_locale_country,\n        campaign.locale_language as campaign_locale_language,\n        campaign.objective_type,\n        campaign.optimization_target_type,\n        campaign.is_audience_expansion_enabled,\n        campaign.is_offsite_delivery_enabled,\n        campaign.run_schedule_start_at,\n        campaign.run_schedule_end_at,\n        campaign.last_modified_at,\n        campaign.created_at,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,   \n        sum(report.total_conversions) as total_conversions,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.cost) as cost,\n        sum(coalesce(report.conversion_value_in_local_currency, 0)) as conversion_value_in_local_currency,\n        sum(coalesce(external_website_conversions, 0)) as external_website_conversions,\n        sum(coalesce(one_click_leads, 0)) as one_click_leads\n    from report\n    left join geo\n        on geo.geo_id = report.member_region_geo_id\n        and report.source_relation = geo.source_relation\n    left join campaign \n        on report.campaign_id = campaign.campaign_id\n        and report.source_relation = campaign.source_relation\n    left join campaign_group\n        on campaign.campaign_group_id = campaign_group.campaign_group_id\n        and campaign.source_relation = campaign_group.source_relation\n    left join account \n        on campaign.account_id = account.account_id\n        and campaign.source_relation = account.source_relation\n    LEFT JOIN mapping\n        ON CAST(account.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n    group by all\n)\n\nselect * from final", "relation_name": "`ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__monthly_campaign_region_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.860496Z", "completed_at": "2025-08-20T19:34:24.862596Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.862871Z", "completed_at": "2025-08-20T19:34:24.862877Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003704547882080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__account_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_daily_report`\n), \n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        accounts.time_zone as account_timezone,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions\n        -- all_conversion_value is not available for the account_report\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__account_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.864945Z", "completed_at": "2025-08-20T19:34:24.867422Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.867701Z", "completed_at": "2025-08-20T19:34:24.867706Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004235029220581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__ad_group_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_daily_report`\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = TRUE\n),\n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = TRUE\n),\n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value, \n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__ad_group_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.869730Z", "completed_at": "2025-08-20T19:34:24.873104Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.873364Z", "completed_at": "2025-08-20T19:34:24.873370Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005095720291137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__ad_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_daily_report`\n), \n\nads as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_history`\n    where is_most_recent_record = TRUE\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = TRUE\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = TRUE\n), \n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        ads.type as ad_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__ad_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.875535Z", "completed_at": "2025-08-20T19:34:24.877497Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.877783Z", "completed_at": "2025-08-20T19:34:24.877789Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003798246383666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__campaign_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_daily_report`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = TRUE\n),\n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.type as campaign_type,\n        campaigns.time_zone as campaign_timezone,\n        campaigns.status as campaign_status,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__campaign_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.879682Z", "completed_at": "2025-08-20T19:34:24.882879Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.883149Z", "completed_at": "2025-08-20T19:34:24.883154Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0047986507415771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__url_report", "compiled": true, "compiled_code": "WITH report AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_daily_report`\n),\n\nads AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nad_groups AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    WHERE is_most_recent_record = TRUE\n),\n\ncampaigns AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    WHERE is_most_recent_record = TRUE\n),\n\naccounts AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nmapping AS (\n    SELECT *\n    FROM `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'bing'\n),\n\njoined AS (\n    SELECT\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n\n        -- Macro expands into multiple fields with aliases:\n        \n  SPLIT(ads.final_url, '?')[SAFE_OFFSET(0)] AS base_url,\n\n  CAST(\n    SPLIT(\n      REGEXP_REPLACE(\n        REGEXP_REPLACE(\n          REGEXP_REPLACE(ads.final_url, r'^(android-app://)', ''),\n          r'^(https?://)', ''\n        ), r'/.*$', ''\n      ),\n    '?')[SAFE_OFFSET(0)] AS STRING\n  ) AS url_host,\n\n  CONCAT(\n    '/',\n    CAST(\n      REGEXP_EXTRACT(\n        REGEXP_REPLACE(ads.final_url, r'^(https?://)', ''),\n        r'[^/]+(/[^?]*)'\n      ) AS STRING\n    )\n  ) AS url_path,\n\n  NULLIF(\n    SPLIT(SPLIT(ads.final_url, 'utm_source=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)],\n    ''\n  ) AS utm_source,\n\n  NULLIF(\n    SPLIT(SPLIT(ads.final_url, 'utm_medium=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)],\n    ''\n  ) AS utm_medium,\n\n  NULLIF(\n    SPLIT(SPLIT(ads.final_url, 'utm_campaign=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)],\n    ''\n  ) AS utm_campaign,\n\n  NULLIF(\n    SPLIT(SPLIT(ads.final_url, 'utm_content=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)],\n    ''\n  ) AS utm_content,\n\n  NULLIF(\n    SPLIT(SPLIT(ads.final_url, 'utm_term=')[SAFE_OFFSET(1)], '&')[SAFE_OFFSET(0)],\n    ''\n  ) AS utm_term\n,\n\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n\n        SUM(report.clicks) AS clicks,\n        SUM(report.impressions) AS impressions,\n        SUM(report.spend) AS spend,\n        SUM(report.conversions) AS conversions,\n        SUM(report.conversions_value) AS conversions_value,\n        SUM(report.all_conversions) AS all_conversions,\n        SUM(report.all_conversions_value) AS all_conversions_value\n\n    FROM report\n    LEFT JOIN ads\n        ON report.ad_id = ads.ad_id\n        AND report.source_relation = ads.source_relation\n    LEFT JOIN ad_groups\n        ON report.ad_group_id = ad_groups.ad_group_id\n        AND report.source_relation = ad_groups.source_relation\n    LEFT JOIN campaigns\n        ON report.campaign_id = campaigns.campaign_id\n        AND report.source_relation = campaigns.source_relation\n    LEFT JOIN accounts\n        ON report.account_id = accounts.account_id\n        AND report.source_relation = accounts.source_relation\n    LEFT JOIN mapping\n        ON CAST(report.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n    GROUP BY ALL\n)\n\nSELECT *\nFROM joined\nWHERE base_url IS NOT NULL", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__url_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.885084Z", "completed_at": "2025-08-20T19:34:24.887467Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.887745Z", "completed_at": "2025-08-20T19:34:24.887751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004029750823974609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__campaign_country_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__geographic_daily_report`\n),  \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = TRUE\n), \n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        report.country,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.type as campaign_type,\n        campaigns.time_zone as campaign_timezone,\n        campaigns.status as campaign_status,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        report.location_id,\n        report.goal,\n        report.language as geo_language,\n        campaigns.budget as campaign_budget,\n        campaigns.budget_id as campaign_budget_id,\n        campaigns.budget_type as campaign_budget_type,\n        campaigns.language as campaign_language,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all)\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__campaign_country_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.889710Z", "completed_at": "2025-08-20T19:34:24.891717Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.891995Z", "completed_at": "2025-08-20T19:34:24.892002Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0036668777465820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__campaign_region_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__geographic_daily_report`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = TRUE\n), \n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        report.region,\n        report.country,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.type as campaign_type,\n        campaigns.time_zone as campaign_timezone,\n        campaigns.status as campaign_status,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        report.location_id,\n        report.goal,\n        report.language as geo_language,\n        campaigns.budget as campaign_budget,\n        campaigns.budget_id as campaign_budget_id,\n        campaigns.budget_type as campaign_budget_type,\n        campaigns.language as campaign_language,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n )\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__campaign_region_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.893916Z", "completed_at": "2025-08-20T19:34:24.896345Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.896597Z", "completed_at": "2025-08-20T19:34:24.896602Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0040187835693359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__keyword_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__keyword_daily_report`\n), \n\nkeywords as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__keyword_history`\n    where is_most_recent_record = TRUE\n),\n\nads as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_history`\n    where is_most_recent_record = TRUE\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = TRUE\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = TRUE\n), \n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        keywords.keyword_name,\n        report.keyword_id,\n        keywords.match_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect * from joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__keyword_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.898513Z", "completed_at": "2025-08-20T19:34:24.900756Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.901004Z", "completed_at": "2025-08-20T19:34:24.901009Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037975311279296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads__search_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__search_daily_report`\n), \n\nkeywords as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__keyword_history`\n    where is_most_recent_record = TRUE\n),\n\nads as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_history`\n    where is_most_recent_record = TRUE\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = TRUE\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = TRUE\n), \n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_bing_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = TRUE\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'bing'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.keyword_id,\n        keywords.keyword_name,\n        coalesce(report.delivered_match_type, report.bid_match_type) as match_type,\n        report.search_query,\n        report.device_os,\n        report.device_type,\n        report.network,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__search_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.902884Z", "completed_at": "2025-08-20T19:34:24.904973Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.905242Z", "completed_at": "2025-08-20T19:34:24.905247Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0036687850952148438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__advertiser_report", "compiled": true, "compiled_code": "with report as (\n\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report`\n\n), \n\nadvertisers as (\n\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n\n), \n\nmapping as (\n\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'pinterest'\n\n), \n\nfields as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        advertisers.advertiser_name,\n        report.advertiser_id,\n        advertisers.currency_code,\n        advertisers.country,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value) as total_conversions_value\n\n    from report\n    left join advertisers\n        on cast(report.advertiser_id as STRING) = cast(advertisers.advertiser_id as STRING)\n        and report.source_relation = advertisers.source_relation\n    left join mapping\n        on cast(report.advertiser_id as STRING) = cast(mapping.account_id as STRING)\n\n    group by all\n)\n\nselect *\nfrom fields", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__advertiser_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.907279Z", "completed_at": "2025-08-20T19:34:24.909578Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.909853Z", "completed_at": "2025-08-20T19:34:24.909859Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004172325134277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__ad_group_report", "compiled": true, "compiled_code": "with report as (\n\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report`\n\n), \n\nadvertisers as (\n\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n\n),\n\nad_groups as (\n\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n\n), \n\nmapping as (\n\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'pinterest'\n\n), \n\nfields as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        advertisers.advertiser_name,\n        advertisers.advertiser_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ad_groups.created_at,\n        ad_groups.start_time,\n        ad_groups.end_time,\n        ad_groups.ad_group_status,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value) as total_conversions_value\n\n    from report\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on ad_groups.campaign_id = campaigns.campaign_id\n        and ad_groups.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    LEFT JOIN mapping\n        ON CAST(advertisers.advertiser_id AS STRING) = CAST(mapping.account_id AS STRING)\n\n\n    group by all\n)\n\nselect *\nfrom fields", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__ad_group_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.911972Z", "completed_at": "2025-08-20T19:34:24.915092Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.915620Z", "completed_at": "2025-08-20T19:34:24.915628Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006360530853271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__campaign_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report`\n),\n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'pinterest'\n),\n\nfields as (\n    select\n        report.source_relation,\n        report.date_day,\n        advertisers.advertiser_name,\n        advertisers.advertiser_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.campaign_status,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value) as total_conversions_value\n    from report\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    group by all\n),\n\nfinal as (\n    select\n        fields.*,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n    from fields\n    left join mapping\n        on cast(fields.advertiser_id as STRING) = cast(mapping.account_id as STRING)\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__campaign_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.919088Z", "completed_at": "2025-08-20T19:34:24.921938Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.922237Z", "completed_at": "2025-08-20T19:34:24.922243Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004792928695678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__keyword_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\n), \n\npins as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`\n    where is_most_recent_record = True\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'pinterest'\n), \n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        campaigns.advertiser_id,\n        advertisers.advertiser_name,\n        report.campaign_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        report.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        pins.creative_type,\n        report.pin_promotion_id,\n        pins.pin_name,\n        pins.pin_status,\n        pins.destination_url,\n        pins.base_url,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value) as total_conversions_value\n    from report \n    left join pins \n        on report.pin_promotion_id = pins.pin_promotion_id\n        and report.source_relation = pins.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns \n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    group by all\n),\n\nfinal as (\n    select\n        joined.*,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name\n    from joined\n    left join mapping\n        on cast(joined.advertiser_id as STRING) = cast(mapping.account_id as STRING)\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__keyword_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.924254Z", "completed_at": "2025-08-20T19:34:24.926864Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.927510Z", "completed_at": "2025-08-20T19:34:24.927518Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0054590702056884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__pin_promotion_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\n), \n\npins as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`\n    where is_most_recent_record = True\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'pinterest'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        campaigns.advertiser_id,\n        advertisers.advertiser_name,\n        report.campaign_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        report.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        pins.destination_url,\n        pins.creative_type,\n        report.pin_promotion_id,\n        pins.pin_name,\n        pins.pin_status,\n        pins.base_url,\n        pins.url_host,\n        pins.url_path,\n        pins.utm_source,\n        pins.utm_medium,\n        pins.utm_campaign,\n        pins.utm_content,\n        pins.utm_term,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value) as total_conversions_value\n    from report \n    left join pins \n        on report.pin_promotion_id = pins.pin_promotion_id\n        and report.source_relation = pins.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns \n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    where pins.destination_url is not null\n    group by all\n),\n\nfinal as (\n    select\n        joined.*,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name\n    from joined\n    left join mapping\n        on cast(joined.advertiser_id as string) = cast(mapping.account_id as string)\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__pin_promotion_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.930213Z", "completed_at": "2025-08-20T19:34:24.932501Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.932772Z", "completed_at": "2025-08-20T19:34:24.932778Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0038361549377441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__url_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\n), \n\npins as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`\n    where is_most_recent_record = True\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'pinterest'\n),\n\njoined as (\n    select\n        report.source_relation,\n        report.date_day,\n        campaigns.advertiser_id,\n        advertisers.advertiser_name,\n        report.campaign_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        report.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        pins.destination_url,\n        pins.creative_type,\n        report.pin_promotion_id,\n        pins.pin_name,\n        pins.pin_status,\n        pins.base_url,\n        pins.url_host,\n        pins.url_path,\n        pins.utm_source,\n        pins.utm_medium,\n        pins.utm_campaign,\n        pins.utm_content,\n        pins.utm_term,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value) as total_conversions_value\n    from report \n    left join pins \n        on report.pin_promotion_id = pins.pin_promotion_id\n        and report.source_relation = pins.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns \n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    where pins.destination_url is not null\n    group by all\n),\n\nfinal as (\n    select\n        joined.*,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name\n    from joined\n    left join mapping\n        on cast(joined.advertiser_id as string) = cast(mapping.account_id as string)\n)\n\nselect * \nfrom final", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__url_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.934576Z", "completed_at": "2025-08-20T19:34:24.936922Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.937178Z", "completed_at": "2025-08-20T19:34:24.937184Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003951311111450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads__campaign_country_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\n    where lower(targeting_type) = 'country'\n),\n\ncountries as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__targeting_geo`\n),\n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n    select *\n    from `ps-silver-gold`.`staging_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'pinterest'\n),\n\nfields as (\n    select\n        report.source_relation,\n        report.date_day,\n        countries.country_name,\n        countries.country_id,\n        report.campaign_id,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value) as total_conversions_value\n    from report\n    left join countries\n        on report.targeting_value = countries.country_id\n        and report.source_relation = countries.source_relation\n    group by all\n),\n\nfinal as (\n    select\n        fields.*,\n        advertisers.advertiser_name,\n        advertisers.advertiser_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        campaigns.daily_spend_cap,\n        campaigns.lifetime_spend_cap,\n        campaigns.created_at as campaign_created_at,\n        campaigns.default_ad_group_budget_in_micro_currency,\n        campaigns.end_time as campaign_end_time,\n        campaigns.is_campaign_budget_optimization,\n        campaigns.is_flexible_daily_budgets,\n        campaigns.objective_type as campaign_objective_type,\n        campaigns.start_time as campaign_start_time,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name\n    from fields\n    left join campaigns\n        on fields.campaign_id = campaigns.campaign_id\n        and fields.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    left join mapping\n        on cast(advertisers.advertiser_id as STRING) = cast(mapping.account_id as STRING)\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__campaign_country_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.939456Z", "completed_at": "2025-08-20T19:34:24.942026Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.942321Z", "completed_at": "2025-08-20T19:34:24.942328Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0046291351318359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.tiktok_ads__ad_group_report", "compiled": true, "compiled_code": "with hourly as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_group_report_hourly`\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_group_history`\n    where is_most_recent_record\n), \n\nadvertiser as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__advertiser`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_history`\n    where is_most_recent_record\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'tiktok'\n), \n\naggregated as (\n    select\n        cast(hourly.stat_time_hour as date) as date_day,\n        ad_groups.advertiser_id,\n        advertiser.advertiser_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        hourly.ad_group_id,\n        ad_groups.ad_group_name,\n        advertiser.currency,\n        ad_groups.action_categories,\n        ad_groups.category,\n        ad_groups.gender,\n        ad_groups.audience_type,\n        ad_groups.budget,\n        ad_groups.age_groups,\n        ad_groups.languages,\n        ad_groups.interest_category,\n        sum(hourly.impressions) as impressions,\n        sum(hourly.clicks) as clicks,\n        sum(hourly.spend) as spend,\n        sum(hourly.reach) as reach,\n        sum(hourly.conversion) as conversion,\n        sum(hourly.likes) as likes,\n        sum(hourly.comments) as comments,\n        sum(hourly.shares) as shares,\n        sum(hourly.profile_visits) as profile_visits,\n        sum(hourly.follows) as follows,\n        sum(hourly.video_watched_2_s) as video_watched_2_s,\n        sum(hourly.video_watched_6_s) as video_watched_6_s,\n        sum(hourly.video_views_p_25) as video_views_p_25,\n        sum(hourly.video_views_p_50) as video_views_p_50, \n        sum(hourly.video_views_p_75) as video_views_p_75,\n        sum(hourly.spend)/nullif(sum(hourly.clicks), 0) as daily_cpc,\n        (sum(hourly.spend)/nullif(sum(hourly.impressions), 0)) * 1000 as daily_cpm,\n        (sum(hourly.clicks)/nullif(sum(hourly.impressions), 0)) * 100 as daily_ctr\n    from hourly\n    left join ad_groups \n        on hourly.ad_group_id = ad_groups.ad_group_id\n    left join advertiser\n        on ad_groups.advertiser_id = advertiser.advertiser_id\n    left join campaigns\n        on ad_groups.campaign_id = campaigns.campaign_id\n    group by all\n),\n\nfinal as (\n    select\n        aggregated.*,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name\n    from aggregated\n    left join mapping\n        on cast(aggregated.advertiser_id as string) = cast(mapping.account_id as string)\n)\n\nselect *\nfrom final", "relation_name": "`ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__ad_group_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.944418Z", "completed_at": "2025-08-20T19:34:24.946897Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.947159Z", "completed_at": "2025-08-20T19:34:24.947164Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004092693328857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.tiktok_ads__ad_report", "compiled": true, "compiled_code": "with hourly as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_report_hourly`\n), \n\nads as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_history`\n    where is_most_recent_record = true\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_group_history`\n    where is_most_recent_record = true\n), \n\nadvertiser as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__advertiser`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_history`\n    where is_most_recent_record = true\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'tiktok'\n), \n\naggregated as (\n    select\n        cast(hourly.stat_time_hour as date) as date_day,\n        ad_groups.advertiser_id,\n        advertiser.advertiser_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        hourly.ad_id,\n        ads.ad_name,\n        advertiser.currency,\n        ad_groups.category,\n        ad_groups.action_categories,\n        ad_groups.gender,\n        ad_groups.audience_type,\n        ad_groups.budget,\n        ad_groups.age_groups,\n        ad_groups.languages,\n        ad_groups.interest_category,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,    \n        mapping.sub_client_name,\n        sum(hourly.impressions) as impressions,\n        sum(hourly.clicks) as clicks,\n        sum(hourly.spend) as spend,\n        sum(hourly.reach) as reach,\n        sum(hourly.conversion) as conversion,\n        sum(hourly.likes) as likes,\n        sum(hourly.comments) as comments,\n        sum(hourly.shares) as shares,\n        sum(hourly.profile_visits) as profile_visits,\n        sum(hourly.follows) as follows,\n        sum(hourly.video_watched_2_s) as video_watched_2_s,\n        sum(hourly.video_watched_6_s) as video_watched_6_s,\n        sum(hourly.video_views_p_25) as video_views_p_25,\n        sum(hourly.video_views_p_50) as video_views_p_50, \n        sum(hourly.video_views_p_75) as video_views_p_75,\n        sum(hourly.spend) / nullif(sum(hourly.clicks), 0) as daily_cpc,\n        (sum(hourly.spend) / nullif(sum(hourly.impressions), 0)) * 1000 as daily_cpm,\n        (sum(hourly.clicks) / nullif(sum(hourly.impressions), 0)) * 100 as daily_ctr\n    from hourly\n    left join ads\n        on hourly.ad_id = ads.ad_id\n    left join ad_groups \n        on ads.ad_group_id = ad_groups.ad_group_id\n    left join advertiser\n        on ads.advertiser_id = advertiser.advertiser_id\n    left join campaigns\n        on ads.campaign_id = campaigns.campaign_id\n    left join mapping\n        on cast(advertiser.advertiser_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom aggregated", "relation_name": "`ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__ad_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.949085Z", "completed_at": "2025-08-20T19:34:24.951238Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.951487Z", "completed_at": "2025-08-20T19:34:24.951492Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037093162536621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.tiktok_ads__advertiser_report", "compiled": true, "compiled_code": "with hourly as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_report_hourly`\n), \n\nads as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_history`\n    where is_most_recent_record = true\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_group_history`\n    where is_most_recent_record = true\n), \n\nadvertiser as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__advertiser`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_history`\n    where is_most_recent_record = true\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'tiktok'\n), \n\naggregated as (\n    select\n        cast(hourly.stat_time_hour as date) as date_day,\n        ad_groups.advertiser_id,\n        advertiser.advertiser_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        hourly.ad_id,\n        ads.ad_name,\n        advertiser.currency,\n        ad_groups.category,\n        ad_groups.action_categories,\n        ad_groups.gender,\n        ad_groups.audience_type,\n        ad_groups.budget,\n        ad_groups.age_groups,\n        ad_groups.languages,\n        ad_groups.interest_category,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(hourly.impressions) as impressions,\n        sum(hourly.clicks) as clicks,\n        sum(hourly.spend) as spend,\n        sum(hourly.reach) as reach,\n        sum(hourly.conversion) as conversion,\n        sum(hourly.likes) as likes,\n        sum(hourly.comments) as comments,\n        sum(hourly.shares) as shares,\n        sum(hourly.profile_visits) as profile_visits,\n        sum(hourly.follows) as follows,\n        sum(hourly.video_watched_2_s) as video_watched_2_s,\n        sum(hourly.video_watched_6_s) as video_watched_6_s,\n        sum(hourly.video_views_p_25) as video_views_p_25,\n        sum(hourly.video_views_p_50) as video_views_p_50, \n        sum(hourly.video_views_p_75) as video_views_p_75,\n        sum(hourly.spend) / nullif(sum(hourly.clicks), 0) as daily_cpc,\n        (sum(hourly.spend) / nullif(sum(hourly.impressions), 0)) * 1000 as daily_cpm,\n        (sum(hourly.clicks) / nullif(sum(hourly.impressions), 0)) * 100 as daily_ctr\n    from hourly\n    left join ads\n        on hourly.ad_id = ads.ad_id\n    left join ad_groups \n        on ads.ad_group_id = ad_groups.ad_group_id\n    left join advertiser\n        on ads.advertiser_id = advertiser.advertiser_id\n    left join campaigns\n        on ads.campaign_id = campaigns.campaign_id\n    left join mapping\n        on cast(advertiser.advertiser_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom aggregated", "relation_name": "`ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__advertiser_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.953472Z", "completed_at": "2025-08-20T19:34:24.955916Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.956193Z", "completed_at": "2025-08-20T19:34:24.956199Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004157304763793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.tiktok_ads__url_report", "compiled": true, "compiled_code": "with hourly as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_report_hourly`\n), \n\nads as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_history`\n    where is_most_recent_record\n), \n\nad_groups as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__ad_group_history`\n    where is_most_recent_record\n), \n\nadvertiser as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__advertiser`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_history`\n    where is_most_recent_record\n), \n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'tiktok'\n), \n\naggregated as (\n    select\n        cast(hourly.stat_time_hour as date) as date_day,\n        ad_groups.advertiser_id,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.ad_platform,   \n        mapping.sub_client_name,    \n        advertiser.advertiser_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        hourly.ad_id,\n        ads.ad_name,\n        ads.base_url,\n        ads.url_host,\n        ads.url_path,\n        ads.utm_source,\n        ads.utm_medium,\n        ads.utm_campaign,\n        ads.utm_content,\n        ads.utm_term,\n        advertiser.currency,\n        ad_groups.action_categories,\n        ad_groups.category,\n        ad_groups.gender,\n        ad_groups.audience_type,\n        ad_groups.budget,\n        ad_groups.age_groups,\n        ad_groups.languages,\n        ad_groups.interest_category,\n        sum(hourly.impressions) as impressions,\n        sum(hourly.clicks) as clicks,\n        sum(hourly.spend) as spend,\n        sum(hourly.reach) as reach,\n        sum(hourly.conversion) as conversion,\n        sum(hourly.likes) as likes,\n        sum(hourly.comments) as comments,\n        sum(hourly.shares) as shares,\n        sum(hourly.profile_visits) as profile_visits,\n        sum(hourly.follows) as follows,\n        sum(hourly.video_watched_2_s) as video_watched_2_s,\n        sum(hourly.video_watched_6_s) as video_watched_6_s,\n        sum(hourly.video_views_p_25) as video_views_p_25,\n        sum(hourly.video_views_p_50) as video_views_p_50, \n        sum(hourly.video_views_p_75) as video_views_p_75,\n        sum(hourly.spend) / nullif(sum(hourly.clicks), 0) as daily_cpc,\n        (sum(hourly.spend) / nullif(sum(hourly.impressions), 0)) * 1000 as daily_cpm,\n        (sum(hourly.clicks) / nullif(sum(hourly.impressions), 0)) * 100 as daily_ctr\n    from hourly\n    left join ads\n        on hourly.ad_id = ads.ad_id\n    left join ad_groups \n        on ads.ad_group_id = ad_groups.ad_group_id\n    left join advertiser\n        on ads.advertiser_id = advertiser.advertiser_id\n    left join campaigns\n        on ads.campaign_id = campaigns.campaign_id\n    left join mapping\n        on cast(advertiser.advertiser_id as string) = cast(mapping.account_id as string)\n    where ads.landing_page_url is not null\n    group by all\n)\n\nselect *\nfrom aggregated", "relation_name": "`ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__url_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.958184Z", "completed_at": "2025-08-20T19:34:24.960612Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.960897Z", "completed_at": "2025-08-20T19:34:24.960902Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00412750244140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.tiktok_ads__campaign_report", "compiled": true, "compiled_code": "with hourly as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_report_hourly`\n), \n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__campaign_history`\n    where is_most_recent_record = true\n), \n\nadvertiser as (\n    select *\n    from `ps-silver-gold`.`staging_tiktok_ads_dev`.`stg_tiktok_ads__advertiser`\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    where ad_platform = 'tiktok'\n), \n\naggregated as (\n    select\n        cast(hourly.stat_time_hour as date) as date_day,\n        advertiser.advertiser_id,\n        advertiser.advertiser_name,\n        hourly.campaign_id,\n        campaigns.campaign_name,\n        advertiser.currency,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(hourly.impressions) as impressions,\n        sum(hourly.clicks) as clicks,\n        sum(hourly.spend) as spend,\n        sum(hourly.reach) as reach,\n        sum(hourly.conversion) as conversion,\n        sum(hourly.likes) as likes,\n        sum(hourly.comments) as comments,\n        sum(hourly.shares) as shares,\n        sum(hourly.profile_visits) as profile_visits,\n        sum(hourly.follows) as follows,\n        sum(hourly.video_watched_2_s) as video_watched_2_s,\n        sum(hourly.video_watched_6_s) as video_watched_6_s,\n        sum(hourly.video_views_p_25) as video_views_p_25,\n        sum(hourly.video_views_p_50) as video_views_p_50, \n        sum(hourly.video_views_p_75) as video_views_p_75,\n        sum(hourly.spend) / nullif(sum(hourly.clicks), 0) as daily_cpc,\n        (sum(hourly.spend) / nullif(sum(hourly.impressions), 0)) * 1000 as daily_cpm,\n        (sum(hourly.clicks) / nullif(sum(hourly.impressions), 0)) * 100 as daily_ctr\n    from hourly\n    left join campaigns\n        on hourly.campaign_id = campaigns.campaign_id\n    left join advertiser\n        on campaigns.advertiser_id = advertiser.advertiser_id\n    left join mapping\n        on cast(advertiser.advertiser_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom aggregated", "relation_name": "`ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__campaign_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.962916Z", "completed_at": "2025-08-20T19:34:24.964838Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.965089Z", "completed_at": "2025-08-20T19:34:24.965095Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035505294799804688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__account_report", "compiled": true, "compiled_code": "WITH report AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad`\n), \n\nconversion_report AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`int_facebook_ads__conversions`\n), \n\naccounts AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nmapping AS (\n    SELECT *\n    FROM `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'meta'\n),\n\njoined AS (\n    SELECT \n        report.date_day,\n        report.account_id,\n        mapping.account_name,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        SUM(report.clicks) AS clicks,\n        SUM(report.impressions) AS impressions,\n        SUM(report.spend) AS spend,\n        SUM(COALESCE(conversion_report.conversions, 0)) AS conversions,\n        SUM(COALESCE(conversion_report.conversions_value, 0)) AS conversions_value\n\n    FROM report \n    LEFT JOIN conversion_report\n        ON report.date_day = conversion_report.date_day\n        AND report.ad_id = conversion_report.ad_id\n        AND report.source_relation = conversion_report.source_relation\n    LEFT JOIN mapping\n        ON CAST(report.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n    GROUP BY ALL\n)\n\nSELECT *\nFROM joined", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__account_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.967016Z", "completed_at": "2025-08-20T19:34:24.969649Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.969908Z", "completed_at": "2025-08-20T19:34:24.969913Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00422358512878418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__ad_report", "compiled": true, "compiled_code": "WITH report AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad`\n), \n\nconversion_report AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`int_facebook_ads__conversions`\n), \n\naccounts AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`\n    WHERE is_most_recent_record = TRUE\n),\n\ncampaigns AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__campaign_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nad_sets AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_set_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nads AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nmapping AS (\n    SELECT *\n    FROM `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'meta'\n),\n\njoined AS (\n    SELECT \n        report.date_day,\n        report.account_id,\n        mapping.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_sets.ad_set_id,\n        ad_sets.ad_set_name,\n        ads.ad_id,\n        ads.ad_name,\n        ads.conversion_domain,\n\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n\n        SUM(report.clicks) AS clicks,\n        SUM(report.impressions) AS impressions,\n        SUM(report.spend) AS spend,\n        SUM(COALESCE(conversion_report.conversions, 0)) AS conversions,\n        SUM(COALESCE(conversion_report.conversions_value, 0)) AS conversions_value\n\n    FROM report \n    LEFT JOIN conversion_report\n        ON report.date_day = conversion_report.date_day\n        AND report.ad_id = conversion_report.ad_id\n        AND report.source_relation = conversion_report.source_relation\n    LEFT JOIN ads \n        ON report.ad_id = ads.ad_id\n        AND report.source_relation = ads.source_relation\n    LEFT JOIN campaigns\n        ON ads.campaign_id = campaigns.campaign_id\n        AND ads.source_relation = campaigns.source_relation\n    LEFT JOIN ad_sets\n        ON ads.ad_set_id = ad_sets.ad_set_id\n        AND ads.source_relation = ad_sets.source_relation\n    LEFT JOIN mapping\n        ON CAST(report.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n    GROUP BY ALL\n)\n\nSELECT *\nFROM joined", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__ad_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.971825Z", "completed_at": "2025-08-20T19:34:24.974079Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.974335Z", "completed_at": "2025-08-20T19:34:24.974340Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0038323402404785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__ad_set_report", "compiled": true, "compiled_code": "WITH report AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad`\n), \n\nconversion_report AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`int_facebook_ads__conversions`\n), \n\naccounts AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`\n    WHERE is_most_recent_record = TRUE\n),\n\ncampaigns AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__campaign_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nad_sets AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_set_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nads AS (\n    SELECT *\n    FROM `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_history`\n    WHERE is_most_recent_record = TRUE\n),\n\nmapping AS (\n    SELECT *\n    FROM `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'meta'\n),\n\njoined AS (\n    SELECT \n        report.date_day,\n        report.account_id,\n        mapping.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_sets.ad_set_id,\n        ad_sets.ad_set_name,\n        ads.ad_id,\n        ads.ad_name,\n        ads.conversion_domain,\n\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n\n        SUM(report.clicks) AS clicks,\n        SUM(report.impressions) AS impressions,\n        SUM(report.spend) AS spend,\n        SUM(COALESCE(conversion_report.conversions, 0)) AS conversions,\n        SUM(COALESCE(conversion_report.conversions_value, 0)) AS conversions_value\n\n    FROM report \n    LEFT JOIN conversion_report\n        ON report.date_day = conversion_report.date_day\n        AND report.ad_id = conversion_report.ad_id\n        AND report.source_relation = conversion_report.source_relation\n    LEFT JOIN ads \n        ON report.ad_id = ads.ad_id\n        AND report.source_relation = ads.source_relation\n    LEFT JOIN campaigns\n        ON ads.campaign_id = campaigns.campaign_id\n        AND ads.source_relation = campaigns.source_relation\n    LEFT JOIN ad_sets\n        ON ads.ad_set_id = ad_sets.ad_set_id\n        AND ads.source_relation = ad_sets.source_relation\n    LEFT JOIN mapping\n        ON CAST(report.account_id AS STRING) = CAST(mapping.account_id AS STRING)\n    GROUP BY ALL\n)\n\nSELECT *\nFROM joined", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__ad_set_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.976242Z", "completed_at": "2025-08-20T19:34:24.978411Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.978676Z", "completed_at": "2025-08-20T19:34:24.978682Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0038170814514160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__campaign_report", "compiled": true, "compiled_code": "with report as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad`\n), \n\nconversion_report as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`int_facebook_ads__conversions`\n), \n\naccounts as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`\n    where is_most_recent_record = true\n),\n\ncampaigns as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__campaign_history`\n    where is_most_recent_record = true\n),\n\nads as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_history`\n    where is_most_recent_record = true\n),\n\nmapping as (\n    select *\n    from `ps-silver-gold.mapping.mapping`\n    WHERE ad_platform = 'meta'\n),\n\njoined as (\n    select \n        report.date_day,\n        report.account_id,\n        mapping.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        campaigns.start_at,\n        campaigns.end_at,\n        campaigns.status,\n        campaigns.daily_budget,\n        campaigns.lifetime_budget,\n        campaigns.budget_remaining,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(coalesce(conversion_report.conversions, 0)) as conversions,\n        sum(coalesce(conversion_report.conversions_value, 0)) as conversions_value\n    from report\n    left join conversion_report\n        on report.date_day = conversion_report.date_day\n        and report.ad_id = conversion_report.ad_id\n        and report.source_relation = conversion_report.source_relation\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join campaigns\n        on ads.campaign_id = campaigns.campaign_id\n        and ads.source_relation = campaigns.source_relation\n    left join mapping\n        on cast(report.account_id as string) = cast(mapping.account_id as string)\n    group by all\n)\n\nselect *\nfrom joined", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__campaign_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.980716Z", "completed_at": "2025-08-20T19:34:24.985482Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.985728Z", "completed_at": "2025-08-20T19:34:24.985734Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006559610366821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.int_facebook_ads__creative_history", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__creative_history`\n    where is_most_recent_record = true\n),\n\nurl_tags as (\n    select *\n    from `ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__url_tags`\n),\n\nurl_tags_pivoted as (\n    select \n        source_relation,\n        _fivetran_id,\n        creative_id,\n        min(case when key = 'utm_source' then value end) as utm_source,\n        min(case when key = 'utm_medium' then value end) as utm_medium,\n        min(case when key = 'utm_campaign' then value end) as utm_campaign,\n        min(case when key = 'utm_content' then value end) as utm_content,\n        min(case when key = 'utm_term' then value end) as utm_term\n    from url_tags\n    group by 1,2,3\n),\n\nfields as (\n    select\n        base.source_relation,\n        base._fivetran_id,\n        base.creative_id,\n        base.account_id,\n        base.creative_name,\n        coalesce(page_link, template_page_link) as url,\n        split(coalesce(page_link, template_page_link), '?')[safe_offset(0)] as base_url,\n        \n        -- Using macros for cleaner code\n        \n    safe_cast(\n        split(\n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n, '/')[safe_offset(0)] as string\n    )\n as url_host,\n        \n    '/' || safe_cast(\n        split(\n            case \n                when length(\n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n) - coalesce(\n                    nullif(strpos(\n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n, '/'), 0),\n                    strpos(\n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n, '?') - 1\n                ) = 0 then ''\n                else substr(\n                    \n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n,\n                    -1 * (\n                        length(\n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n) - coalesce(\n                            nullif(strpos(\n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n, '/'), 0),\n                            strpos(\n    replace(\n        replace(\n            replace(coalesce(page_link, template_page_link), 'android-app://', ''),\n            'http://', ''),\n        'https://', '')\n, '?') - 1\n                        )\n                    )\n                )\n            end,\n            '?'\n        )[safe_offset(0)] as string\n    )\n as url_path,\n        \n        -- UTM parameters with fallback to URL parsing\n        coalesce(\n            url_tags_pivoted.utm_source,\n            \n    nullif(\n        split(split(coalesce(page_link, template_page_link), 'utm_source=')[safe_offset(1)], '&')[safe_offset(0)],\n        ''\n    )\n\n        ) as utm_source,\n        \n        coalesce(\n            url_tags_pivoted.utm_medium,\n            \n    nullif(\n        split(split(coalesce(page_link, template_page_link), 'utm_medium=')[safe_offset(1)], '&')[safe_offset(0)],\n        ''\n    )\n\n        ) as utm_medium,\n        \n        coalesce(\n            url_tags_pivoted.utm_campaign,\n            \n    nullif(\n        split(split(coalesce(page_link, template_page_link), 'utm_campaign=')[safe_offset(1)], '&')[safe_offset(0)],\n        ''\n    )\n\n        ) as utm_campaign,\n        \n        coalesce(\n            url_tags_pivoted.utm_content,\n            \n    nullif(\n        split(split(coalesce(page_link, template_page_link), 'utm_content=')[safe_offset(1)], '&')[safe_offset(0)],\n        ''\n    )\n\n        ) as utm_content,\n        \n        coalesce(\n            url_tags_pivoted.utm_term,\n            \n    nullif(\n        split(split(coalesce(page_link, template_page_link), 'utm_term=')[safe_offset(1)], '&')[safe_offset(0)],\n        ''\n    )\n\n        ) as utm_term\n\n    from base\n    left join url_tags_pivoted\n        on base._fivetran_id = url_tags_pivoted._fivetran_id\n        and base.source_relation = url_tags_pivoted.source_relation\n        and base.creative_id = url_tags_pivoted.creative_id\n)\n\nselect * from fields", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`int_facebook_ads__creative_history`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.987658Z", "completed_at": "2025-08-20T19:34:24.990163Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.990470Z", "completed_at": "2025-08-20T19:34:24.990475Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004193782806396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.google_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nWITH stats AS (\n\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group_stats`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_account`\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_campaign`\n),\nad_groups AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_ad_group`\n),\nvideo AS (\n    SELECT\n        ad_group_id,\n        segments_date,\n        SUM(metrics_video_views) AS video_views,\n        SUM(metrics_engagements) AS engagements,\n        SUM(\n            metrics_video_views * metrics_video_quartile_p100_rate\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`staging_google_ads_dev`.`stg_google_ads_video_stats`\n    GROUP BY\n        ad_group_id,\n        segments_date\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n),\nfields AS (\n    SELECT\n        stats.segments_date AS date_day,\n        campaigns.customer_id AS account_id,\n        accounts.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        ROUND(SUM(stats.metrics_cost_micros) / 1e6, 2) AS spend_usd,\n        SUM(\n            stats.metrics_clicks\n        ) AS clicks,\n        SUM(\n            stats.metrics_impressions\n        ) AS impressions,\n        SUM(\n            stats.metrics_conversions\n        ) AS conversions,\n        SUM(\n            stats.metrics_conversions_value\n        ) AS conversions_value,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions), SUM(stats.metrics_clicks)) * 100,\n            2\n        ) AS daily_CVR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_clicks), SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CTR_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_clicks)),\n            2\n        ) AS daily_CPC_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_impressions)) * 1000,\n            2\n        ) AS daily_CPM_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, SUM(stats.metrics_conversions)),\n            2\n        ) AS daily_CPA_usd,\n        ROUND(\n            safe_divide(SUM(stats.metrics_conversions_value), SUM(stats.metrics_cost_micros) / 1e6) * 100,\n            2\n        ) AS daily_ROAS_usd,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        ROUND(\n            safe_divide(video.video_views, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS video_view_rate_percent,\n        ROUND(\n            safe_divide(SUM(stats.metrics_cost_micros) / 1e6, video.video_views),\n            2\n        ) AS daily_CPV_usd,\n        ROUND(\n            safe_divide(video.engagements, SUM(stats.metrics_impressions)) * 100,\n            2\n        ) AS daily_CPE_usd,\n        ROUND(\n            safe_divide(\n                video.video_completion,\n                video.video_views\n            ) * 100,\n            2\n        ) AS daily_VCR_percent,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n    FROM\n        stats\n        LEFT JOIN ad_groups\n        ON stats.ad_group_id = ad_groups.ad_group_id\n        LEFT JOIN campaigns\n        ON ad_groups.campaign_id = campaigns.campaign_id\n        LEFT JOIN accounts\n        ON campaigns.customer_id = accounts.customer_id\n        LEFT JOIN video\n        ON stats.ad_group_id = video.ad_group_id\n        AND stats.segments_date = video.segments_date\n        LEFT JOIN mapping\n        ON CAST(\n            mapping.account_id AS string\n        ) = cast(campaigns.customer_id as string)\n    GROUP BY\n        stats.segments_date,\n        accounts.account_name,\n        campaigns.customer_id,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_id,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        video.video_views,\n        video.engagements,\n        video.video_completion,\n        mapping.client_id,\n        mapping.client_name,\n        mapping.sub_client_name,\n        mapping.ad_platform\n)\nSELECT\n    date_day,\n    account_id,\n    account_name,\n    campaign_id,\n    campaign_name,\n    NULL AS ad_group_id,\n    NULL AS ad_group_name,\n    NULL AS ad_group_status,\n    NULL AS ad_group_type,\n    spend_usd,\n    clicks,\n    impressions,\n    conversions,\n    conversions_value,\n    daily_CVR_percent,\n    daily_CTR_percent,\n    daily_CPC_usd,\n    daily_CPM_usd,\n    daily_CPA_usd,\n    daily_ROAS_usd,\n    NULL AS video_views,\n    NULL AS engagements,\n    NULL AS video_completion,\n    NULL AS video_view_rate_percent,\n    NULL AS daily_CPV_usd,\n    NULL AS daily_CPE_usd,\n    NULL AS daily_VCR_percent,\n    client_id,\n    client_name,\n    sub_client_name,\n    ad_platform\nFROM\n    `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__PMAX_report`\nUNION ALL\nSELECT\n    date_day,\n    account_id,\n    account_name,\n    campaign_id,\n    campaign_name,\n    ad_group_id,\n    ad_group_name,\n    ad_group_status,\n    ad_group_type,\n    spend_usd,\n    clicks,\n    impressions,\n    conversions,\n    conversions_value,\n    daily_CVR_percent,\n    daily_CTR_percent,\n    daily_CPC_usd,\n    daily_CPM_usd,\n    daily_CPA_usd,\n    daily_ROAS_usd,\n    video_views,\n    engagements,\n    video_completion,\n    video_view_rate_percent,\n    daily_CPV_usd,\n    daily_CPE_usd,\n    daily_VCR_percent,\n    client_id,\n    client_name,\n    sub_client_name,\n    ad_platform\nFROM\n    fields", "relation_name": "`ps-silver-gold`.`silver_google_ads_dev`.`google_ads__ad_group_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.992428Z", "completed_at": "2025-08-20T19:34:24.995191Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.995458Z", "completed_at": "2025-08-20T19:34:24.995463Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004483699798583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.microsoft_ads_accounts", "compiled": true, "compiled_code": "select distinct account_name, account_id from `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__account_report`", "relation_name": "`ps-silver-gold`.`fact_lookup_dev`.`microsoft_ads_accounts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.997342Z", "completed_at": "2025-08-20T19:34:24.999031Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:24.999300Z", "completed_at": "2025-08-20T19:34:24.999306Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003279447555541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.device_unified_stats", "compiled": true, "compiled_code": "WITH google_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        ad_group_id,\n        ad_group_name,\n        segments_device as device_type,\n        clicks,\n        impressions,\n        spend_usd AS spend,\n        conversions,\n        conversions_value,\n        video_views,\n        engagements,\n        video_completion\n    FROM\n        `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__device_report`\n),\nbing_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        ad_group_id,\n        ad_group_name,\n        device_type,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__ad_group_report`\n)\nSELECT\n    *\nFROM\n    google_stats\nUNION ALL\nSELECT\n    *\nFROM\n    bing_stats", "relation_name": "`ps-silver-gold`.`device_performance_dev`.`device_unified_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.001249Z", "completed_at": "2025-08-20T19:34:25.002743Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.003015Z", "completed_at": "2025-08-20T19:34:25.003020Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0030612945556640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.pinterest_ads_accounts", "compiled": true, "compiled_code": "select distinct advertiser_name, advertiser_id from `ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__advertiser_report`", "relation_name": "`ps-silver-gold`.`fact_lookup_dev`.`pinterest_ads_accounts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.004809Z", "completed_at": "2025-08-20T19:34:25.007167Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.007481Z", "completed_at": "2025-08-20T19:34:25.007487Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00403285026550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.geo_unified_stats", "compiled": true, "compiled_code": "WITH google_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        TRIM(SPLIT(geo_target, ',') [SAFE_OFFSET(2)]) AS country,\n        TRIM(SPLIT(geo_target, ',') [SAFE_OFFSET(1)]) AS region,\n        CAST(\n            NULL AS STRING\n        ) AS dma,\n        TRIM(SPLIT(geo_target, ',') [SAFE_OFFSET(0)]) AS city_area,\n        clicks,\n        impressions,\n        spend_usd AS spend,\n        conversions,\n        conversions_value,\n        video_views,\n        engagements,\n        video_completion\n    FROM\n        `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__DMA_report`\n),\nfacebook_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            NULL AS STRING\n        ) AS campaign_id,\n        CAST(\n            NULL AS STRING\n        ) AS campaign_name,\n        CAST(\n            NULL AS STRING\n        ) AS country,\n        region,\n        CAST(\n            NULL AS STRING\n        ) AS dma,\n        CAST(\n            NULL AS STRING\n        ) AS city,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        NULL AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__region_report`\n),\npinterest_stats AS (\n    SELECT\n        DATE(date_day) AS date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        CAST(\n            NULL AS STRING\n        ) AS campaign_name,\n        country_name AS country,\n        CAST(\n            NULL AS STRING\n        ) AS region,\n        CAST(\n            NULL AS STRING\n        ) AS dma,\n        CAST(\n            NULL AS STRING\n        ) AS city,\n        clicks,\n        impressions,\n        spend,\n        total_conversions AS conversions,\n        total_conversions_value AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__campaign_country_report`\n),\nbing_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        country AS country,\n        CAST(\n            NULL AS STRING\n        ) AS region,\n        CAST(\n            NULL AS STRING\n        ) AS dma,\n        CAST(\n            NULL AS STRING\n        ) AS city,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__campaign_region_report`\n)\nSELECT\n    *\nFROM\n    google_stats\nUNION ALL\nSELECT\n    *\nFROM\n    facebook_stats\nUNION ALL\nSELECT\n    *\nFROM\n    pinterest_stats\nUNION ALL\nSELECT\n    *\nFROM\n    bing_stats", "relation_name": "`ps-silver-gold`.`geo_performance_dev`.`geo_unified_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.009587Z", "completed_at": "2025-08-20T19:34:25.011262Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.011567Z", "completed_at": "2025-08-20T19:34:25.011573Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003461599349975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.tiktok_ads_accounts", "compiled": true, "compiled_code": "select distinct advertiser_name, advertiser_id from `ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__advertiser_report`", "relation_name": "`ps-silver-gold`.`fact_lookup_dev`.`tiktok_ads_accounts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.013672Z", "completed_at": "2025-08-20T19:34:25.017329Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.017581Z", "completed_at": "2025-08-20T19:34:25.017586Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005383491516113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.account_unified_stats", "compiled": true, "compiled_code": "WITH google_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        clicks,\n        impressions,\n        spend_usd AS spend,\n        conversions,\n        conversions_value,\n        video_views,\n        engagements,\n        video_completion\n    FROM\n        `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__account_report`\n),\nfacebook_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS int64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__account_report`\n),\ntiktok_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        clicks,\n        impressions,\n        spend,\n        conversion AS conversions,\n        CAST(\n            NULL AS numeric\n        ) AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS int64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__advertiser_report`\n),\npinterest_stats AS (\n    SELECT\n        DATE(date_day) AS date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        clicks,\n        impressions,\n        spend,\n        total_conversions AS conversions,\n        total_conversions_value AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS int64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__advertiser_report`\n),\nbing_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS int64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__account_report`\n),\nlinkedin_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        clicks,\n        impressions,\n        cost AS spend,\n        total_conversions AS conversions,\n        CAST(\n            NULL AS numeric\n        ) AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS int64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__account_report`\n),\nstackadapt_stats AS (\n    SELECT\n        DATE(DATE) AS date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        CAST(\n            NULL AS numeric\n        ) AS conversions_value,\n        video_start AS video_views,\n        engagements,\n        video_completes AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_stackadapt_ads_dev`.`unified_data`\n    WHERE\n        ad_platform = 'stackadapt'\n)\nSELECT\n    *\nFROM\n    google_stats\nUNION ALL\nSELECT\n    *\nFROM\n    facebook_stats\nUNION ALL\nSELECT\n    *\nFROM\n    tiktok_stats\nUNION ALL\nSELECT\n    *\nFROM\n    pinterest_stats\nUNION ALL\nSELECT\n    *\nFROM\n    bing_stats\nUNION ALL\nSELECT\n    *\nFROM\n    linkedin_stats\nUNION ALL\nSELECT\n    *\nFROM\n    stackadapt_stats", "relation_name": "`ps-silver-gold`.`account_performance_dev`.`account_unified_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.019449Z", "completed_at": "2025-08-20T19:34:25.021880Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.022129Z", "completed_at": "2025-08-20T19:34:25.022134Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003998756408691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.campaign_unified_stats", "compiled": true, "compiled_code": "WITH google_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            campaign_status AS STRING\n        ) AS status,\n        campaign_advertising_channel_type AS campaign_type,\n        CAST( NULL as STRING) as time_of_day,\n        clicks,\n        impressions,\n        spend_usd AS spend,\n        conversions,\n        conversions_value,\n        video_views,\n        engagements,\n        video_completion,\n    FROM\n        `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__campaign_report`\n),\nfacebook_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            status AS STRING\n        ) AS status,\n        CAST (\n            NULL AS STRING\n        ) AS campaign_type,\n        CAST( NULL as STRING) as time_of_day,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__campaign_report`\n),\ntiktok_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            NULL AS STRING\n        ) AS status,\n        CAST (\n            NULL AS STRING\n        ) AS campaign_type,\n        CAST( NULL as STRING) as time_of_day,\n        clicks,\n        impressions,\n        spend,\n        conversion AS conversions,\n        CAST(\n            NULL AS float64\n        ) AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__campaign_report`\n),\npinterest_stats AS (\n    SELECT\n        DATE(date_day) AS date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            campaign_status AS STRING\n        ) AS status,\n        CAST (\n            NULL AS STRING\n        ) AS campaign_type,\n        CAST( NULL as STRING) as time_of_day,\n        clicks,\n        impressions,\n        spend,\n        total_conversions AS conversions,\n        total_conversions_value AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__campaign_report`\n),\nbing_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            campaign_status AS STRING\n        ) AS status,\n        campaign_type AS campaign_type,\n        CAST( NULL as STRING) as time_of_day,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS float64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__campaign_report`\n),\nlinkedin_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_group_id AS STRING\n        ) AS campaign_id,\n        campaign_group_name AS campaign_name,\n        CAST(\n            campaign_group_status AS STRING\n        ) AS status,\n        campaign_type AS campaign_type,\n        CAST( NULL as STRING) as time_of_day,\n        clicks,\n        impressions,\n        cost AS spend,\n        total_conversions AS conversions,\n        conversion_value_in_local_currency AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS int64\n        ) AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__campaign_report`\n),\nstackadapt_stats AS (\n    SELECT\n        CAST(\n            date AS DATE\n        ) AS date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            NULL AS STRING\n        ) AS status,\n        CAST (\n            NULL AS STRING\n        ) AS campaign_type,\n        CAST( NULL as STRING) as time_of_day,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        CAST(\n            NULL AS float64\n        ) AS conversions_value,\n        video_completes AS video_views,\n        engagements,\n        video_completion_rate AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_stackadapt_ads_dev`.`unified_data`\n    WHERE\n        ad_platform = 'stackadapt'\n)\nSELECT\n    *\nFROM\n    google_stats\nUNION ALL\nSELECT\n    *\nFROM\n    facebook_stats\nUNION ALL\nSELECT\n    *\nFROM\n    tiktok_stats\nUNION ALL\nSELECT\n    *\nFROM\n    pinterest_stats\nUNION ALL\nSELECT\n    *\nFROM\n    bing_stats\nUNION ALL\nSELECT\n    *\nFROM\n    linkedin_stats\nUNION ALL\nSELECT\n    *\nFROM\n    stackadapt_stats", "relation_name": "`ps-silver-gold`.`campaign_performance_dev`.`campaign_unified_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.024274Z", "completed_at": "2025-08-20T19:34:25.026639Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.026891Z", "completed_at": "2025-08-20T19:34:25.026896Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004083156585693359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.facebook_ads__url_report", "compiled": true, "compiled_code": "WITH report AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__basic_ad`\n),\nconversion_report AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`int_facebook_ads__conversions`\n),\ncreatives AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`silver_facebook_ads_dev`.`int_facebook_ads__creative_history`\n),\naccounts AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__account_history`\n    WHERE\n        is_most_recent_record = TRUE\n),\nads AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_history`\n    WHERE\n        is_most_recent_record = TRUE\n),\nad_sets AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__ad_set_history`\n    WHERE\n        is_most_recent_record = TRUE\n),\ncampaigns AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold`.`staging_facebook_ads_dev`.`stg_facebook_ads__campaign_history`\n    WHERE\n        is_most_recent_record = TRUE\n),\nmapping AS (\n    SELECT\n        *\n    FROM\n        `ps-silver-gold.mapping.mapping`\n    WHERE\n        ad_platform = 'meta'\n),\njoined AS (\n    SELECT\n        report.date_day,\n        /*accounts.account_id,\n                accounts.account_name,*/\n        report.account_id,\n        mapping.account_name,\n        campaigns.campaign_id,\n        campaigns.campaign_name,\n        ad_sets.ad_set_id,\n        ad_sets.ad_set_name,\n        ads.ad_id,\n        ads.ad_name,\n        creatives.creative_id,\n        creatives.creative_name,\n        creatives.base_url,\n        creatives.url_host,\n        creatives.url_path,\n        creatives.utm_source,\n        creatives.utm_medium,\n        creatives.utm_campaign,\n        creatives.utm_content,\n        creatives.utm_term,\n        mapping.client_name,\n        mapping.client_id,\n        mapping.ad_platform,\n        mapping.sub_client_name,\n        SUM(\n            report.clicks\n        ) AS clicks,\n        SUM(\n            report.impressions\n        ) AS impressions,\n        SUM(\n            report.spend\n        ) AS spend,\n        SUM(COALESCE(conversion_report.conversions, 0)) AS conversions,\n        SUM(COALESCE(conversion_report.conversions_value, 0)) AS conversions_value\n    FROM\n        report\n        LEFT JOIN conversion_report\n        ON report.date_day = conversion_report.date_day\n        AND report.ad_id = conversion_report.ad_id\n        AND report.source_relation = conversion_report.source_relation\n        LEFT JOIN ads\n        ON report.ad_id = ads.ad_id\n        AND report.source_relation = ads.source_relation\n        LEFT JOIN creatives\n        ON ads.creative_id = creatives.creative_id\n        AND ads.source_relation = creatives.source_relation\n        LEFT JOIN ad_sets\n        ON ads.ad_set_id = ad_sets.ad_set_id\n        AND ads.source_relation = ad_sets.source_relation\n        LEFT JOIN campaigns\n        ON ads.campaign_id = campaigns.campaign_id\n        AND ads.source_relation = campaigns.source_relation\n        /*LEFT JOIN accounts\n        ON report.account_id = accounts.account_id\n        AND report.source_relation = accounts.source_relation*/\n        LEFT JOIN mapping\n        ON CAST(\n            report.account_id AS STRING\n        ) = CAST(\n            mapping.account_id AS STRING\n        )\n    WHERE\n        creatives.url IS NOT NULL\n    GROUP BY\n        ALL\n)\nSELECT\n    *\nFROM\n    joined", "relation_name": "`ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__url_report`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.028974Z", "completed_at": "2025-08-20T19:34:25.031492Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.031767Z", "completed_at": "2025-08-20T19:34:25.031773Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004412174224853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.ad_group_unified_stats", "compiled": true, "compiled_code": "WITH google_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            ad_group_id AS STRING\n        ) AS ad_group_id,\n        ad_group_name,\n        ad_group_type,\n        CAST(\n            NULL AS STRING\n        ) AS bid_stratagy,\n        clicks,\n        impressions,\n        spend_usd AS spend,\n        conversions,\n        conversions_value,\n        video_views,\n        engagements,\n        video_completion\n    FROM\n        `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__ad_group_report`\n),\nfacebook_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            ad_set_id AS STRING\n        ) AS ad_group_id,\n        ad_set_name AS ad_group_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_group_type,\n        CAST(\n            NULL AS STRING\n        ) AS bid_stratagy,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        NULL AS video_views,\n        NULL AS engagements,\n        NULL AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__ad_set_report`\n),\ntiktok_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            ad_group_id AS STRING\n        ) AS ad_group_id,\n        ad_group_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_group_type,\n        CAST(\n            NULL AS STRING\n        ) AS bid_stratagy,\n        clicks,\n        impressions,\n        spend,\n        conversion AS conversions,\n        NULL AS conversions_value,\n        NULL AS video_views,\n        NULL AS engagements,\n        NULL AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__ad_group_report`\n),\npinterest_stats AS (\n    SELECT\n        DATE(date_day) AS date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            ad_group_id AS STRING\n        ) AS ad_group_id,\n        ad_group_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_group_type,\n        CAST(\n            NULL AS STRING\n        ) AS bid_stratagy,\n        clicks,\n        impressions,\n        spend,\n        total_conversions AS conversions,\n        total_conversions_value AS conversions_value,\n        NULL AS video_views,\n        NULL AS engagements,\n        NULL AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_pinterest_ads_dev`.`pinterest_ads__ad_group_report`\n),\nbing_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            ad_group_id AS STRING\n        ) AS ad_group_id,\n        ad_group_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_group_type,\n        CAST(\n            NULL AS STRING\n        ) AS bid_stratagy,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        NULL AS video_views,\n        NULL AS engagements,\n        NULL AS video_completion,\n    FROM\n        `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__ad_group_report`\n),\nstackadapt_stats AS (\n    SELECT\n        DATE(DATE) AS date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS STRING\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            campaign_group_id AS STRING\n        ) AS ad_group_id,\n        campaign_group_name AS ad_group_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_group_type,\n        CAST(\n            NULL AS STRING\n        ) AS bid_stratagy,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        NULL AS conversions_value,\n        video_start AS video_views,\n        engagements,\n        video_completes AS video_completion\n    FROM\n        `ps-silver-gold`.`silver_stackadapt_ads_dev`.`unified_data`\n    WHERE\n        ad_platform = 'stackadapt'\n)\nSELECT\n    *\nFROM\n    google_stats\nUNION ALL\nSELECT\n    *\nFROM\n    facebook_stats\nUNION ALL\nSELECT\n    *\nFROM\n    tiktok_stats\nUNION ALL\nSELECT\n    *\nFROM\n    pinterest_stats\nUNION ALL\nSELECT\n    *\nFROM\n    bing_stats\nUNION ALL\nSELECT\n    *\nFROM\n    stackadapt_stats", "relation_name": "`ps-silver-gold`.`ad_group_performance_dev`.`ad_group_unified_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.033756Z", "completed_at": "2025-08-20T19:34:25.036057Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.036342Z", "completed_at": "2025-08-20T19:34:25.036349Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00459599494934082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.ad_unified_stats", "compiled": true, "compiled_code": "WITH google_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        campaign_id,\n        campaign_name,\n        ad_group_id,\n        ad_group_name,\n        ad_id,\n        ad_name,\n        ad_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_name,\n        CAST(\n            NULL AS STRING\n        ) AS creative_url,\n        CAST(\n            NULL AS STRING\n        ) AS tagline,\n        CAST(\n            NULL AS STRING\n        ) AS creative_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_size,\n        clicks,\n        impressions,\n        spend_usd AS spend,\n        conversions,\n        conversions_value,\n        video_views,\n        engagements,\n        video_completion\n    FROM\n        `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__ad_report`\n),\nfacebook_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        campaign_id,\n        campaign_name,\n        ad_set_id AS ad_group_id,\n        ad_set_name AS ad_group_name,\n        ad_id,\n        ad_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_type,\n        creative_name,\n        base_url AS creative_url,\n        CAST(\n            NULL AS STRING\n        ) AS tagline,\n        CAST(\n            NULL AS STRING\n        ) AS creative_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_size,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        NULL AS video_views,\n        NULL AS engagements,\n        NULL AS video_completion,\n    FROM\n        `ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__url_report`\n),\ntiktok_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        campaign_id,\n        campaign_name,\n        ad_group_id,\n        ad_group_name,\n        ad_id,\n        ad_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_name,\n        base_url AS creative_url,\n        CAST(\n            NULL AS STRING\n        ) AS tagline,\n        CAST(\n            NULL AS STRING\n        ) AS creative_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_size,\n        clicks,\n        impressions,\n        spend,\n        conversion AS conversions,\n        NULL AS conversions_value,\n        NULL AS video_views,\n        NULL AS engagements,\n        NULL AS video_completion,\n    FROM\n        `ps-silver-gold`.`silver_tiktok_ads_dev`.`tiktok_ads__url_report`\n),\nbing_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        campaign_id,\n        campaign_name,\n        ad_group_id,\n        ad_group_name,\n        ad_id,\n        ad_name,\n        ad_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_name,\n        CAST(\n            NULL AS STRING\n        ) AS creative_url,\n        CAST(\n            NULL AS STRING\n        ) AS tagline,\n        CAST(\n            NULL AS STRING\n        ) AS creative_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_size,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value,\n        NULL AS video_views,\n        NULL AS engagements,\n        NULL AS video_completion,\n    FROM\n        `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__ad_report`\n),\nlinkedin_stats AS (\n    SELECT\n        date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_group_id AS int64\n        ) AS campaign_id,\n        campaign_group_name AS campaign_name,\n        NULL AS ad_group_id,\n        CAST(\n            NULL AS STRING\n        ) AS ad_group_name,\n        creative_id AS ad_id,\n        CAST(\n            NULL AS STRING\n        ) AS ad_name,\n        CAST(\n            NULL AS STRING\n        ) AS ad_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_name,\n        click_uri AS creative_url,\n        CAST(\n            NULL AS STRING\n        ) AS tagline,\n        click_uri_type AS creative_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_size,\n        clicks,\n        impressions,\n        cost AS spend,\n        total_conversions AS conversions,\n        CAST(\n            NULL AS numeric\n        ) AS conversions_value,\n        CAST(\n            NULL AS int64\n        ) AS video_views,\n        CAST(\n            NULL AS int64\n        ) AS engagements,\n        CAST(\n            NULL AS int64\n        ) AS video_completion,\n    FROM\n        `ps-silver-gold`.`silver_linkedin_ads_dev`.`linkedin_ads__creative_report`\n),\nstackadapt_stats AS (\n    SELECT\n        DATE(DATE) AS date_day,\n        CAST(\n            client_id AS STRING\n        ) AS client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        CAST(\n            campaign_id AS int64\n        ) AS campaign_id,\n        campaign_name,\n        CAST(\n            campaign_group_id AS int64\n        ) AS ad_group_id,\n        campaign_group_name AS ad_group_name,\n        CAST(\n            advertiser_id AS int64\n        ) AS ad_id,\n        creative_name AS ad_name,\n        channels AS ad_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_name,\n        CAST(\n            NULL AS STRING\n        ) AS creative_url,\n        CAST(\n            NULL AS STRING\n        ) AS tagline,\n        CAST(\n            NULL AS STRING\n        ) AS creative_type,\n        CAST(\n            NULL AS STRING\n        ) AS creative_size,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        NULL AS conversions_value,\n        video_start AS video_views,\n        engagements,\n        video_completes AS video_completion,\n    FROM\n        `ps-silver-gold`.`silver_stackadapt_ads_dev`.`unified_data`\n    WHERE\n        ad_platform = 'stackadapt'\n)\nSELECT\n    *\nFROM\n    google_stats\nUNION ALL\nSELECT\n    *\nFROM\n    facebook_stats\nUNION ALL\nSELECT\n    *\nFROM\n    tiktok_stats\nUNION ALL\nSELECT\n    *\nFROM\n    bing_stats\nUNION ALL\nSELECT\n    *\nFROM\n    linkedin_stats\nUNION ALL\nSELECT\n    *\nFROM\n    stackadapt_stats", "relation_name": "`ps-silver-gold`.`ad_performance_dev`.`ad_unified_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:25.039696Z", "completed_at": "2025-08-20T19:34:25.042363Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:25.042666Z", "completed_at": "2025-08-20T19:34:25.042673Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004763126373291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.keyword_unified_stats", "compiled": true, "compiled_code": "WITH google_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        campaign_id,\n        campaign_name,\n        ad_group_id,\n        ad_group_name,\n        keyword_id AS keyword_id,\n        keyword_text AS keyword_text,\n        CAST(\n            NULL AS STRING\n        ) AS final_url,\n        CAST(\n            NULL AS STRING\n        ) AS search_term,\n        CAST(\n            NULL AS STRING\n        ) AS search_term_id,\n        CAST(\n            NULL AS STRING\n        ) AS engagements,\n        CAST(\n            NULL AS STRING\n        ) AS video_views,\n        CAST(\n            NULL AS STRING\n        ) AS video_completes,\n        CAST(\n            NULL AS STRING\n        ) AS match_type,\n        clicks,\n        impressions,\n        spend_usd AS spend,\n        conversions,\n        conversions_value\n    FROM\n        `ps-silver-gold`.`silver_google_ads_dev`.`google_ads__keyword_report`\n),\nfacebook_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        campaign_id,\n        campaign_name,\n        ad_set_id AS ad_group_id,\n        ad_set_name AS ad_group_name,\n        creative_id AS keyword_id,\n        creative_name AS keyword_text,\n        base_url AS final_url,\n        CAST(\n            utm_term AS STRING\n        ) AS search_term,\n        CAST(\n            NULL AS STRING\n        ) AS search_term_id,\n        CAST(\n            NULL AS STRING\n        ) AS engagements,\n        CAST(\n            NULL AS STRING\n        ) AS video_views,\n        CAST(\n            NULL AS STRING\n        ) AS video_completes,\n        CAST(\n            NULL AS STRING\n        ) AS match_type,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value\n    FROM\n        `ps-silver-gold`.`silver_facebook_ads_dev`.`facebook_ads__url_report`\n),\nbing_stats AS (\n    SELECT\n        date_day,\n        client_id,\n        client_name,\n        ad_platform,\n        sub_client_name,\n        campaign_id,\n        campaign_name,\n        ad_group_id,\n        ad_group_name,\n        keyword_id,\n        keyword_name,\n        CAST(\n            NULL AS STRING\n        ) AS final_url,\n        CAST(\n            NULL AS STRING\n        ) AS search_term,\n        CAST(\n            NULL AS STRING\n        ) AS search_term_id,\n        CAST(\n            NULL AS STRING\n        ) AS engagements,\n        CAST(\n            NULL AS STRING\n        ) AS video_views,\n        CAST(\n            NULL AS STRING\n        ) AS video_completes,\n        CAST(\n            NULL AS STRING\n        ) AS match_type,\n        clicks,\n        impressions,\n        spend,\n        conversions,\n        conversions_value\n    FROM\n        `ps-silver-gold`.`silver_bing_ads_dev`.`microsoft_ads__keyword_report`\n)\nSELECT\n    *\nFROM\n    google_stats\nUNION ALL\nSELECT\n    *\nFROM\n    facebook_stats\nUNION ALL\nSELECT\n    *\nFROM\n    bing_stats", "relation_name": "`ps-silver-gold`.`keyword_performance_dev`.`keyword_unified_stats`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.365262Z", "completed_at": "2025-08-20T19:34:26.015384Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:26.016432Z", "completed_at": "2025-08-20T19:34:26.016455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6542658805847168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.brand_metadata", "compiled": true, "compiled_code": "\n\n-- Ensure the external table exists by calling the macro\n\n\n-- Dummy SELECT so dbt parses the model\nSELECT \n    'external table ensured' AS status,\n    CURRENT_TIMESTAMP() AS created_at", "relation_name": "`ps-silver-gold`.`mapping_dev`.`brand_metadata`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.383277Z", "completed_at": "2025-08-20T19:34:26.063480Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:26.064504Z", "completed_at": "2025-08-20T19:34:26.064525Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7006831169128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.mapping_metadata", "compiled": true, "compiled_code": "\n\n-- Ensure the external table exists by calling the macro\n\n\n-- Dummy SELECT so dbt parses the model\nSELECT \n    'external table ensured' AS status,\n    CURRENT_TIMESTAMP() AS created_at", "relation_name": "`ps-silver-gold`.`mapping_dev`.`mapping_metadata`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-20T19:34:24.378887Z", "completed_at": "2025-08-20T19:34:26.118211Z"}, {"name": "execute", "started_at": "2025-08-20T19:34:26.118676Z", "completed_at": "2025-08-20T19:34:26.118684Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.754404067993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ps_silver_gold.client_metadata", "compiled": true, "compiled_code": "\n\n-- Ensure the external table exists by calling the macro\n\n\n-- Dummy SELECT so dbt parses the model\nSELECT \n    'external table ensured' AS status,\n    CURRENT_TIMESTAMP() AS created_at", "relation_name": "`ps-silver-gold`.`mapping_dev`.`client_metadata`", "batch_results": null}], "elapsed_time": 4.344818830490112, "args": {"log_format_file": "debug", "log_level_file": "debug", "log_format": "default", "source_freshness_run_project_hooks": false, "static_parser": true, "partial_parse_file_diff": true, "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "select": [], "use_colors": true, "introspect": true, "skip_nodes_if_on_run_start_fails": false, "compile": true, "profiles_dir": "D:\\ps_silver_gold", "show_resource_report": false, "static": false, "favor_state": false, "macro_debugging": false, "cache_selected_only": false, "empty_catalog": false, "version_check": true, "printer_width": 80, "indirect_selection": "eager", "use_colors_file": true, "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "write_json": true, "quiet": false, "exclude": [], "invocation_command": "dbt docs generate", "print": true, "require_resource_names_without_spaces": false, "state_modified_compare_vars": false, "log_path": "D:\\ps_silver_gold\\logs", "defer": false, "project_dir": "D:\\ps_silver_gold", "require_batched_execution_for_custom_microbatch_strategy": false, "send_anonymous_usage_stats": true, "require_nested_cumulative_type_params": false, "strict_mode": false, "log_file_max_bytes": 10485760, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "which": "generate", "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}}}